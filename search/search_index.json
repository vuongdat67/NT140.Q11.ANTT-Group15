{"config":{"lang":["en","vi"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stemmer","stopWordFilter","trimmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"FileVault Documentation","text":""},{"location":"#filevault-documentation","title":"FileVault Documentation","text":"<p>T\u00e0i li\u1ec7u h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng v\u00e0 h\u1ecdc t\u1eadp v\u1ec1 c\u00e1c thu\u1eadt to\u00e1n m\u00e3 h\u00f3a trong FileVault.</p>"},{"location":"#-api-documentation","title":"\ud83d\udcda API Documentation","text":""},{"location":"#doxygen-api-reference","title":"Doxygen (API Reference)","text":"<ul> <li>Location: <code>doxygen/html/index.html</code> or <code>doxygen/latex/FileVault-API.pdf</code></li> <li>Features: </li> <li>Class hierarchy diagrams</li> <li>Full API reference v\u1edbi source code</li> <li>Search functionality</li> <li>Cross-referenced documentation</li> </ul> <p>M\u1edf docs: Double-click file <code>docs/doxygen/html/index.html</code> trong browser.</p>"},{"location":"#-algorithm-categories","title":"\ud83d\udd10 Algorithm Categories","text":""},{"location":"#1-classical-ciphers-srcalgorithmsclassical","title":"1. Classical Ciphers (<code>src/algorithms/classical/</code>)","text":"<p>C\u00e1c thu\u1eadt to\u00e1n m\u00e3 h\u00f3a c\u1ed5 \u0111i\u1ec3n - d\u00f9ng cho m\u1ee5c \u0111\u00edch h\u1ecdc t\u1eadp.</p> Algorithm File Description Caesar <code>caesar.cpp</code> Shift cipher \u0111\u01a1n gi\u1ea3n Vigen\u00e8re <code>vigenere.cpp</code> Polyalphabetic substitution Playfair <code>playfair.cpp</code> Digraph substitution cipher Hill <code>hill.cpp</code> Matrix-based cipher Substitution <code>substitution.cpp</code> Monoalphabetic substitution"},{"location":"#2-symmetric-encryption-srcalgorithmssymmetric","title":"2. Symmetric Encryption (<code>src/algorithms/symmetric/</code>)","text":"<p>Thu\u1eadt to\u00e1n m\u00e3 h\u00f3a \u0111\u1ed1i x\u1ee9ng hi\u1ec7n \u0111\u1ea1i.</p> Algorithm File Mode Description AES-GCM <code>aes_gcm.cpp</code> AEAD \u2b50 Recommended - Authenticated encryption AES-CBC <code>aes_cbc.cpp</code> Block Classic block cipher mode AES-CTR <code>aes_ctr.cpp</code> Stream Counter mode AES-XTS <code>aes_xts.cpp</code> Disk Disk encryption mode ChaCha20-Poly1305 <code>chacha20_poly1305.cpp</code> AEAD Modern stream cipher Camellia-GCM <code>camellia_gcm.cpp</code> AEAD Japanese standard ARIA-GCM <code>aria_gcm.cpp</code> AEAD Korean standard Serpent-GCM <code>serpent_gcm.cpp</code> AEAD AES finalist Twofish-GCM <code>twofish_gcm.cpp</code> AEAD AES finalist SM4-GCM <code>sm4_gcm.cpp</code> AEAD Chinese standard 3DES <code>triple_des.cpp</code> Legacy Legacy support"},{"location":"#3-asymmetric-encryption-srcalgorithmsasymmetric","title":"3. Asymmetric Encryption (<code>src/algorithms/asymmetric/</code>)","text":"<p>Thu\u1eadt to\u00e1n m\u00e3 h\u00f3a b\u1ea5t \u0111\u1ed1i x\u1ee9ng.</p> Algorithm File Description RSA <code>rsa.cpp</code> 2048/3072/4096-bit RSA ECC <code>ecc.cpp</code> ECDH, ECDSA v\u1edbi P-256/P-384/P-521"},{"location":"#4-post-quantum-cryptography-srcalgorithmspqc","title":"4. Post-Quantum Cryptography (<code>src/algorithms/pqc/</code>)","text":"<p>Thu\u1eadt to\u00e1n kh\u00e1ng l\u01b0\u1ee3ng t\u1eed (NIST PQC).</p> Algorithm File Description Kyber <code>post_quantum.cpp</code> ML-KEM (Key Encapsulation) Dilithium <code>post_quantum.cpp</code> ML-DSA (Digital Signature)"},{"location":"#-regenerate-documentation","title":"\ud83d\udd04 Regenerate Documentation","text":""},{"location":"#doxygen","title":"Doxygen","text":"PowerShell<pre><code>cd D:\\code\\filevault\ndoxygen Doxyfile\n</code></pre>"},{"location":"#-learning-resources","title":"\ud83d\udcd6 Learning Resources","text":"<ul> <li>Doxygen HTML: Xem class diagrams v\u00e0 API reference</li> <li>Source Code: \u0110\u1ecdc implementation v\u1edbi comments chi ti\u1ebft</li> <li>Test Cases: Xem <code>tests/</code> folder cho examples</li> </ul>"},{"location":"#-configuration-files","title":"\ud83d\udee0\ufe0f Configuration Files","text":"File Purpose <code>Doxyfile</code> Doxygen configuration"},{"location":"algorithms/","title":"\ud83d\udcda FileVault - T\u00e0i li\u1ec7u Thu\u1eadt to\u00e1n M\u1eadt m\u00e3","text":""},{"location":"algorithms/#-filevault---t\u00e0i-li\u1ec7u-thu\u1eadt-to\u00e1n-m\u1eadt-m\u00e3","title":"\ud83d\udcda FileVault - T\u00e0i li\u1ec7u Thu\u1eadt to\u00e1n M\u1eadt m\u00e3","text":"<p>T\u00e0i li\u1ec7u chi ti\u1ebft v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c thu\u1eadt to\u00e1n m\u1eadt m\u00e3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong FileVault. D\u00e0nh cho h\u1ecdc t\u1eadp, nghi\u00ean c\u1ee9u v\u00e0 ph\u00e1t tri\u1ec3n.</p>"},{"location":"algorithms/#-m\u1ee5c-l\u1ee5c","title":"\ud83d\udcd6 M\u1ee5c l\u1ee5c","text":""},{"location":"algorithms/#-symmetric---m\u00e3-h\u00f3a-\u0111\u1ed1i-x\u1ee9ng","title":"\ud83d\udd10 Symmetric - M\u00e3 h\u00f3a \u0110\u1ed1i x\u1ee9ng","text":"<p>Thu\u1eadt to\u00e1n s\u1eed d\u1ee5ng c\u00f9ng m\u1ed9t kh\u00f3a cho c\u1ea3 m\u00e3 h\u00f3a v\u00e0 gi\u1ea3i m\u00e3.</p> Thu\u1eadt to\u00e1n Lo\u1ea1i B\u1ea3o m\u1eadt File AES-GCM AEAD \u2b50\u2b50\u2b50 Maximum aes-gcm.md AES-CBC Block \u2b50\u2b50 Strong aes-cbc.md AES-CTR Stream \u2b50\u2b50 Strong aes-ctr.md AES-XTS Disk \u2b50\u2b50\u2b50 Maximum aes-xts.md ChaCha20-Poly1305 AEAD \u2b50\u2b50\u2b50 Maximum chacha20-poly1305.md Serpent-GCM AEAD \u2b50\u2b50\u2b50 Maximum serpent-gcm.md Twofish-GCM AEAD \u2b50\u2b50\u2b50 Maximum twofish-gcm.md Camellia-GCM AEAD \u2b50\u2b50\u2b50 Maximum camellia-gcm.md ARIA-GCM AEAD \u2b50\u2b50\u2b50 Maximum aria-gcm.md SM4-GCM AEAD \u2b50\u2b50 Strong sm4-gcm.md 3DES Block \u26a0\ufe0f Legacy triple-des.md"},{"location":"algorithms/#-asymmetric---m\u00e3-h\u00f3a-b\u1ea5t-\u0111\u1ed1i-x\u1ee9ng","title":"\ud83d\udd11 Asymmetric - M\u00e3 h\u00f3a B\u1ea5t \u0111\u1ed1i x\u1ee9ng","text":"<p>Thu\u1eadt to\u00e1n s\u1eed d\u1ee5ng c\u1eb7p kh\u00f3a public/private.</p> Thu\u1eadt to\u00e1n Lo\u1ea1i B\u1ea3o m\u1eadt File RSA-OAEP Encryption \u2b50\u2b50\u2b50 Maximum rsa.md ECC (ECDH) Key Exchange \u2b50\u2b50\u2b50 Maximum ecc.md"},{"location":"algorithms/#-pqc---post-quantum-cryptography","title":"\ud83d\udee1\ufe0f PQC - Post-Quantum Cryptography","text":"<p>Thu\u1eadt to\u00e1n ch\u1ed1ng l\u1ea1i m\u00e1y t\u00ednh l\u01b0\u1ee3ng t\u1eed (NIST Selected).</p> Thu\u1eadt to\u00e1n Lo\u1ea1i NIST Level File Kyber (ML-KEM) KEM Level 1-5 kyber.md Dilithium (ML-DSA) Signature Level 2-5 dilithium.md"},{"location":"algorithms/#-classical---m\u1eadt-m\u00e3-c\u1ed5-\u0111i\u1ec3n","title":"\ud83d\udcda Classical - M\u1eadt m\u00e3 C\u1ed5 \u0111i\u1ec3n","text":"<p>Thu\u1eadt to\u00e1n gi\u00e1o d\u1ee5c - KH\u00d4NG an to\u00e0n cho s\u1eed d\u1ee5ng th\u1ef1c t\u1ebf!</p> Thu\u1eadt to\u00e1n Lo\u1ea1i File Caesar Shift caesar.md Vigen\u00e8re Polyalphabetic vigenere.md Playfair Digraph playfair.md Hill Matrix hill.md Substitution Monoalphabetic substitution.md"},{"location":"algorithms/#-kdf---key-derivation-functions","title":"\ud83d\udd12 KDF - Key Derivation Functions","text":"<p>H\u00e0m d\u1eabn xu\u1ea5t kh\u00f3a t\u1eeb m\u1eadt kh\u1ea9u.</p> Thu\u1eadt to\u00e1n Lo\u1ea1i File Argon2id Memory-hard argon2.md PBKDF2 Standard pbkdf2.md HKDF Expand hkdf.md"},{"location":"algorithms/#-hash---h\u00e0m-b\u0103m","title":"#\ufe0f\u20e3 Hash - H\u00e0m b\u0103m","text":"Thu\u1eadt to\u00e1n Output File SHA-256/512 256/512-bit sha2.md SHA3 256/512-bit sha3.md BLAKE2 Variable blake2.md"},{"location":"algorithms/#-c\u00e1ch-\u0111\u1ecdc-t\u00e0i-li\u1ec7u","title":"\ud83c\udfaf C\u00e1ch \u0111\u1ecdc t\u00e0i li\u1ec7u","text":"<p>M\u1ed7i file thu\u1eadt to\u00e1n c\u00f3 c\u1ea5u tr\u00fac:</p> <ol> <li>T\u00f3m t\u1eaft - Gi\u1edbi thi\u1ec7u ng\u1eafn g\u1ecdn</li> <li>L\u00fd thuy\u1ebft - N\u1ec1n t\u1ea3ng to\u00e1n h\u1ecdc</li> <li>C\u00e1ch ho\u1ea1t \u0111\u1ed9ng - Step-by-step v\u1edbi diagram</li> <li>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u - Key size, IV, block size</li> <li>Implement trong FileVault - Code th\u1ef1c t\u1ebf</li> <li>L\u1ed7 h\u1ed5ng &amp; Mitigation - B\u1ea3o m\u1eadt</li> <li>Test Vectors - Ki\u1ec3m tra t\u00ednh \u0111\u00fang \u0111\u1eafn</li> <li>V\u00ed d\u1ee5 s\u1eed d\u1ee5ng - CLI commands</li> <li>Tham kh\u1ea3o - Links, RFCs</li> </ol>"},{"location":"algorithms/#-build--test","title":"\ud83d\udd27 Build &amp; Test","text":"Bash<pre><code># Ch\u1ea1y t\u1ea5t c\u1ea3 tests\nctest --test-dir build/build/Release -j16\n\n# Test c\u1ee5 th\u1ec3 m\u1ed9t thu\u1eadt to\u00e1n\nfilevault benchmark --symmetric   # Test symmetric\nfilevault benchmark --pqc         # Test post-quantum\n</code></pre>"},{"location":"algorithms/#-so-s\u00e1nh-nhanh","title":"\ud83d\udcca So s\u00e1nh nhanh","text":""},{"location":"algorithms/#aead-algorithms-khuy\u1ebfn-ngh\u1ecb-cho-m\u00e3-h\u00f3a-file","title":"AEAD Algorithms (Khuy\u1ebfn ngh\u1ecb cho m\u00e3 h\u00f3a file)","text":"Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Algorithm       \u2502 Key Size \u2502 Nonce/IV  \u2502  Tag   \u2502   Speed     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 AES-256-GCM         \u2502 256-bit  \u2502 96-bit    \u2502 128-bit\u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591  \u2502\n\u2502 ChaCha20-Poly1305   \u2502 256-bit  \u2502 96-bit    \u2502 128-bit\u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  \u2502\n\u2502 Serpent-256-GCM     \u2502 256-bit  \u2502 96-bit    \u2502 128-bit\u2502 \u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"algorithms/#security-comparison","title":"Security Comparison","text":"Text Only<pre><code>                    Classical   AES    ChaCha20   PQC (Kyber)\n                    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2500\u2500\u2500    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nBrute Force         Minutes     2^256  2^256      2^256\nQuantum (Grover)    N/A         2^128  2^128      Still 2^256\nQuantum (Shor)      N/A         N/A    N/A        Safe \u2713\n</code></pre> <p>FileVault - Learn cryptography by doing! \ud83d\udd10</p>"},{"location":"algorithms/ALGORITHMS/","title":"FileVault Algorithms Documentation","text":""},{"location":"algorithms/ALGORITHMS/#filevault-algorithms-documentation","title":"FileVault Algorithms Documentation","text":"<p>Comprehensive guide to cryptographic algorithms supported by FileVault.</p>"},{"location":"algorithms/ALGORITHMS/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Symmetric Encryption</li> <li>AEAD Ciphers</li> <li>Block Cipher Modes</li> <li>Asymmetric Encryption</li> <li>Post-Quantum Cryptography</li> <li>Key Derivation Functions</li> <li>Hash Functions</li> <li>Classical Ciphers</li> </ul>"},{"location":"algorithms/ALGORITHMS/#symmetric-encryption","title":"Symmetric Encryption","text":""},{"location":"algorithms/ALGORITHMS/#aead-ciphers","title":"AEAD Ciphers","text":"<p>AEAD (Authenticated Encryption with Associated Data) provides both confidentiality and authenticity in a single operation.</p>"},{"location":"algorithms/ALGORITHMS/#aes-gcm-galoiscounter-mode","title":"AES-GCM (Galois/Counter Mode)","text":"<p>Standards: NIST SP 800-38D, FIPS 197 Key Sizes: 128, 192, 256 bits Performance: \u26a1\u26a1\u26a1\u26a1 (Hardware accelerated with AES-NI)</p> <p>Description: AES-GCM combines CTR mode encryption with GMAC authentication. It's the most widely used AEAD cipher and provides excellent performance on modern CPUs with hardware acceleration.</p> <p>Security Features: - 128-bit authentication tag - Nonce-based (96-bit IV standard) - Parallelizable encryption/decryption - Resistant to chosen-ciphertext attacks</p> <p>Usage: </p>Bash<pre><code>filevault encrypt document.pdf -a aes-256-gcm\n</code></pre><p></p> <p>When to Use: - \u2705 General purpose encryption (default choice) - \u2705 High-performance requirements - \u2705 Modern hardware with AES-NI - \u2705 Compliance requirements (NIST approved)</p> <p>Security Considerations: - \u26a0\ufe0f Nonce reuse is catastrophic (breaks authentication) - \u26a0\ufe0f Maximum 2^32 blocks per key (64 GB with 128-bit blocks) - \u2705 FileVault automatically manages nonces and enforces limits</p>"},{"location":"algorithms/ALGORITHMS/#chacha20-poly1305","title":"ChaCha20-Poly1305","text":"<p>Standards: RFC 8439 Key Size: 256 bits Performance: \u26a1\u26a1\u26a1\u26a1 (Software optimized)</p> <p>Description: Modern stream cipher (ChaCha20) combined with Poly1305 MAC. Designed by Daniel J. Bernstein as an alternative to AES-GCM for systems without hardware AES acceleration.</p> <p>Security Features: - 256-bit key (no 128-bit variant) - 96-bit nonce + 32-bit counter - Constant-time implementation (resistant to timing attacks) - No cache-timing vulnerabilities</p> <p>Usage: </p>Bash<pre><code>filevault encrypt data.zip -a chacha20-poly1305\n</code></pre><p></p> <p>When to Use: - \u2705 Mobile devices / ARM processors - \u2705 Systems without AES-NI - \u2705 When constant-time guarantees are critical - \u2705 IoT devices</p> <p>Security Considerations: - \u2705 Simpler design than AES-GCM - \u2705 Better software performance on ARM - \u2705 Widely deployed (TLS 1.3, WireGuard, Signal)</p>"},{"location":"algorithms/ALGORITHMS/#serpent-256-gcm","title":"Serpent-256-GCM","text":"<p>Standards: AES finalist Key Size: 256 bits Performance: \u26a1\u26a1 (Conservative design)</p> <p>Description: Serpent was an AES finalist known for its conservative security margin. Combined with GCM for authentication.</p> <p>Security Features: - 32 rounds (vs AES's 14 rounds for 256-bit) - Designed for maximum security over performance - No known practical attacks</p> <p>Usage: </p>Bash<pre><code>filevault encrypt sensitive.doc -a serpent-256-gcm\n</code></pre><p></p> <p>When to Use: - \u2705 Maximum security requirements - \u2705 Long-term data protection - \u274c Performance is not critical</p>"},{"location":"algorithms/ALGORITHMS/#international-standard-ciphers","title":"International Standard Ciphers","text":""},{"location":"algorithms/ALGORITHMS/#camellia-gcm-japan","title":"Camellia-GCM (Japan)","text":"<p>Standards: ISO/IEC 18033-3, CRYPTREC, NESSIE Key Sizes: 128, 256 bits</p> <p>Developed by Mitsubishi and NTT. Similar design to AES but with different S-boxes.</p> Bash<pre><code>filevault encrypt file.txt -a camellia-256-gcm\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#aria-gcm-korea","title":"ARIA-GCM (Korea)","text":"<p>Standards: KS X 1213, RFC 5794, ISO/IEC 18033-3 Key Sizes: 128, 256 bits</p> <p>Korean national standard. Block cipher similar to AES structure.</p> Bash<pre><code>filevault encrypt file.txt -a aria-256-gcm\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#sm4-gcm-china","title":"SM4-GCM (China)","text":"<p>Standards: GB/T 32907-2016 Key Size: 128 bits only</p> <p>Chinese national standard cipher. Used in Chinese financial and government systems.</p> Bash<pre><code>filevault encrypt file.txt -a sm4-gcm\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#block-cipher-modes","title":"Block Cipher Modes","text":"<p>\u26a0\ufe0f Warning: These modes do NOT provide authentication. Use AEAD ciphers unless you have specific requirements.</p>"},{"location":"algorithms/ALGORITHMS/#cbc-cipher-block-chaining","title":"CBC (Cipher Block Chaining)","text":"<p>Description: Each plaintext block is XORed with the previous ciphertext block before encryption.</p> <p>Security: - \u274c No authentication (vulnerable to tampering) - \u274c Padding oracle attacks if not properly implemented - \u274c Not parallelizable for encryption</p> Bash<pre><code>filevault encrypt file.txt -a aes-256-cbc\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#ctr-counter-mode","title":"CTR (Counter Mode)","text":"<p>Description: Turns block cipher into stream cipher by encrypting counter values.</p> <p>Security: - \u2705 Parallelizable - \u274c No authentication - \u26a0\ufe0f Nonce reuse breaks confidentiality</p> Bash<pre><code>filevault encrypt file.txt -a aes-256-ctr\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#cfbofb-cipher-feedback--output-feedback","title":"CFB/OFB (Cipher Feedback / Output Feedback)","text":"<p>Description: Stream cipher modes with self-synchronization (CFB) or pre-computed keystream (OFB).</p> Bash<pre><code>filevault encrypt file.txt -a aes-256-cfb\nfilevault encrypt file.txt -a aes-256-ofb\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#xts-xex-based-tweaked-codebook","title":"XTS (XEX-based Tweaked Codebook)","text":"<p>Standards: IEEE P1619 Use Case: Disk encryption</p> <p>Description: Designed for encrypting data at rest (disk sectors). Uses two keys: one for encryption, one for tweaking.</p> <p>Security: - \u2705 Sector-based tweaking prevents block shuffling - \u274c No authentication (disk encryption typically doesn't need it) - \u2705 Efficient random access</p> Bash<pre><code>filevault encrypt disk.img -a aes-256-xts\n</code></pre>"},{"location":"algorithms/ALGORITHMS/#asymmetric-encryption","title":"Asymmetric Encryption","text":""},{"location":"algorithms/ALGORITHMS/#rsa-rivest-shamir-adleman","title":"RSA (Rivest-Shamir-Adleman)","text":"<p>Standards: PKCS#1, FIPS 186-4 Key Sizes: 2048, 3072, 4096 bits</p> <p>Description: Classic public-key cryptosystem based on integer factorization problem.</p> <p>Security Levels: - RSA-2048: 112-bit security (minimum acceptable) - RSA-3072: 128-bit security (recommended) - RSA-4096: 140-bit security (high security)</p> <p>Performance: - Key Generation: Slow (90ms - 1.7s) - Encryption: Fast (~0.5ms) - Decryption: Slow (3-18ms)</p> <p>Usage: </p>Bash<pre><code># Generate keypair\nfilevault keygen -a rsa-4096 -o mykey\n\n# Encrypt\nfilevault encrypt file.txt --pubkey mykey.pub\n\n# Decrypt\nfilevault decrypt file.txt.fvlt --privkey mykey.pem\n</code></pre><p></p> <p>When to Use: - \u2705 Key exchange - \u2705 Digital signatures - \u2705 Legacy system compatibility - \u274c Bulk data encryption (slow)</p> <p>Limitations: - Maximum message size = key size - padding overhead - Vulnerable to quantum computers (Shor's algorithm) - Large key sizes (4096 bits = 512 bytes)</p>"},{"location":"algorithms/ALGORITHMS/#ecc-elliptic-curve-cryptography","title":"ECC (Elliptic Curve Cryptography)","text":"<p>Standards: NIST P-curves (FIPS 186-4) Curves: P-256, P-384, P-521</p> <p>Description: Public-key cryptography based on elliptic curve discrete logarithm problem. Provides same security as RSA with much smaller keys.</p> <p>Security Levels: - ECC-P256: 128-bit security \u2248 RSA-3072 - ECC-P384: 192-bit security \u2248 RSA-7680 - ECC-P521: 256-bit security \u2248 RSA-15360</p> <p>FileVault Implementation: Uses ECDH (Elliptic Curve Diffie-Hellman) to establish shared secret, then encrypts with AES-GCM.</p> <p>Performance: - Key Generation: Fast (~1-10ms) - Encryption: Fast (~0.5-1.7ms) - Decryption: Fast (~0.3-1.3ms)</p> <p>Usage: </p>Bash<pre><code># Generate keypair\nfilevault keygen -a ecc-p521 -o mykey\n\n# Encrypt (hybrid: ECDH + AES-GCM)\nfilevault encrypt largefile.zip --pubkey mykey.pub\n</code></pre><p></p> <p>When to Use: - \u2705 Modern applications - \u2705 Smaller key sizes needed - \u2705 Bulk data encryption (hybrid mode) - \u2705 Mobile/embedded systems</p> <p>Advantages over RSA: - Smaller keys (256-bit ECC \u2248 3072-bit RSA) - Faster operations - Lower bandwidth requirements</p>"},{"location":"algorithms/ALGORITHMS/#post-quantum-cryptography","title":"Post-Quantum Cryptography","text":"<p>Background: Quantum computers running Shor's algorithm can break RSA and ECC. NIST selected quantum-resistant algorithms in 2022.</p>"},{"location":"algorithms/ALGORITHMS/#kyber-ml-kem---module-learning-with-errors","title":"Kyber (ML-KEM - Module Learning with Errors)","text":"<p>Standard: NIST FIPS 203 (draft) Type: Key Encapsulation Mechanism (KEM) Variants: Kyber-512, Kyber-768, Kyber-1024</p> <p>Description: Lattice-based cryptography resistant to quantum attacks. Winner of NIST PQC standardization.</p> <p>Security Levels: - Kyber-512: NIST Level 1 (128-bit quantum security) - Kyber-768: NIST Level 3 (192-bit quantum security) - Kyber-1024: NIST Level 5 (256-bit quantum security) \u2b50 Recommended</p> <p>Performance: - Key Generation: \u26a1\u26a1\u26a1\u26a1 (0.2-0.4 ms) - Encapsulation: \u26a1\u26a1\u26a1\u26a1 (0.3-0.6 ms) - Decapsulation: \u26a1\u26a1\u26a1\u26a1 (0.4-0.8 ms)</p> <p>Key Sizes: - Kyber-1024: Public key ~1568 bytes, Private key ~3168 bytes - Much larger than ECC but acceptable</p> <p>Usage: </p>Bash<pre><code># Generate Kyber keypair\nfilevault keygen -a kyber-1024 -o quantum-key\n\n# Note: Kyber is a KEM, not direct encryption\n# Use Kyber-Hybrid for file encryption\n</code></pre><p></p>"},{"location":"algorithms/ALGORITHMS/#kyberhybrid-pqc--classical","title":"KyberHybrid (PQC + Classical)","text":"<p>Description: Combines Kyber KEM with AES-256-GCM for defense-in-depth strategy. Protects against: - Quantum attacks (Kyber) - Classical attacks (AES-GCM) - Unknown vulnerabilities in either</p> <p>Architecture: 1. Generate Kyber-1024 shared secret 2. Derive AES-256-GCM key from shared secret 3. Encrypt data with AES-GCM</p> <p>Performance: - Overhead: Minimal (~0.5ms for key exchange) - Throughput: ~650 MB/s (same as AES-GCM)</p> <p>Usage: </p>Bash<pre><code># Hybrid encryption (recommended for quantum threat)\nfilevault encrypt secret.zip -a kyber-1024-hybrid\n\n# Requires Kyber keypair\nfilevault keygen -a kyber-1024 -o key\nfilevault encrypt data.txt -a kyber-1024-hybrid --pubkey key.pub\n</code></pre><p></p> <p>When to Use: - \u2705 Long-term data protection (10+ years) - \u2705 \"Store now, decrypt later\" threat model - \u2705 Compliance with quantum-readiness - \u2705 Defense-in-depth strategy</p>"},{"location":"algorithms/ALGORITHMS/#dilithium-ml-dsa---module-lattice-digital-signature","title":"Dilithium (ML-DSA - Module Lattice Digital Signature)","text":"<p>Standard: NIST FIPS 204 (draft) Type: Digital Signature Variants: Dilithium-2, Dilithium-3, Dilithium-5</p> <p>Description: Lattice-based digital signature scheme. Provides quantum-resistant authentication.</p> <p>Security Levels: - Dilithium-2: NIST Level 2 - Dilithium-3: NIST Level 3 - Dilithium-5: NIST Level 5 \u2b50 Maximum security</p> <p>Performance: - Key Generation: \u26a1\u26a1\u26a1\u26a1 (0.2-0.5 ms) - Sign: \u26a1\u26a1\u26a1 (0.4-1.6 ms) - Verify: \u26a1\u26a1\u26a1\u26a1 (0.3-0.8 ms)</p> <p>Signature Sizes: - Dilithium-5: ~4595 bytes (large but acceptable)</p> <p>Usage: </p>Bash<pre><code># Generate Dilithium keypair\nfilevault keygen -a dilithium-5 -o signature-key\n\n# Future: Digital signatures for file authenticity\n# filevault sign file.txt --privkey signature-key.pem\n# filevault verify file.txt.sig --pubkey signature-key.pub\n</code></pre><p></p>"},{"location":"algorithms/ALGORITHMS/#key-derivation-functions","title":"Key Derivation Functions","text":""},{"location":"algorithms/ALGORITHMS/#argon2id-recommended","title":"Argon2id (Recommended)","text":"<p>Standards: RFC 9106, PHC winner Type: Memory-hard KDF</p> <p>Description: Hybrid of Argon2i (data-independent) and Argon2d (data-dependent). Best resistance against GPU/ASIC attacks and side-channel attacks.</p> <p>Parameters: - Memory: 64 MB - 512 MB - Iterations: 3-50 - Parallelism: CPU cores</p> <p>Security: - \u2705 Memory-hard (expensive for attackers) - \u2705 Resistant to timing attacks - \u2705 Configurable security levels</p> <p>Usage: </p>Bash<pre><code>filevault encrypt file.txt -k argon2id -s strong\n</code></pre><p></p> <p>Security Levels: | Level    | Iterations | Memory | Time   | |----------|------------|--------|--------| | weak     | 1          | 4MB    | ~2ms   | | medium   | 2          | 16MB   | ~10ms  | | strong   | 3          | 64MB   | ~30ms  | | paranoid | 4          | 128MB  | ~60ms  |</p>"},{"location":"algorithms/ALGORITHMS/#pbkdf2-sha256sha512","title":"PBKDF2-SHA256/SHA512","text":"<p>Standards: RFC 8018, NIST SP 800-132 Type: Password-based KDF</p> <p>Description: Classic KDF using iterated hash functions. Less secure than Argon2 but widely supported.</p> <p>Security: - \u274c Not memory-hard (vulnerable to GPU attacks) - \u2705 Well-studied and standardized - \u2705 Fast to compute</p> <p>When to Use: - Legacy compatibility - Constrained environments - Compliance requirements</p>"},{"location":"algorithms/ALGORITHMS/#hash-functions","title":"Hash Functions","text":""},{"location":"algorithms/ALGORITHMS/#sha-256-recommended","title":"SHA-256 (Recommended)","text":"<p>Standards: FIPS 180-4 Output: 256 bits Performance: ~1800 MB/s</p> <p>Widely used, well-studied, suitable for most applications.</p>"},{"location":"algorithms/ALGORITHMS/#sha-512","title":"SHA-512","text":"<p>Standards: FIPS 180-4 Output: 512 bits Performance: ~400 MB/s</p> <p>Stronger but slower. Use for long-term security.</p>"},{"location":"algorithms/ALGORITHMS/#sha3-256sha3-512","title":"SHA3-256/SHA3-512","text":"<p>Standards: FIPS 202 Type: Keccak sponge construction</p> <p>NIST's latest standard. Different design from SHA-2, provides diversity.</p>"},{"location":"algorithms/ALGORITHMS/#blake2b","title":"BLAKE2b","text":"<p>Output: 512 bits Performance: ~810 MB/s \u26a1\u26a1\u26a1</p> <p>Modern, fast, secure. Preferred for new applications.</p>"},{"location":"algorithms/ALGORITHMS/#classical-ciphers","title":"Classical Ciphers","text":"<p>\u26a0\ufe0f FOR EDUCATIONAL PURPOSES ONLY - COMPLETELY INSECURE</p>"},{"location":"algorithms/ALGORITHMS/#caesar-cipher","title":"Caesar Cipher","text":"<p>Simple shift cipher. Breakable by brute-force (26 keys).</p>"},{"location":"algorithms/ALGORITHMS/#vigen\u00e8re-cipher","title":"Vigen\u00e8re Cipher","text":"<p>Polyalphabetic substitution. Breakable by Kasiski examination.</p>"},{"location":"algorithms/ALGORITHMS/#playfair-cipher","title":"Playfair Cipher","text":"<p>Digraph substitution. Breakable by frequency analysis.</p>"},{"location":"algorithms/ALGORITHMS/#hill-cipher","title":"Hill Cipher","text":"<p>Matrix-based encryption. Vulnerable to known-plaintext attacks.</p>"},{"location":"algorithms/ALGORITHMS/#substitution-cipher","title":"Substitution Cipher","text":"<p>Monoalphabetic substitution. Breakable by frequency analysis.</p> <p>Usage (educational only): </p>Bash<pre><code>filevault encrypt msg.txt -a caesar -p \"key\"\nfilevault encrypt msg.txt -a vigenere -p \"secretkey\"\n</code></pre><p></p>"},{"location":"algorithms/ALGORITHMS/#algorithm-selection-guide","title":"Algorithm Selection Guide","text":""},{"location":"algorithms/ALGORITHMS/#general-purpose","title":"General Purpose","text":"<p>\u2192 AES-256-GCM (default, best balance)</p>"},{"location":"algorithms/ALGORITHMS/#maximum-security","title":"Maximum Security","text":"<p>\u2192 Kyber-1024-Hybrid (quantum-resistant)</p>"},{"location":"algorithms/ALGORITHMS/#high-performance","title":"High Performance","text":"<p>\u2192 ChaCha20-Poly1305 (ARM/mobile) \u2192 AES-256-GCM (x86 with AES-NI)</p>"},{"location":"algorithms/ALGORITHMS/#long-term-storage","title":"Long-term Storage","text":"<p>\u2192 Kyber-1024-Hybrid (quantum threat) \u2192 Serpent-256-GCM (conservative classical)</p>"},{"location":"algorithms/ALGORITHMS/#legacy-compatibility","title":"Legacy Compatibility","text":"<p>\u2192 RSA-3072 (asymmetric) \u2192 AES-256-CBC (symmetric)</p>"},{"location":"algorithms/ALGORITHMS/#compliance","title":"Compliance","text":"<ul> <li>FIPS 140-2: AES-GCM, RSA, ECC, SHA-2</li> <li>NIST PQC: Kyber (ML-KEM), Dilithium (ML-DSA)</li> <li>International: Camellia, ARIA, SM4</li> </ul>"},{"location":"algorithms/ALGORITHMS/#security-best-practices","title":"Security Best Practices","text":"<ol> <li>Always use AEAD ciphers (GCM mode) for new applications</li> <li>Use Argon2id for password-based encryption</li> <li>Consider PQC for data stored &gt;5 years</li> <li>Never reuse nonces/IVs (FileVault handles this automatically)</li> <li>Use 256-bit keys when possible</li> <li>Avoid ECB mode (NEVER use in production)</li> <li>Keep software updated (crypto vulnerabilities are discovered)</li> </ol>"},{"location":"algorithms/ALGORITHMS/#references","title":"References","text":"<ul> <li>NIST Post-Quantum Cryptography</li> <li>RFC 8439 - ChaCha20-Poly1305</li> <li>NIST SP 800-38D - AES-GCM</li> <li>Botan Crypto Library</li> </ul>"},{"location":"algorithms/ARCHITECTURE/","title":"FileVault Architecture &amp; Workflow","text":""},{"location":"algorithms/ARCHITECTURE/#filevault-architecture--workflow","title":"FileVault Architecture &amp; Workflow","text":"<p>Technical documentation for FileVault's internal architecture, data flow, and operational workflows.</p>"},{"location":"algorithms/ARCHITECTURE/#table-of-contents","title":"Table of Contents","text":"<ul> <li>System Architecture</li> <li>Core Components</li> <li>Encryption Workflow</li> <li>Decryption Workflow</li> <li>File Format</li> <li>Security Design</li> <li>Performance Considerations</li> </ul>"},{"location":"algorithms/ARCHITECTURE/#system-architecture","title":"System Architecture","text":""},{"location":"algorithms/ARCHITECTURE/#high-level-overview","title":"High-Level Overview","text":"Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         CLI Layer                           \u2502\n\u2502  (Command Parsing, User Interaction, Progress Display)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Command Layer                            \u2502\n\u2502  encrypt_cmd \u2502 decrypt_cmd \u2502 keygen_cmd \u2502 benchmark_cmd     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Core Engine                               \u2502\n\u2502         CryptoEngine (Algorithm Registry)                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502              \u2502              \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Symmetric  \u2502 \u2502 Asymmetric \u2502 \u2502     PQC      \u2502\n\u2502  Algorithms \u2502 \u2502 Algorithms \u2502 \u2502  Algorithms  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502              \u2502              \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502               Botan 3.x Library                  \u2502\n\u2502  (Cryptographic Primitives, RNG, Key Management) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#component-responsibilities","title":"Component Responsibilities","text":"Component Responsibility CLI Layer Parse arguments, validate inputs, display progress Command Layer Implement business logic for each command Core Engine Algorithm registration, key derivation, streaming Crypto Algorithms Wrapper classes for Botan primitives File I/O Utils Memory-mapped I/O, buffered reading/writing Progress Utils Real-time progress bars, ETA calculation"},{"location":"algorithms/ARCHITECTURE/#core-components","title":"Core Components","text":""},{"location":"algorithms/ARCHITECTURE/#1-cryptoengine-corecrypto_enginecpp","title":"1. CryptoEngine (<code>core/crypto_engine.cpp</code>)","text":"<p>Purpose: Central registry and factory for all cryptographic operations.</p> <p>Key Methods: </p>C++<pre><code>class CryptoEngine {\n    // Algorithm registration\n    void register_algorithm(std::unique_ptr&lt;CryptoAlgorithm&gt; algo);\n\n    // Algorithm lookup\n    CryptoAlgorithm* get_algorithm(const std::string&amp; name);\n\n    // Key derivation\n    Result&lt;std::vector&lt;uint8_t&gt;&gt; derive_key(\n        const std::string&amp; password,\n        const std::vector&lt;uint8_t&gt;&amp; salt,\n        const KDFParams&amp; params\n    );\n\n    // File operations\n    Result&lt;void&gt; encrypt_file(const EncryptParams&amp; params);\n    Result&lt;void&gt; decrypt_file(const DecryptParams&amp; params);\n};\n</code></pre><p></p> <p>Initialization Flow: 1. Create CryptoEngine instance 2. Register all symmetric algorithms (AES, ChaCha20, etc.) 3. Register asymmetric algorithms (RSA, ECC) 4. Register PQC algorithms (Kyber, Dilithium) 5. Set default algorithm (AES-256-GCM)</p>"},{"location":"algorithms/ARCHITECTURE/#2-cryptoalgorithm-interface-corecrypto_algorithmhpp","title":"2. CryptoAlgorithm Interface (<code>core/crypto_algorithm.hpp</code>)","text":"<p>Purpose: Abstract interface for all encryption algorithms.</p> C++<pre><code>class CryptoAlgorithm {\npublic:\n    virtual ~CryptoAlgorithm() = default;\n\n    // Metadata\n    virtual std::string name() const = 0;\n    virtual std::string description() const = 0;\n    virtual size_t key_size() const = 0;\n    virtual size_t iv_size() const = 0;\n    virtual bool is_aead() const = 0;\n\n    // Encryption\n    virtual Result&lt;std::vector&lt;uint8_t&gt;&gt; encrypt(\n        const std::vector&lt;uint8_t&gt;&amp; plaintext,\n        const std::vector&lt;uint8_t&gt;&amp; key,\n        const std::vector&lt;uint8_t&gt;&amp; iv\n    ) = 0;\n\n    // Decryption\n    virtual Result&lt;std::vector&lt;uint8_t&gt;&gt; decrypt(\n        const std::vector&lt;uint8_t&gt;&amp; ciphertext,\n        const std::vector&lt;uint8_t&gt;&amp; key,\n        const std::vector&lt;uint8_t&gt;&amp; iv\n    ) = 0;\n};\n</code></pre> <p>Implementations: - AEAD Ciphers: <code>AES_GCM</code>, <code>ChaCha20Poly1305</code>, <code>Serpent_GCM</code> - Block Modes: <code>AES_CBC</code>, <code>AES_CTR</code>, <code>AES_XTS</code> - Asymmetric: <code>RSA</code>, <code>ECCHybrid</code> - PQC: <code>KyberHybrid</code>, <code>KyberKEM</code>, <code>Dilithium</code></p>"},{"location":"algorithms/ARCHITECTURE/#3-streaming-engine-corestreamingcpp","title":"3. Streaming Engine (<code>core/streaming.cpp</code>)","text":"<p>Purpose: Memory-efficient encryption/decryption for large files.</p> <p>Key Features: - Adaptive Chunking: Adjusts chunk size based on available RAM - Zero-Copy I/O: Memory-mapped files when beneficial - Progress Tracking: Real-time updates with ETA - Error Recovery: Atomic operations with rollback</p> <p>Memory Management: </p>C++<pre><code>class StreamingEngine {\n    // Calculate optimal chunk size\n    size_t calculate_chunk_size() {\n        size_t available_memory = get_available_memory();\n        size_t file_size = get_file_size(input_path);\n\n        // Use 10% of available RAM, min 1MB, max 64MB\n        size_t chunk = std::clamp(\n            available_memory / 10,\n            1ULL &lt;&lt; 20,   // 1 MB\n            64ULL &lt;&lt; 20   // 64 MB\n        );\n\n        return chunk;\n    }\n};\n</code></pre><p></p> <p>Processing Flow: 1. Open input file (read mode) 2. Create output file (write mode) 3. Calculate optimal chunk size 4. Initialize progress bar 5. Process chunks:    - Read chunk from input    - Encrypt/decrypt chunk    - Write to output    - Update progress 6. Finalize and verify</p>"},{"location":"algorithms/ARCHITECTURE/#4-file-format-formatfile_headercpp","title":"4. File Format (<code>format/file_header.cpp</code>)","text":"<p>Purpose: Standardized format for encrypted files (<code>.fvlt</code>).</p> <p>Structure: </p>Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  File Header                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Magic Number (8 bytes): \"FILEVLT\\x00\"               \u2502\n\u2502 Version (2 bytes): 0x0100 (v1.0)                    \u2502\n\u2502 Algorithm ID (2 bytes): Enum value                  \u2502\n\u2502 KDF Type (1 byte): Argon2id/PBKDF2/Scrypt           \u2502\n\u2502 Security Level (1 byte): weak/medium/strong         \u2502\n\u2502 Flags (2 bytes): Compression, PQC, etc.             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Salt (32 bytes): Random salt for KDF                \u2502\n\u2502 Nonce/IV (12-16 bytes): Algorithm-specific          \u2502\n\u2502 KDF Parameters (variable): Iterations, memory       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Original Filename Length (2 bytes)                  \u2502\n\u2502 Original Filename (UTF-8)                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Metadata Length (4 bytes)                           \u2502\n\u2502 Metadata (JSON): timestamps, compression, etc.      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Header MAC (32 bytes): HMAC-SHA256 of header        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                     \u2502\n\u2502              Encrypted Payload                      \u2502\n\u2502                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Authentication Tag (16 bytes): For AEAD modes       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre><p></p> <p>Header Fields:</p> Field Size Description Magic Number 8 bytes \"FILEVLT\\x00\" identifier Version 2 bytes Major.Minor (0x0100 = 1.0) Algorithm ID 2 bytes Algorithm enum value KDF Type 1 byte 0=Argon2id, 1=PBKDF2, 2=Scrypt Security Level 1 byte 0=weak, 1=medium, 2=strong, 3=paranoid Flags 2 bytes Bit flags for features Salt 32 bytes Random salt for key derivation Nonce/IV 12-16 bytes Algorithm-specific initialization vector KDF Params Variable Iterations, memory cost, parallelism Filename Variable UTF-8 encoded original filename Metadata Variable JSON encoded metadata Header MAC 32 bytes HMAC-SHA256 for header integrity <p>Flags Bitfield: </p>Text Only<pre><code>Bit 0: Compression enabled\nBit 1: PQC algorithm used\nBit 2: Asymmetric encryption\nBit 3: Steganography applied\nBit 4-15: Reserved\n</code></pre><p></p>"},{"location":"algorithms/ARCHITECTURE/#encryption-workflow","title":"Encryption Workflow","text":""},{"location":"algorithms/ARCHITECTURE/#password-based-encryption-symmetric","title":"Password-Based Encryption (Symmetric)","text":"Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 User Input  \u2502\n\u2502 - File      \u2502\n\u2502 - Password  \u2502\n\u2502 - Algorithm \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1. Generate Random Salt (32 bytes)  \u2502\n\u2502    crypto::random_bytes(32)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2. Derive Key from Password         \u2502\n\u2502    Argon2id(password, salt, params) \u2502\n\u2502    \u2192 256-bit key                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 3. Generate Random Nonce (12 bytes) \u2502\n\u2502    crypto::random_bytes(12)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 4. Create File Header               \u2502\n\u2502    - Magic, version, algorithm ID   \u2502\n\u2502    - Salt, nonce, KDF params        \u2502\n\u2502    - Original filename, metadata    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 5. Compute Header MAC               \u2502\n\u2502    HMAC-SHA256(header, key)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 6. Write Header to Output File      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 7. Encrypt File in Chunks           \u2502\n\u2502    FOR each chunk:                  \u2502\n\u2502      - Read plaintext chunk         \u2502\n\u2502      - Encrypt with AES-GCM         \u2502\n\u2502      - Write ciphertext chunk       \u2502\n\u2502      - Update progress bar          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 8. Write Authentication Tag         \u2502\n\u2502    (For AEAD modes like GCM)        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 9. Finalize and Close Files         \u2502\n\u2502    - Sync to disk                   \u2502\n\u2502    - Verify output file size        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Success!   \u2502\n\u2502 .fvlt file  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#public-key-encryption-asymmetric","title":"Public Key Encryption (Asymmetric)","text":""},{"location":"algorithms/ARCHITECTURE/#rsa-encryption","title":"RSA Encryption","text":"Text Only<pre><code>1. Load RSA public key from PEM file\n2. Generate random AES-256 key (32 bytes)\n3. Encrypt file with AES-256-GCM:\n   - Derive key and nonce\n   - Encrypt payload\n4. Encrypt AES key with RSA public key:\n   - RSA-OAEP encryption\n   - Store encrypted key in header\n5. Write header + encrypted payload\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#ecc-hybrid-encryption","title":"ECC Hybrid Encryption","text":"Text Only<pre><code>1. Load ECC public key\n2. Generate ephemeral ECC keypair\n3. Perform ECDH key agreement:\n   - shared_secret = ECDH(ephemeral_private, recipient_public)\n4. Derive AES key from shared secret:\n   - key = KDF(shared_secret, salt)\n5. Encrypt file with AES-256-GCM\n6. Include ephemeral public key in header\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#kyber-hybrid-encryption-pqc","title":"Kyber-Hybrid Encryption (PQC)","text":"Text Only<pre><code>1. Load Kyber-1024 public key\n2. Perform KEM encapsulation:\n   - (ciphertext, shared_secret) = Kyber.Encapsulate(public_key)\n3. Derive AES key from shared secret:\n   - key = HKDF(shared_secret, salt, \"FileVault\")\n4. Encrypt file with AES-256-GCM\n5. Store KEM ciphertext in header\n6. Provides quantum resistance!\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#decryption-workflow","title":"Decryption Workflow","text":""},{"location":"algorithms/ARCHITECTURE/#password-based-decryption","title":"Password-Based Decryption","text":"Text Only<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 User Input  \u2502\n\u2502 - .fvlt     \u2502\n\u2502 - Password  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1. Read and Parse File Header       \u2502\n\u2502    - Verify magic number            \u2502\n\u2502    - Extract algorithm ID, KDF type \u2502\n\u2502    - Read salt, nonce, params       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2. Derive Key from Password         \u2502\n\u2502    Use same KDF with stored params: \u2502\n\u2502    Argon2id(password, salt, params) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 3. Verify Header MAC                \u2502\n\u2502    Compute HMAC-SHA256(header, key) \u2502\n\u2502    Compare with stored MAC          \u2502\n\u2502    \u2192 If mismatch: Wrong password!   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 4. Initialize Decryption Cipher     \u2502\n\u2502    AES-GCM with derived key + nonce \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 5. Decrypt File in Chunks           \u2502\n\u2502    FOR each chunk:                  \u2502\n\u2502      - Read ciphertext chunk        \u2502\n\u2502      - Decrypt with AES-GCM         \u2502\n\u2502      - Write plaintext chunk        \u2502\n\u2502      - Update progress bar          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 6. Verify Authentication Tag        \u2502\n\u2502    (For AEAD modes)                 \u2502\n\u2502    \u2192 If invalid: File tampered!     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 7. Restore Original Filename        \u2502\n\u2502    Use filename from header         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Success!   \u2502\n\u2502 Decrypted   \u2502\n\u2502    file     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#public-key-decryption","title":"Public Key Decryption","text":""},{"location":"algorithms/ARCHITECTURE/#rsa-decryption","title":"RSA Decryption","text":"Text Only<pre><code>1. Read header and extract encrypted AES key\n2. Decrypt AES key with RSA private key:\n   - plaintext_key = RSA_Decrypt(encrypted_key, private_key)\n3. Decrypt file with recovered AES key\n4. Verify authentication tag\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#ecc-decryption","title":"ECC Decryption","text":"Text Only<pre><code>1. Extract ephemeral public key from header\n2. Load recipient's private key\n3. Perform ECDH:\n   - shared_secret = ECDH(recipient_private, ephemeral_public)\n4. Derive AES key from shared secret\n5. Decrypt file with AES-256-GCM\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#kyber-hybrid-decryption","title":"Kyber-Hybrid Decryption","text":"Text Only<pre><code>1. Read KEM ciphertext from header\n2. Perform KEM decapsulation:\n   - shared_secret = Kyber.Decapsulate(ciphertext, private_key)\n3. Derive AES key from shared secret\n4. Decrypt file with AES-256-GCM\n5. Quantum-resistant decryption complete!\n</code></pre>"},{"location":"algorithms/ARCHITECTURE/#security-design","title":"Security Design","text":""},{"location":"algorithms/ARCHITECTURE/#defense-in-depth","title":"Defense-in-Depth","text":"<p>Layer 1: Algorithm Security - Use only well-vetted, NIST-approved algorithms - AEAD ciphers for authenticated encryption - Post-quantum algorithms for future-proofing</p> <p>Layer 2: Key Management - Strong KDF (Argon2id) with tunable parameters - Random salt per encryption (prevents rainbow tables) - Secure key derivation from passwords</p> <p>Layer 3: Implementation Security - Use Botan (audited crypto library) - Constant-time operations where critical - Secure memory wiping (zero key material)</p> <p>Layer 4: File Integrity - Header MAC prevents tampering - AEAD authentication tag for payload - Version field allows format migration</p> <p>Layer 5: Operational Security - Nonce uniqueness enforced - Atomic file operations (no partial writes) - Progress indication without leaking data</p>"},{"location":"algorithms/ARCHITECTURE/#threat-model","title":"Threat Model","text":"<p>Protected Against: - \u2705 Brute-force password attacks (strong KDF) - \u2705 Dictionary attacks (salt + iterations) - \u2705 Chosen-ciphertext attacks (AEAD) - \u2705 Tampering (MAC + auth tag) - \u2705 Traffic analysis (encrypted metadata) - \u2705 Quantum attacks (PQC algorithms)</p> <p>Not Protected Against: - \u274c Weak passwords (use strong passwords!) - \u274c Keyloggers/malware (OS-level threat) - \u274c Side-channel attacks (hardware-level) - \u274c Coercion (rubber-hose cryptanalysis)</p>"},{"location":"algorithms/ARCHITECTURE/#randomness","title":"Randomness","text":"<p>Sources: - Primary: OS CSPRNG (<code>/dev/urandom</code>, <code>CryptGenRandom</code>) - Library: Botan's AutoSeeded_RNG (entropy pooling)</p> <p>Usage: - Salt generation (32 bytes per encryption) - Nonce/IV generation (12-16 bytes) - Key generation (asymmetric keypairs) - Session keys (hybrid encryption)</p> <p>Quality Assurance: - DRBG health checks - Entropy accumulation - Reseeding after fork (Unix)</p>"},{"location":"algorithms/ARCHITECTURE/#performance-considerations","title":"Performance Considerations","text":""},{"location":"algorithms/ARCHITECTURE/#bottlenecks","title":"Bottlenecks","text":"<ol> <li> <p>I/O Operations (Usually the slowest)    - Solution: Buffered I/O, memory mapping</p> </li> <li> <p>Key Derivation (Intentionally slow)    - Solution: Cache derived keys (carefully)</p> </li> <li> <p>Encryption/Decryption (CPU-bound)    - Solution: Hardware acceleration (AES-NI)</p> </li> </ol>"},{"location":"algorithms/ARCHITECTURE/#optimizations","title":"Optimizations","text":"<p>1. Chunked Processing </p>C++<pre><code>// Adaptive chunk size based on file size and RAM\nsize_t chunk_size = calculate_optimal_chunk_size(file_size);\n\n// Process in parallel (future enhancement)\n#pragma omp parallel for\nfor (size_t i = 0; i &lt; num_chunks; ++i) {\n    process_chunk(i);\n}\n</code></pre><p></p> <p>2. Hardware Acceleration - AES-NI instructions for AES-GCM - AVX2/AVX512 for ChaCha20 - Compiler optimizations (<code>-O3 -march=native</code>)</p> <p>3. Memory Management - Stack allocation for small buffers - Arena allocators for frequent allocations - Secure wiping on deallocation</p> <p>4. Progress Feedback - Non-blocking progress updates - Minimal overhead (&lt;1% CPU) - Accurate ETA calculation</p>"},{"location":"algorithms/ARCHITECTURE/#benchmarks","title":"Benchmarks","text":"<p>Test Environment: Intel i7-11800H, 32GB RAM, NVMe SSD</p> Operation Throughput Notes AES-256-GCM Encrypt ~700 MB/s Hardware accelerated ChaCha20-Poly1305 ~600 MB/s Software optimized Kyber-1024-Hybrid ~650 MB/s Minimal overhead Argon2id (medium) ~10ms Per key derivation RSA-4096 Keygen ~1.7s One-time cost Kyber-1024 Keygen ~0.4ms Fast PQC!"},{"location":"algorithms/ARCHITECTURE/#error-handling","title":"Error Handling","text":""},{"location":"algorithms/ARCHITECTURE/#result-type","title":"Result Type","text":"C++<pre><code>template&lt;typename T&gt;\nclass Result {\n    std::variant&lt;T, Error&gt; value_;\n\npublic:\n    bool is_ok() const;\n    bool is_err() const;\n    T unwrap();\n    Error error();\n};\n</code></pre> <p>Usage: </p>C++<pre><code>auto result = encrypt_file(params);\nif (result.is_err()) {\n    console::error(\"Encryption failed: {}\", result.error().message());\n    return 1;\n}\n</code></pre><p></p>"},{"location":"algorithms/ARCHITECTURE/#error-categories","title":"Error Categories","text":"<ol> <li>I/O Errors: File not found, permission denied</li> <li>Crypto Errors: Wrong password, corrupted file</li> <li>Format Errors: Invalid header, unsupported version</li> <li>System Errors: Out of memory, disk full</li> </ol>"},{"location":"algorithms/ARCHITECTURE/#future-enhancements","title":"Future Enhancements","text":""},{"location":"algorithms/ARCHITECTURE/#planned-features","title":"Planned Features","text":"<ol> <li> <p>Parallel Processing    - Multi-threaded chunk encryption    - SIMD optimizations</p> </li> <li> <p>Cloud Integration    - S3/Azure Blob Storage support    - Streaming encryption to cloud</p> </li> <li> <p>Key Management    - Hardware security module (HSM) support    - TPM integration for key protection</p> </li> <li> <p>Advanced Compression    - Context-aware compression    - Encryption + compression pipeline</p> </li> <li> <p>Metadata Encryption    - Hide file size (padding)    - Encrypted filenames</p> </li> </ol>"},{"location":"algorithms/ARCHITECTURE/#references","title":"References","text":"<ul> <li>Botan Crypto Library</li> <li>NIST Cryptographic Standards</li> <li>RFC 8439 - ChaCha20-Poly1305</li> <li>RFC 9106 - Argon2</li> </ul>"},{"location":"algorithms/asymmetric/ecc/","title":"ECC (Elliptic Curve Cryptography)","text":""},{"location":"algorithms/asymmetric/ecc/#ecc-elliptic-curve-cryptography","title":"ECC (Elliptic Curve Cryptography)","text":""},{"location":"algorithms/asymmetric/ecc/#0-t\u00f3m-t\u1eaft-ng\u1eafn","title":"0. T\u00f3m t\u1eaft ng\u1eafn","text":"<p>ECC cung c\u1ea5p: kh\u00f3a nh\u1ecf, hi\u1ec7u n\u0103ng cao, ph\u00f9 h\u1ee3p cho key-exchange (ECDH), hybrid encryption (ECIES) v\u00e0 ch\u1eef k\u00fd s\u1ed1 (ECDSA). FileVault d\u00f9ng ECC cho ECDH/ECIES.</p>"},{"location":"algorithms/asymmetric/ecc/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1--b\u1ea3o-v\u1ec7-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n \u2014 Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 &amp; B\u1ea3o v\u1ec7 g\u00ec","text":"<ul> <li>M\u1ee5c \u0111\u00edch: \u0111\u1ea1t th\u1ecfa thu\u1eadn kh\u00f3a b\u00ed m\u1eadt (key exchange) v\u00e0/ho\u1eb7c ch\u1eef k\u00fd s\u1ed1 v\u1edbi k\u00edch th\u01b0\u1edbc kh\u00f3a nh\u1ecf.</li> <li>B\u1ea3o v\u1ec7: t\u00ednh b\u00ed m\u1eadt (confidentiality) c\u1ee7a kh\u00f3a phi\u00ean, t\u00ednh to\u00e0n v\u1eb9n &amp; x\u00e1c th\u1ef1c khi d\u00f9ng v\u1edbi ch\u1eef k\u00fd.</li> <li>V\u1ea5n \u0111\u1ec1 c\u01a1 b\u1ea3n \u0111\u01b0\u1ee3c d\u00f9ng: b\u00e0i to\u00e1n Logarit r\u1eddi r\u1ea1c tr\u00ean \u0111\u01b0\u1eddng cong elliptic (ECDLP) \u2014 kh\u00f3 t\u00ednh to\u00e1n d t\u1eeb Q = dG.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#2-to\u00e1n-h\u1ecdc--c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc &amp; C\u00f4ng th\u1ee9c","text":"<ul> <li>\u0110\u01b0\u1eddng cong (Weierstrass): y^2 = x^3 + a x + b  (mod p) cho tr\u01b0\u1eddng h\u1eefu h\u1ea1n.</li> <li>Nh\u00f3m \u0111i\u1ec3m: t\u1eadp c\u00e1c \u0111i\u1ec3m (x,y) th\u1ecfa ph\u01b0\u01a1ng tr\u00ecnh + \u0111i\u1ec3m v\u00f4 c\u1ef1c O.</li> <li>Private key: d (s\u1ed1 nguy\u00ean, 1 &lt;= d &lt; n), v\u1edbi n l\u00e0 order c\u1ee7a base point G.</li> <li>Public key: Q = d \u00d7 G.</li> <li>ECDH shared secret: S = d_A \u00d7 Q_B = d_A d_B \u00d7 G (thu\u1ed9c c\u00f9ng \u0111i\u1ec3m).</li> <li>KDF: K = KDF(Sx || context) \u2014 kh\u00f4ng d\u00f9ng tr\u1ef1c ti\u1ebfp t\u1ecda \u0111\u1ed9 x l\u00e0m key.</li> <li>Ch\u1eef k\u00fd (ECDSA) t\u00f3m t\u1eaft: r = (kG).x mod n; s = k^{-1}(H(m)+d_A r) mod n.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-quy-tr\u00ecnh-ng\u1eafn","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (quy tr\u00ecnh ng\u1eafn)","text":"<ul> <li>ECDH:<ol> <li>M\u1ed7i b\u00ean t\u1ea1o (d, Q).</li> <li>Trao Q; m\u1ed7i b\u00ean t\u00ednh S = d \u00d7 Q_peer.</li> <li>D\u00f9ng KDF l\u00ean S \u0111\u1ec3 t\u1ea1o kh\u00f3a giao ti\u1ebfp (AES, HMAC...).</li> </ol> </li> <li>ECIES (hybrid):<ol> <li>Sinh ephemeral key (d_e, Q_e).</li> <li>Shared = d_e \u00d7 Q_recipient.</li> <li>KDF(shared) -&gt; K_enc || K_mac.</li> <li>AES-GCM(K_enc) m\u00e3 h\u00f3a d\u1eef li\u1ec7u; k\u00e8m Q_e v\u00e0 tag.</li> <li>G\u1eedi Q_e || ciphertext || tag.</li> </ol> </li> </ul>"},{"location":"algorithms/asymmetric/ecc/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Private key: integer d (SEC1).</li> <li>Public key \u0111i\u1ec3m Q:<ul> <li>Uncompressed: 0x04 || X || Y</li> <li>Compressed: 0x02/0x03 || X</li> </ul> </li> <li>Serialization: SEC1, X.509 SubjectPublicKeyInfo (DER/PEM).</li> <li>ECIES payload: Ephemeral_Public || Ciphertext || Tag || (optional) KDF-salt/info</li> <li>KDF input: Sx (coordinate) || context info || optional salt</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>RSA: ECC nh\u1ecf h\u01a1n nhi\u1ec1u v\u1ec1 key size cho c\u00f9ng security level (RSA-3072 \u2248 P-256). RSA th\u00edch h\u1ee3p cho verify-heavy workloads; ECC t\u1ed1t cho constrained devices.</li> <li>DH (finite-field): ECC cho c\u00f9ng security v\u1edbi \u0111\u1ed9 d\u00e0i nh\u1ecf h\u01a1n, t\u00ednh to\u00e1n nhanh h\u01a1n tr\u00ean nhi\u1ec1u n\u1ec1n t\u1ea3ng.</li> <li>X25519/X448: thi\u1ebft k\u1ebf hi\u1ec7n \u0111\u1ea1i, ch\u1ed1ng side-channel, d\u1ec5 implement \u0111\u00fang; khi c\u00f3 th\u1ec3, d\u00f9ng X25519 cho key-exchange thay v\u00ec P-256 n\u1ebfu c\u1ea7n t\u00ednh \u0111\u01a1n gi\u1ea3n v\u00e0 an to\u00e0n.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<p>ECDH flow: </p> <pre><code>flowchart LR\n    A[Alice gen d_A,Q_A] --&gt;|send Q_A| B(Bob)\n    B[Bob gen d_B,Q_B] --&gt;|send Q_B| A\n    A --&gt;|compute S=d_A*Q_B| C[Shared Secret S]\n    B --&gt;|compute S=d_B*Q_A| C</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p> <p>ECIES flow: </p> <pre><code>flowchart LR\n    Sender --&gt;|gen d_e,Q_e| Sec[Ephemeral Key]\n    Sec --&gt;|ECDH with Q_recipient| KDF[KDF -&gt; K_enc,K_mac]\n    KDF --&gt;|AES-GCM encrypt| CT[Ciphertext + Tag]\n    Sender --&gt;|send Q_e &amp;#124;&amp;#124; CT| Recipient\n    Recipient --&gt;|ECDH d_recipient * Q_e -&gt; KDF| Decrypt</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/asymmetric/ecc/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng ki\u1ec3m tra t\u00ednh h\u1ee3p l\u1ec7 c\u1ee7a public key (point validation).</li> <li>D\u00f9ng t\u1ecda \u0111\u1ed9 x tr\u1ef1c ti\u1ebfp l\u00e0m key m\u00e0 kh\u00f4ng qua KDF.</li> <li>D\u00f9ng deterministic ephemeral k kh\u00f4ng an to\u00e0n (cho ECDSA).</li> <li>Kh\u00f4ng ki\u1ec3m so\u00e1t curve parameters (d\u00f9ng curve kh\u00f4ng chu\u1ea9n).</li> <li>Forgetting cofactor handling (small-subgroup attacks) tr\u00ean curve c\u00f3 cofactor \u2260 1.</li> <li>Kh\u00f4ng b\u1ea3o v\u1ec7 b\u00ean kh\u1ecfi side-channel tr\u00ean private scalar.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#8-threat-model-t\u00f3m-t\u1eaft","title":"8. Threat Model (t\u00f3m t\u1eaft)","text":"<ul> <li>Attacker \u0111\u1ecdc / thay \u0111\u1ed5i traffic (MitM).</li> <li>Attacker c\u1ed1 g\u1eafng ph\u1ee5c h\u1ed3i private key t\u1eeb public th\u00f4ng qua ECDLP (computational).</li> <li>Attacker th\u1ef1c hi\u1ec7n fault/side-channel attacks tr\u00ean thi\u1ebft b\u1ecb.</li> <li>Attacker g\u1eedi public key gi\u1ea3 m\u1ea1o (invalid curve points).</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n validate public points (on-curve, not infinity, correct order).</li> <li>D\u00f9ng KDF chu\u1ea9n (HKDF) v\u1edbi salt/context.</li> <li>D\u00f9ng curves c\u00f3 thi\u1ebft k\u1ebf an to\u00e0n (x25519 ho\u1eb7c NIST P- curves v\u1edbi c\u1ea9n tr\u1ecdng).</li> <li>B\u1ea3o v\u1ec7 private key ch\u1ed1ng side-channel (constant-time, blinding).</li> <li>S\u1eed d\u1ee5ng ephemeral keys cho m\u1ed7i session; tr\u00e1nh reuse.</li> <li>\u00c1p d\u1ee5ng authenticated encryption (AES-GCM, ChaCha20-Poly1305).</li> <li>\u00c1p d\u1ee5ng certificate pinning / signed public keys \u0111\u1ec3 tr\u00e1nh MitM.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#10-test-vectors-t\u1ea1o-reproducible-vectors","title":"10. Test Vectors (t\u1ea1o reproducible vectors)","text":"<ul> <li>C\u00e1ch reproducible: derive private scalar t\u1eeb seed b\u1eb1ng h\u00e0m hash r\u1ed3i ec.derive_private_key.</li> <li>V\u00ed d\u1ee5 script Python (sinh vectors x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c): Python<pre><code>import hashlib\nfrom cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives import serialization\n\ndef derive_privint(seed: bytes, curve=ec.SECP256R1()):\n        h = hashlib.sha256(seed).digest()\n        n = curve.key_size  # bits\n        priv_int = int.from_bytes(h, \"big\")\n        # reduce mod curve order:\n        order = curve.curve.order if hasattr(curve, \"curve\") else int(\"0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f\",16)\n        priv = (priv_int % (order - 1)) + 1\n        return ec.derive_private_key(priv, curve)\n\ndef gen_vector(seed_a, seed_b):\n        a = derive_privint(seed_a)\n        b = derive_privint(seed_b)\n        pa = a.public_key().public_bytes(serialization.Encoding.X962, serialization.PublicFormat.UncompressedPoint)\n        pb = b.public_key().public_bytes(serialization.Encoding.X962, serialization.PublicFormat.UncompressedPoint)\n        shared_a = a.exchange(ec.ECDH(), b.public_key())\n        shared_b = b.exchange(ec.ECDH(), a.public_key())\n        return {\n                \"seed_a\": seed_a.hex(),\n                \"seed_b\": seed_b.hex(),\n                \"pub_a\": pa.hex(),\n                \"pub_b\": pb.hex(),\n                \"shared_a\": shared_a.hex(),\n                \"shared_b\": shared_b.hex()\n        }\n\nif __name__ == \"__main__\":\n        v = gen_vector(b\"Alice seed\", b\"Bob seed\")\n        print(v)\n</code></pre></li> <li>K\u1ebft qu\u1ea3 t\u1eeb script tr\u00ean l\u00e0 test vector c\u00f3 th\u1ec3 d\u00f9ng \u0111\u1ec3 ki\u1ec3m tra interoperability.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#11-code-v\u00ed-d\u1ee5-ng\u1eafn","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn)","text":"<p>Python ECDH minimal (cryptography): </p>Python<pre><code>from cryptography.hazmat.primitives.asymmetric import ec\nfrom cryptography.hazmat.primitives import serialization, hashes\nfrom cryptography.hazmat.primitives.kdf.hkdf import HKDF\n\ndef generate_ecc_key():\n        return ec.generate_private_key(ec.SECP256R1())\n\ndef ecdh_to_aes_key(priv, peer_pub):\n        shared = priv.exchange(ec.ECDH(), peer_pub)\n        return HKDF(algorithm=hashes.SHA256(), length=32, salt=None, info=b\"filevault ec\").derive(shared)\n</code></pre> (ECIES implementation requires AEAD + key-splitting via KDF \u2014 s\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n AEAD chu\u1ea9n.)<p></p>"},{"location":"algorithms/asymmetric/ecc/#12-checklist-b\u1ea3o-m\u1eadt-m\u1edf-r\u1ed9ng","title":"12. Checklist B\u1ea3o M\u1eadt (m\u1edf r\u1ed9ng)","text":"<ul> <li> D\u00f9ng curve chu\u1ea9n v\u00e0 \u0111\u01b0\u1ee3c review (X25519 ho\u1eb7c P-256/P-384/P-521 n\u1ebfu c\u1ea7n).</li> <li> Validate public keys: on-curve, not infinity, correct order.</li> <li> D\u00f9ng KDF (HKDF) tr\u00ean shared secret tr\u01b0\u1edbc khi l\u00e0m key.</li> <li> D\u00f9ng AEAD (AES-GCM/ChaCha20-Poly1305) cho payload.</li> <li> S\u1eed d\u1ee5ng ephemeral keys cho m\u1ed7i phi\u00ean (ECIES/ECDHE).</li> <li> B\u1ea3o v\u1ec7 private keys kh\u1ecfi side-channel (constant-time, blinding).</li> <li> Kh\u00f4ng t\u00e1i s\u1eed d\u1ee5ng nonces/ephemeral secrets.</li> <li> Ki\u1ec3m th\u1eed b\u1eb1ng test vectors reproducible.</li> <li> Ki\u1ec3m tra t\u01b0\u01a1ng th\u00edch serialization (compressed/uncompressed) v\u00e0 chu\u1ea9n h\u00f3a format.</li> <li> Th\u00eam authentication cho public keys (certificates/Signatures) \u0111\u1ec3 tr\u00e1nh MitM.</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#13-ghi-ch\u00fa-ng\u1eafn-v\u1ec1-filevault","title":"13. Ghi ch\u00fa ng\u1eafn v\u1ec1 FileVault","text":"<ul> <li>\u00c1p d\u1ee5ng c\u00e1c best-practices tr\u00ean khi tri\u1ec3n khai ECDH/ECIES trong FileVault.</li> <li>N\u1ebfu c\u00f3 th\u1ec3, \u01b0u ti\u00ean X25519 cho key-exchange \u0111\u01a1n gi\u1ea3n v\u00e0 an to\u00e0n; d\u00f9ng NIST curves khi c\u1ea7n t\u01b0\u01a1ng th\u00edch.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o chu\u1ea9n</p>"},{"location":"algorithms/asymmetric/ecc/#standards--rfcs","title":"Standards &amp; RFCs","text":"<ul> <li>NIST SP 800-186: Recommendations for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters</li> <li> <p>https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186.pdf</p> </li> <li> <p>NIST FIPS 186-5: Digital Signature Standard (DSS)</p> </li> <li> <p>https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf</p> </li> <li> <p>RFC 6090: Fundamental Elliptic Curve Cryptography Algorithms</p> </li> <li> <p>https://www.rfc-editor.org/rfc/rfc6090.html</p> </li> <li> <p>RFC 5639: Elliptic Curve Cryptography (ECC) Brainpool Curves</p> </li> <li> <p>https://www.rfc-editor.org/rfc/rfc5639.html</p> </li> <li> <p>RFC 7748: Elliptic Curves for Security (X25519, X448)</p> </li> <li> <p>https://www.rfc-editor.org/rfc/rfc7748.html</p> </li> <li> <p>RFC 5903: Elliptic Curve Groups modulo a Prime (ECP Groups) for IKE and IKEv2</p> </li> <li>https://www.rfc-editor.org/rfc/rfc5903.html</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#ecies--hybrid-encryption","title":"ECIES &amp; Hybrid Encryption","text":"<ul> <li>IEEE 1363a-2004: Standard Specifications for Public-Key Cryptography (ECIES)</li> <li>ISO/IEC 18033-2: Encryption algorithms - Part 2: Asymmetric ciphers (ECIES)</li> <li>SECG SEC 1 v2.0: Elliptic Curve Cryptography</li> <li>https://www.secg.org/sec1-v2.pdf</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#implementation-guides","title":"Implementation Guides","text":"<ul> <li>OpenSSL EVP_PKEY-EC: Elliptic Curve Key Management</li> <li> <p>https://www.openssl.org/docs/man3.0/man7/EVP_PKEY-EC.html</p> </li> <li> <p>NIST SP 800-56A Rev. 3: Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography</p> </li> <li> <p>https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</p> </li> <li> <p>NIST SP 800-135 Rev. 1: Recommendation for Existing Application-Specific Key Derivation Functions</p> </li> <li>https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-135r1.pdf</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#security-analysis","title":"Security Analysis","text":"<ul> <li>SafeCurves: Choosing safe curves for elliptic-curve cryptography</li> <li> <p>https://safecurves.cr.yp.to/</p> </li> <li> <p>IACR ePrint Archive: ECC security research papers</p> </li> <li>https://eprint.iacr.org/</li> </ul>"},{"location":"algorithms/asymmetric/ecc/#library-documentation","title":"Library Documentation","text":"<ul> <li>Cryptography.io (Python): Elliptic Curve Documentation</li> <li> <p>https://cryptography.io/en/latest/hazmat/primitives/asymmetric/ec/</p> </li> <li> <p>BoringSSL: Google's fork with ECC implementations</p> </li> <li>https://boringssl.googlesource.com/boringssl/</li> </ul>"},{"location":"algorithms/asymmetric/rsa/","title":"RSA (Rivest\u2013Shamir\u2013Adleman)","text":""},{"location":"algorithms/asymmetric/rsa/#rsa-rivestshamiradleman","title":"RSA (Rivest\u2013Shamir\u2013Adleman)","text":""},{"location":"algorithms/asymmetric/rsa/#0-filevault-context-\u1ee9ng-d\u1ee5ng-trong-h\u1ec7-th\u1ed1ng-m\u00e3-h\u00f3a-file","title":"0. FileVault context (\u1ee9ng d\u1ee5ng trong h\u1ec7 th\u1ed1ng m\u00e3 h\u00f3a file)","text":"<ul> <li>M\u1ee5c ti\u00eau: t\u00edch h\u1ee3p RSA v\u00e0o h\u1ec7 th\u1ed1ng \"filevault\" \u0111\u1ec3 b\u1ea3o v\u1ec7 t\u1eadp tin tr\u00ean \u0111\u0129a/backup b\u1eb1ng c\u00e1ch b\u1ecdc (wrap) kh\u00f3a phi\u00ean (symmetric key) v\u00e0 qu\u1ea3n l\u00fd metadata, kh\u00f4ng d\u00f9ng RSA \u0111\u1ec3 m\u00e3 h\u00f3a d\u1eef li\u1ec7u l\u1edbn tr\u1ef1c ti\u1ebfp.</li> <li>Ki\u1ebfn tr\u00fac chung:<ul> <li>Hybrid: AES-GCM (file content) + RSA-OAEP (wrap AES key). AES key \u0111\u01b0\u1ee3c sinh per-file ho\u1eb7c per-session b\u1eb1ng CSPRNG.</li> <li>Metadata k\u00e8m theo file: phi\u00ean b\u1ea3n \u0111\u1ecbnh d\u1ea1ng, key_id, wrapped_key (RSA-OAEP), iv, ciphertext, tag, optional signature (RSA-PSS) c\u1ee7a metadata/header.</li> <li>Private key RSA n\u1eb1m trong HSM/TPM ho\u1eb7c keystore \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a (PKCS#8 + AEAD), ch\u1ec9 d\u00f9ng \u0111\u1ec3 unwrap; h\u1ea1n ch\u1ebf truy c\u1eadp v\u00e0 audit m\u1ecdi thao t\u00e1c unwrap.</li> </ul> </li> <li>\u0110\u1ecbnh d\u1ea1ng v\u00ed d\u1ee5 (JSON/struct trong header \u2014 nh\u1ecf g\u1ecdn):<ul> <li>version: \"1\"</li> <li>kms_provider: \"local-hsm\" | \"kms-service\"</li> <li>key_id: \"rsa-3072-v1\"</li> <li>wrapped_key: base64(...)</li> <li>iv: base64(...)</li> <li>cipher: \"AES-GCM-256\"</li> <li>tag: base64(...)</li> <li>signature: base64(...) // optional: PSS(SHA-256) k\u00fd header \u0111\u1ec3 ph\u00e1t hi\u1ec7n thay \u0111\u1ed5i metadata</li> </ul> </li> <li>Key management / lifecycle:<ul> <li>RSA d\u00f9ng ch\u1ec9 \u0111\u1ec3 wrap/unwarp keys. X\u00e1c \u0111\u1ecbnh key IDs v\u00e0 versioning \u0111\u1ec3 h\u1ed7 tr\u1ee3 key rotation.</li> <li>Khi rotate: re-wrap AES keys v\u1edbi public key m\u1edbi, c\u1eadp nh\u1eadt key_id/version trong metadata; gi\u1eef history \u0111\u1ec3 m\u1edf c\u00e1c file c\u0169 n\u1ebfu c\u1ea7n.</li> <li>\u0110\u1ea3m b\u1ea3o backup c\u1ee7a private key trong HSM ho\u1eb7c qua secure export v\u1edbi policies.</li> </ul> </li> <li>Recovery &amp; Access Control:<ul> <li>C\u01a1 ch\u1ebf recovery key/escrow (v\u00ed d\u1ee5: m\u1ed9t key recovery RSA \u0111\u01b0\u1ee3c c\u1ea5t \u1edf ch\u1ed7 kh\u00e1c) \u2014 c\u0169ng ph\u1ea3i b\u1ea3o v\u1ec7 t\u01b0\u01a1ng t\u1ef1.</li> <li>Ph\u00e2n quy\u1ec1n unwrap: ch\u1ec9 c\u00e1c d\u1ecbch v\u1ee5/role \u0111\u01b0\u1ee3c ph\u00e9p truy c\u1eadp private key; m\u1ecdi request unwrap ghi log/audit.</li> </ul> </li> <li>Performance &amp; scale:<ul> <li>RSA ch\u1ec9 d\u00f9ng cho small payload (wrapped_key); h\u1ea1n ch\u1ebf s\u1ed1 ph\u00e9p unwrap \u0111\u1ed3ng th\u1eddi (HSM throughput).</li> <li>C\u00e2n nh\u1eafc d\u00f9ng KEMs/ECC (X25519/Kyber) cho hi\u1ec7u n\u0103ng/chi ph\u00ed khi c\u1ea7n scale l\u1edbn.</li> </ul> </li> <li>Security recommendations (nh\u1eafc l\u1ea1i li\u00ean quan FileVault):<ul> <li>RSA-OAEP (SHA-256) cho wrap; RSA-PSS (SHA-256) cho signature.</li> <li>Key size &gt;= 3072 cho private keys l\u00e2u d\u00e0i; d\u00f9ng HSM/TPM cho private keys.</li> <li>Kh\u00f4ng leak l\u1ed7i unwrap (tr\u00e1nh padding oracle); x\u1eed l\u00fd l\u1ed7i chung chung cho client.</li> <li>Ki\u1ec3m th\u1eed v\u1edbi Wycheproof/OpenSSL vectors v\u00e0 ki\u1ec3m tra side-channel tr\u00ean HSM.</li> </ul> </li> <li>Operational notes:<ul> <li>\u0110\u1ecbnh ngh\u0129a v\u00e0 duy tr\u00ec file format spec/versioned, c\u00f3 test vectors cho m\u1ed7i version.</li> <li>Gi\u1eef t\u01b0 li\u1ec7u ph\u1ee5c h\u1ed3i (recovery procedure) v\u00e0 k\u1ebf ho\u1ea1ch chuy\u1ec3n \u0111\u1ed5i PQC khi c\u1ea7n.</li> </ul> </li> </ul>"},{"location":"algorithms/asymmetric/rsa/#1-kh\u00e1i-ni\u1ec7m","title":"1. Kh\u00e1i ni\u1ec7m","text":"<p>RSA l\u00e0 thu\u1eadt to\u00e1n m\u00e3 h\u00f3a kh\u00f3a c\u00f4ng khai (asymmetric) d\u00f9ng \u0111\u1ec3 b\u1ea3o m\u1eadt t\u00ednh b\u1ea3o m\u1eadt (confidentiality) c\u1ee7a d\u1eef li\u1ec7u nh\u1ecf (v\u00ed d\u1ee5: kh\u00f3a phi\u00ean) v\u00e0 \u0111\u1ec3 x\u00e1c th\u1ef1c/\u0111\u1ea3m b\u1ea3o t\u00ednh to\u00e0n v\u1eb9n (digital signatures). N\u00f3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 trao \u0111\u1ed5i kh\u00f3a v\u00e0 ch\u1ee9ng th\u1ef1c gi\u1eefa c\u00e1c b\u00ean kh\u00f4ng tin c\u1eady b\u1eb1ng c\u1eb7p kh\u00f3a c\u00f4ng khai/ri\u00eang t\u01b0, b\u1ea3o v\u1ec7 d\u1eef li\u1ec7u kh\u1ecfi gi\u1ea3i m\u00e3 b\u1edfi k\u1ebb kh\u00f4ng c\u00f3 kh\u00f3a ri\u00eang.</p>"},{"location":"algorithms/asymmetric/rsa/#2-to\u00e1n-h\u1ecdc--padding","title":"2. To\u00e1n h\u1ecdc &amp; Padding","text":"<ul> <li>C\u01a1 s\u1edf to\u00e1n h\u1ecdc: d\u1ef1a tr\u00ean \u0111\u1ed9 kh\u00f3 c\u1ee7a b\u00e0i to\u00e1n ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1.<ul> <li>Ch\u1ecdn 2 s\u1ed1 nguy\u00ean t\u1ed1 l\u1edbn \\(p, q\\).</li> <li>\\(n = p \\cdot q\\).</li> <li>\\(\\phi(n) = (p-1)(q-1)\\).</li> <li>Ch\u1ecdn \\(e\\) sao cho \\(1 &lt; e &lt; \\phi(n)\\) v\u00e0 \\(\\gcd(e,\\phi(n)) = 1\\) (th\u01b0\u1eddng \\(e=65537\\)).</li> <li>T\u00ednh \\(d \\equiv e^{-1} \\pmod{\\phi(n)}\\).</li> <li>Public key: \\((n,e)\\); Private key: \\((n,d)\\).</li> </ul> </li> <li>C\u00f4ng th\u1ee9c m\u00e3 h\u00f3a / gi\u1ea3i m\u00e3:<ul> <li>M\u00e3 h\u00f3a: \\(C \\equiv M^{e} \\pmod n\\).</li> <li>Gi\u1ea3i m\u00e3: \\(M \\equiv C^{d} \\pmod n\\).</li> </ul> </li> <li>Padding (b\u1eaft bu\u1ed9c trong th\u1ef1c t\u1ebf):<ul> <li>OAEP (Optimal Asymmetric Encryption Padding) v\u1edbi MGF1 v\u00e0 h\u00e0m b\u0103m (v\u00ed d\u1ee5 SHA-256): th\u00eam ng\u1eabu nhi\u00ean v\u00e0 c\u1ea5u tr\u00fac \u0111\u1ec3 ch\u1ed1ng t\u1ea5n c\u00f4ng d\u1ef1a v\u00e0o t\u00ednh x\u00e1c \u0111\u1ecbnh v\u00e0 chosen-ciphertext.</li> <li>Signature padding: PSS (Probabilistic Signature Scheme) khuy\u1ebfn ngh\u1ecb cho ch\u1eef k\u00fd RSA.</li> <li>Ghi ch\u00fa: Textbook RSA (kh\u00f4ng padding) v\u00e0 PKCS#1 v1.5 cho m\u00e3 h\u00f3a l\u00e0 kh\u00f4ng an to\u00e0n.</li> </ul> </li> </ul>"},{"location":"algorithms/asymmetric/rsa/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ol> <li>Sinh c\u1eb7p kh\u00f3a (p, q -&gt; n, e, d).</li> <li>B\u00ean g\u1eedi l\u1ea5y public key $(n,e)`.</li> <li>\u0110\u1ec3 g\u1eedi d\u1eef li\u1ec7u l\u1edbn: t\u1ea1o AES key ng\u1eabu nhi\u00ean, m\u00e3 h\u00f3a d\u1eef li\u1ec7u b\u1eb1ng AES-GCM, m\u00e3 h\u00f3a AES key b\u1eb1ng RSA-OAEP v\u1edbi public key.</li> <li>B\u00ean nh\u1eadn d\u00f9ng private key gi\u1ea3i m\u00e3 AES key r\u1ed3i gi\u1ea3i m\u00e3 file.</li> </ol>"},{"location":"algorithms/asymmetric/rsa/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key sizes: 2048, 3072, 4096 bits.</li> <li>PublicExponent: th\u01b0\u1eddng 65537.</li> <li>Private key th\u01b0\u1eddng l\u01b0u theo PKCS#1 ho\u1eb7c PKCS#8 (PEM/DER).</li> <li>Ciphertext RSA: m\u1ed9t s\u1ed1 nguy\u00ean modulo \\(n\\) c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng key size; khi d\u00f9ng OAEP, ciphertext chi\u1ec1u d\u00e0i = chi\u1ec1u d\u00e0i modulus (bytes).</li> <li>\u0110\u1ecbnh d\u1ea1ng k\u1ebft h\u1ee3p (hybrid): {RSA-encrypted-key || AES-GCM(iv, ciphertext, tag)}.</li> </ul>"},{"location":"algorithms/asymmetric/rsa/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>ECC (Elliptic-Curve Cryptography)<ul> <li>L\u1ee3i th\u1ebf: k\u00edch th\u01b0\u1edbc kh\u00f3a nh\u1ecf h\u01a1n, c\u00f9ng m\u1ee9c an to\u00e0n, nhanh h\u01a1n cho c\u00e1c thao t\u00e1c kh\u00f3a.</li> <li>H\u1ea1n ch\u1ebf: ph\u1ee9c t\u1ea1p to\u00e1n h\u1ecdc h\u01a1n, t\u01b0\u01a1ng th\u00edch kh\u00e1c nhau.</li> </ul> </li> <li>ElGamal<ul> <li>H\u1ea5p d\u1eabn cho m\u1ed9t s\u1ed1 k\u1ecbch b\u1ea3n nh\u01b0ng ciphertext l\u1edbn h\u01a1n v\u00e0 nh\u1ea1y v\u1edbi l\u1ed7 h\u1ed5ng padding n\u1ebfu kh\u00f4ng c\u1ea9n th\u1eadn.</li> </ul> </li> <li>Post-Quantum (Kyber, NewHope)<ul> <li>Kh\u00e1ng l\u01b0\u1ee3ng t\u1eed; t\u01b0\u01a1ng lai y\u00eau c\u1ea7u chuy\u1ec3n \u0111\u1ed5i khi n\u0103ng l\u1ef1c l\u01b0\u1ee3ng t\u1eed \u0111\u1ee7 m\u1ea1nh.</li> </ul> </li> <li>Khi d\u00f9ng cho m\u00e3 h\u00f3a kh\u00f3a phi\u00ean: RSA h\u1ee3p l\u00fd nh\u01b0ng ECC/KEMs (e.g., X25519, Kyber) th\u01b0\u1eddng \u01b0u vi\u1ec7t v\u1ec1 hi\u1ec7u n\u0103ng/k\u00edch th\u01b0\u1edbc.</li> </ul>"},{"location":"algorithms/asymmetric/rsa/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>sequenceDiagram\n        participant Sender\n        participant Receiver\n        participant RSA_Service\n\n        Sender-&gt;&gt;RSA_Service: Sinh AES key (32 bytes)\n        RSA_Service-&gt;&gt;Sender: AES key\n        Sender-&gt;&gt;Sender: M\u00e3 h\u00f3a file v\u1edbi AES-GCM (key, iv) -&gt; CT_file + tag\n        Sender-&gt;&gt;Receiver: M\u00e3 h\u00f3a AES key b\u1eb1ng RSA-OAEP(public_receiver) -&gt; CT_key\n        Sender-&gt;&gt;Receiver: G\u1eedi {CT_key, iv, CT_file, tag}\n        Receiver-&gt;&gt;Receiver: Gi\u1ea3i RSA-OAEP(private_receiver, CT_key) -&gt; AES key\n        Receiver-&gt;&gt;Receiver: Gi\u1ea3i AES-GCM(iv, CT_file, tag) -&gt; file</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/asymmetric/rsa/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng PKCS#1 v1.5 cho m\u00e3 h\u00f3a (Bleichenbacher oracle).</li> <li>T\u1ef1 tri\u1ec3n khai padding ho\u1eb7c RNG k\u00e9m ch\u1ea5t l\u01b0\u1ee3ng.</li> <li>Key size qu\u00e1 nh\u1ecf (RSA-1024 kh\u00f4ng an to\u00e0n).</li> <li>L\u01b0u tr\u1eef private key kh\u00f4ng an to\u00e0n (plaintext, kh\u00f4ng kho\u00e1).</li> <li>D\u00f9ng RSA \u0111\u1ec3 m\u00e3 h\u00f3a d\u1eef li\u1ec7u l\u1edbn thay v\u00ec ch\u1ec9 m\u00e3 h\u00f3a key.</li> <li>Kh\u00f4ng ki\u1ec3m tra tham s\u1ed1 (e kh\u00f4ng h\u1ee3p l\u1ec7, p=q,\u2026).</li> <li>Kh\u00f4ng d\u00f9ng constant-time cho thao t\u00e1c nh\u1ea1y c\u1ea3m d\u1eabn t\u1edbi r\u00f2 r\u1ec9.</li> </ul>"},{"location":"algorithms/asymmetric/rsa/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Attacker c\u00f3 ciphertext nh\u01b0ng kh\u00f4ng c\u00f3 private key: m\u1ee5c ti\u00eau l\u00e0 b\u1ea3o m\u1eadt s\u1ed1 li\u1ec7u (IND-CCA n\u1ebfu OAEP).</li> <li>Attacker c\u00f3 oracle gi\u1ea3i m\u00e3 (padding oracle): nguy hi\u1ec3m (Bleichenbacher).</li> <li>Side-channel: r\u00f2 r\u1ec9 qua timing, power, fault injection.</li> <li>Long-term: quantum adversary (Shor) ph\u00e1 RSA khi c\u00f3 m\u00e1y l\u01b0\u1ee3ng t\u1eed \u0111\u1ee7 m\u1ea1nh.</li> </ul>"},{"location":"algorithms/asymmetric/rsa/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n d\u00f9ng OAEP (m\u00e3 h\u00f3a) v\u00e0 PSS (ch\u1eef k\u00fd) v\u1edbi SHA-256 ho\u1eb7c m\u1ea1nh h\u01a1n.</li> <li>Key size &gt;= 2048 (3072 khuy\u1ebfn ngh\u1ecb); xem k\u1ebf ho\u1ea1ch chuy\u1ec3n \u0111\u1ed5i post-quantum.</li> <li>D\u00f9ng CSPRNG \u0111\u1ec3 sinh p,q v\u00e0 AES keys.</li> <li>B\u1ea3o v\u1ec7 private key v\u1edbi HSM / TPM ho\u1eb7c encrypted key storage (PKCS#8 + PBKDF2/argon2 + AEAD).</li> <li>Ki\u1ec3m tra \u0111\u1ea7u v\u00e0o/\u0111\u1ea7u ra, t\u1eeb ch\u1ed1i l\u1ed7i chi ti\u1ebft trong m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t (kh\u00f4ng leak padding errors).</li> <li>Th\u1ef1c hi\u1ec7n constant-time crypto v\u00e0 ch\u1ed1ng fault injection.</li> <li>S\u1eed d\u1ee5ng libs well-tested (OpenSSL, libsodium, Botan, RFC-validated implementations).</li> </ul>"},{"location":"algorithms/asymmetric/rsa/#10-test-vectors-v\u00ed-d\u1ee5-minh-h\u1ecda-nh\u1ecf","title":"10. Test Vectors (v\u00ed d\u1ee5 minh h\u1ecda nh\u1ecf)","text":"<p>L\u01b0u \u00fd: ch\u1ec9 d\u00f9ng c\u00e1c vector h\u1ecdc thu\u1eadt/ki\u1ec3m th\u1eed nh\u1ecf; kh\u00f4ng d\u00f9ng cho m\u00f4i tr\u01b0\u1eddng production. - V\u00ed d\u1ee5 s\u1ed1 nh\u1ecf:     - p = 61, q = 53 -&gt; n = 3233, phi = 3120     - e = 17 -&gt; d = 2753     - M = 65 -&gt; C = 65^17 mod 3233 = 2790     - Gi\u1ea3i m\u00e3: 2790^2753 mod 3233 = 65 - V\u1edbi OAEP/real-world d\u00f9ng c\u00e1c test vector RFC/Library (OpenSSL test suite, Wycheproof) \u0111\u1ec3 ki\u1ec3m th\u1eed.</p>"},{"location":"algorithms/asymmetric/rsa/#11-v\u00ed-d\u1ee5-code-ng\u1eafn-python--c\u00f3-th\u1ec3-b\u1ecf-qua","title":"11. V\u00ed d\u1ee5 Code (ng\u1eafn, Python) \u2014 c\u00f3 th\u1ec3 b\u1ecf qua","text":"Python<pre><code>from cryptography.hazmat.primitives.asymmetric import rsa, padding\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\n\n# Sinh key\npriv = rsa.generate_private_key(public_exponent=65537, key_size=3072)\npub = priv.public_key()\n\n# M\u00e3 h\u00f3a OAEP\ndef rsa_encrypt(pub, msg: bytes) -&gt; bytes:\n        return pub.encrypt(\n                msg,\n                padding.OAEP(mgf=padding.MGF1(hashes.SHA256()), algorithm=hashes.SHA256(), label=None)\n        )\n\n# Gi\u1ea3i m\u00e3 OAEP\ndef rsa_decrypt(priv, ct: bytes) -&gt; bytes:\n        return priv.decrypt(\n                ct,\n                padding.OAEP(mgf=padding.MGF1(hashes.SHA256()), algorithm=hashes.SHA256(), label=None)\n        )\n</code></pre>"},{"location":"algorithms/asymmetric/rsa/#12-checklist-b\u1ea3o-m\u1eadt-t\u00f3m-t\u1eaft","title":"12. Checklist b\u1ea3o m\u1eadt (t\u00f3m t\u1eaft)","text":"<ul> <li> Key size &gt;= 2048 bits (khuy\u1ebfn ngh\u1ecb 3072).</li> <li> Public exponent = 65537 (ho\u1eb7c ki\u1ec3m so\u00e1t t\u1ed1t other choices).</li> <li> Lu\u00f4n d\u00f9ng OAEP (SHA-256) cho m\u00e3 h\u00f3a; PSS cho ch\u1eef k\u00fd.</li> <li> Kh\u00f4ng d\u00f9ng RSA \u0111\u1ec3 m\u00e3 h\u00f3a d\u1eef li\u1ec7u l\u1edbn tr\u1ef1c ti\u1ebfp.</li> <li> Sinh kh\u00f3a &amp; nonce b\u1eb1ng CSPRNG.</li> <li> Private key b\u1ea3o v\u1ec7 b\u1eb1ng HSM/TPM ho\u1eb7c AES-encrypted storage.</li> <li> Kh\u00f4ng leak l\u1ed7i padding/chi ti\u1ebft gi\u1ea3i m\u00e3; x\u1eed l\u00fd l\u1ed7i chung chung.</li> <li> Ki\u1ec3m th\u1eed v\u1edbi test vectors (Wycheproof, OpenSSL tests).</li> <li> C\u00f3 k\u1ebf ho\u1ea1ch chuy\u1ec3n \u0111\u1ed5i sang PQC khi c\u1ea7n.</li> </ul>"},{"location":"algorithms/asymmetric/rsa/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 8017 PKCS#1 v2.2 (RSA Cryptography Specifications) \u2014 padding, PSS, OAEP.</li> <li>NIST SP 800-89, NIST recommendations (key sizes).</li> <li>Project Wycheproof (Google) \u2014 test vectors cho padding/oracles.</li> <li>Biblioteca: OpenSSL, Botan, cryptography.io docs.</li> </ul>"},{"location":"algorithms/classical/caesar/","title":"Caesar Cipher","text":""},{"location":"algorithms/classical/caesar/#caesar-cipher","title":"Caesar Cipher","text":""},{"location":"algorithms/classical/caesar/#0-filevault-context","title":"0. Filevault context","text":"<p>M\u1ee5c ti\u00eau: t\u00e0i li\u1ec7u k\u1ef9 thu\u1eadt cho l\u1edbp h\u1ecdc, ph\u00e2n t\u00edch b\u1ea3o m\u1eadt c\u01a1 b\u1ea3n, d\u00f9ng UserMode::STUDENT.</p>"},{"location":"algorithms/classical/caesar/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Caesar Cipher l\u00e0 m\u1ed9t m\u1eadt m\u00e3 thay th\u1ebf \u0111\u01a1n gi\u1ea3n: d\u1ecbch m\u1ed7i k\u00fd t\u1ef1 trong b\u1ea3ng ch\u1eef c\u00e1i b\u1edfi m\u1ed9t s\u1ed1 v\u1ecb tr\u00ed c\u1ed1 \u0111\u1ecbnh k. Gi\u1ea3i quy\u1ebft: che gi\u1ea5u n\u1ed9i dung v\u0103n b\u1ea3n thu\u1ea7n (confidentiality c\u01a1 b\u1ea3n). Kh\u00f4ng b\u1ea3o v\u1ec7 t\u00ednh to\u00e0n v\u1eb9n, x\u00e1c th\u1ef1c hay ch\u1ed1ng ph\u00e2n t\u00edch.</p>"},{"location":"algorithms/classical/caesar/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>K\u00fd hi\u1ec7u: P (plaintext), C (ciphertext), k \u2208 {0..25}.</li> <li>Key: M\u1ed9t s\u1ed1 nguy\u00ean \\(k\\) (Shift amount), th\u01b0\u1eddng t\u1eeb 1-25.</li> <li>Encryption: \\(C = (P + k) \\pmod{26}\\).</li> <li>Decryption: \\(P = (C - k) \\pmod{26}\\).</li> </ul> <p>L\u01afU \u00dd: Thu\u1eadt to\u00e1n n\u00e0y KH\u00d4NG AN TO\u00c0N. Ch\u1ec9 d\u00f9ng cho m\u1ee5c \u0111\u00edch gi\u00e1o d\u1ee5c (<code>UserMode::STUDENT</code>).</p> <p>Ph\u00e1 m\u00e3 *   Brute-force: Ch\u1ec9 c\u00f3 25 kh\u00f3a kh\u1ea3 thi -&gt; Th\u1eed h\u1ebft trong t\u00edch t\u1eafc. *   Frequency Analysis: Ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t xu\u1ea5t hi\u1ec7n c\u1ee7a c\u00e1c ch\u1eef c\u00e1i.</p> <p>(\u00c1p d\u1ee5ng cho ch\u1ec9 ch\u1eef c\u00e1i A\u2013Z ho\u1eb7c a\u2013z; x\u1eed l\u00fd k\u00fd t\u1ef1 kh\u00e1c tu\u1ef3 c\u00e0i \u0111\u1eb7t.)</p>"},{"location":"algorithms/classical/caesar/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>Ch\u1ecdn kh\u00f3a k (shift).</li> <li>V\u1edbi m\u1ed7i k\u00fd t\u1ef1 ch\u1eef c\u00e1i, d\u1ecbch n\u00f3 k v\u1ecb tr\u00ed theo v\u00f2ng tu\u1ea7n ho\u00e0n 26 k\u00fd t\u1ef1.</li> <li>Gi\u1eef nguy\u00ean k\u00fd t\u1ef1 kh\u00f4ng ph\u1ea3i ch\u1eef c\u00e1i ho\u1eb7c x\u1eed l\u00fd theo quy t\u1eafc.</li> </ul>"},{"location":"algorithms/classical/caesar/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Input: chu\u1ed7i (string).</li> <li>Key: integer.</li> <li>Th\u1ef1c hi\u1ec7n b\u1eb1ng m\u1ea3ng k\u00fd t\u1ef1 ho\u1eb7c m\u00e3 Unicode/codepoint (ASCII).</li> <li>T\u00f9y ch\u1ecdn: b\u1ea3ng tra c\u1ee9u (lookup table) 26 ph\u1ea7n t\u1eed cho t\u0103ng t\u1ed1c.</li> </ul>"},{"location":"algorithms/classical/caesar/#5-so-s\u00e1nh-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>Vigen\u00e8re: d\u00f9ng kh\u00f3a chu\u1ed7i, ch\u1ed1ng ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t t\u1ed1t h\u01a1n.</li> <li>One-time pad: ho\u00e0n h\u1ea3o n\u1ebfu kh\u00f3a ng\u1eabu nhi\u00ean, b\u1eb1ng chi\u1ec1u d\u00e0i b\u1ea3n r\u00f5.</li> <li>Substitution cipher to\u00e0n c\u1ee5c: thay th\u1ebf m\u1ed7i k\u00fd t\u1ef1 b\u1eb1ng m\u1ed9t \u00e1nh x\u1ea1 c\u1ed1 \u0111\u1ecbnh (Caesar l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb \u0111\u01a1n gi\u1ea3n).</li> <li>So s\u00e1nh: Caesar r\u1ea5t y\u1ebfu, d\u1ec5 brute-force v\u00e0 ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t.</li> </ul>"},{"location":"algorithms/classical/caesar/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng","text":"<p>Mermaid: </p> <pre><code>flowchart TD\n    A[Start] --&gt; B[Read plaintext, key k]\n    B --&gt; C{For each char}\n    C --&gt;|Non-letter| D[Append unchanged]\n    C --&gt;|Letter| E[Map to 0..25, add k mod 26]\n    E --&gt; F[Convert back to letter, append]\n    D --&gt; G[Next char]\n    F --&gt; G\n    G --&gt; H[Output ciphertext]\n    H --&gt; I[End]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/classical/caesar/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>\u00c1p d\u1ee5ng shift cho to\u00e0n b\u1ed9 Unicode (l\u00e0m h\u1ecfng k\u00fd t\u1ef1 \u0111a byte).</li> <li>Kh\u00f4ng chu\u1ea9n ho\u00e1 ch\u1eef hoa/ch\u1eef th\u01b0\u1eddng d\u1eabn \u0111\u1ebfn h\u00e0nh vi kh\u00f4ng nh\u1ea5t qu\u00e1n.</li> <li>D\u00f9ng k c\u1ed1 \u0111\u1ecbnh c\u00f4ng khai (kh\u00f4ng ph\u1ea3i b\u00ed m\u1eadt).</li> <li>B\u1ecf qua x\u1eed l\u00fd k\u00fd t\u1ef1 kh\u00f4ng alphabet (nh\u01b0ng v\u1eabn \u0111\u1ed5i ch\u00fang).</li> <li>Kh\u00f4ng gi\u1edbi h\u1ea1n key space (cho ph\u00e9p k ngo\u00e0i 0..25).</li> </ul>"},{"location":"algorithms/classical/caesar/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>T\u1ea5n c\u00f4ng: k\u1ebb t\u1ea5n c\u00f4ng c\u00f3 ciphertext; m\u1ee5c ti\u00eau l\u00e0 thu plaintext ho\u1eb7c key.</li> <li>Kh\u1ea3 n\u0103ng k\u1ebb t\u1ea5n c\u00f4ng: passive eavesdropper, c\u00f3 ki\u1ebfn th\u1ee9c th\u1ed1ng k\u00ea ng\u00f4n ng\u1eef.</li> <li>Kh\u00f4ng ch\u1ed1ng l\u1ea1i: chosen-plaintext, chosen-ciphertext, attacker with frequency analysis or brute force.</li> </ul>"},{"location":"algorithms/classical/caesar/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Kh\u00f4ng d\u00f9ng Caesar cho b\u1ea3o m\u1eadt th\u1ef1c t\u1ebf.</li> <li>D\u00f9ng c\u00e1c chu\u1ea9n hi\u1ec7n \u0111\u1ea1i: AES-GCM, ChaCha20-Poly1305.</li> <li>N\u1ebfu h\u1ecdc thu\u1eadt: k\u1ebft h\u1ee3p Vigen\u00e8re ho\u1eb7c OTP cho m\u1ee5c \u0111\u00edch so s\u00e1nh.</li> <li>Th\u00eam MAC ho\u1eb7c AEAD \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o t\u00ednh to\u00e0n v\u1eb9n v\u00e0 x\u00e1c th\u1ef1c.</li> </ul>"},{"location":"algorithms/classical/caesar/#10-test-vectors","title":"10. Test Vectors","text":"Plaintext Key Ciphertext HELLO 3 KHOOR abc 1 bcd XYZ 2 ZAB attack at dawn 5 fyyfhp fy ifbs (n\u1ebfu gi\u1eef kho\u1ea3ng tr\u1eafng)"},{"location":"algorithms/classical/caesar/#11-code-python-minh-ho\u1ea1","title":"11. Code (Python, minh ho\u1ea1)","text":"Python<pre><code>def caesar_encrypt(s: str, k: int) -&gt; str:\n        k = k % 26\n        out = []\n        for ch in s:\n                if 'A' &lt;= ch &lt;= 'Z':\n                        out.append(chr((ord(ch) - 65 + k) % 26 + 65))\n                elif 'a' &lt;= ch &lt;= 'z':\n                        out.append(chr((ord(ch) - 97 + k) % 26 + 97))\n                else:\n                        out.append(ch)\n        return ''.join(out)\n\ndef caesar_decrypt(c: str, k: int) -&gt; str:\n        return caesar_encrypt(c, -k)\n</code></pre>"},{"location":"algorithms/classical/caesar/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Kh\u00f4ng d\u00f9ng Caesar cho d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m.</li> <li> Key ph\u1ea3i gi\u1eef b\u00ed m\u1eadt v\u00e0 c\u00f3 ch\u00ednh s\u00e1ch qu\u1ea3n l\u00fd kh\u00f3a.</li> <li> S\u1eed d\u1ee5ng chu\u1ea9n m\u00e3 ho\u00e1 hi\u1ec7n \u0111\u1ea1i (AEAD) thay th\u1ebf.</li> <li> Ki\u1ec3m tra x\u1eed l\u00fd encoding/Unicode.</li> <li> C\u00f3 test vectors v\u00e0 unit tests.</li> <li> \u0110\u00e1nh gi\u00e1 threat model tr\u01b0\u1edbc khi d\u00f9ng cho m\u1ee5c \u0111\u00edch gi\u00e1o d\u1ee5c.</li> </ul>"},{"location":"algorithms/classical/caesar/#13-ngu\u1ed3n-tham-kh\u1ea3o","title":"13. Ngu\u1ed3n tham kh\u1ea3o:","text":"<ul> <li>Gi\u1edbi thi\u1ec7u m\u1eadt m\u00e3 c\u1ed5 \u0111i\u1ec3n (s\u00e1ch gi\u00e1o khoa, b\u00e0i gi\u1ea3ng).</li> <li>RFCs v\u00e0 t\u00e0i li\u1ec7u v\u1ec1 AES/GCM, ChaCha20-Poly1305 \u0111\u1ec3 ch\u1ecdn thay th\u1ebf hi\u1ec7n \u0111\u1ea1i.</li> </ul>"},{"location":"algorithms/classical/hill/","title":"Hill Cipher","text":""},{"location":"algorithms/classical/hill/#hill-cipher","title":"Hill Cipher","text":""},{"location":"algorithms/classical/hill/#0-filevault-context","title":"0. Filevault context","text":"<p>M\u1ee5c \u0111\u00edch: m\u00f4 t\u1ea3 chi ti\u1ebft thu\u1eadt to\u00e1n Hill Cipher, to\u00e1n h\u1ecdc, c\u00e1ch tri\u1ec3n khai, r\u1ee7i ro b\u1ea3o m\u1eadt v\u00e0 test vectors.</p>"},{"location":"algorithms/classical/hill/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n","text":"<p>Hill Cipher l\u00e0 m\u1eadt m\u00e3 thay th\u1ebf \u0111a-k\u00fd t\u1ef1 d\u1ef1a tr\u00ean \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh. N\u00f3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n b\u1ea3o m\u1eadt t\u00ednh b\u00ed m\u1eadt c\u1ee7a v\u0103n b\u1ea3n ch\u1eef c\u00e1i b\u1eb1ng c\u00e1ch m\u00e3 h\u00f3a t\u1eebng kh\u1ed1i k\u00fd t\u1ef1 th\u00e0nh vector v\u00e0 nh\u00e2n v\u1edbi ma tr\u1eadn kh\u00f3a. B\u1ea3o v\u1ec7: t\u00ednh k\u00edn c\u1ee7a n\u1ed9i dung (confidentiality) tr\u01b0\u1edbc k\u1ebb nghe l\u00e9n kh\u00f4ng c\u00f3 plaintext tham chi\u1ebfu. Kh\u00f4ng b\u1ea3o v\u1ec7 t\u00ednh to\u00e0n v\u1eb9n hay x\u00e1c th\u1ef1c. T\u00f3m l\u1ea1i, l\u00e0 m\u1eadt m\u00e3 thay th\u1ebf \u0111a k\u00fd t\u1ef1 d\u1ef1a tr\u00ean \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh. N\u00f3 s\u1eed d\u1ee5ng ph\u00e9p nh\u00e2n ma tr\u1eadn modulo 26.</p> <p>L\u01afU \u00dd: Thu\u1eadt to\u00e1n n\u00e0y KH\u00d4NG AN TO\u00c0N (d\u1ec5 b\u1ecb Known-plaintext attack).</p>"},{"location":"algorithms/classical/hill/#2-thu\u1eadt-to\u00e1n","title":"2. Thu\u1eadt to\u00e1n","text":""},{"location":"algorithms/classical/hill/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-steps","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (steps)","text":"<ol> <li>Chu\u1ea9n h\u00f3a plaintext (k\u00fd t\u1ef1 hoa, b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng thu\u1ed9c b\u1ea3ng).  </li> <li>Map ch\u1eef \u2192 s\u1ed1 0..25.  </li> <li>Chia th\u00e0nh kh\u1ed1i \u0111\u1ed9 d\u00e0i n; pad (v\u00ed d\u1ee5 'X' = 23) n\u1ebfu c\u1ea7n.  </li> <li>V\u1edbi m\u1ed7i vector P: C = (K \u00b7 P) mod 26.  </li> <li>Map s\u1ed1 \u2192 ch\u1eef \u0111\u1ec3 t\u1ea1o ciphertext.  </li> <li>Gi\u1ea3i m\u00e3 t\u01b0\u01a1ng t\u1ef1 v\u1edbi K^{-1}.</li> </ol>"},{"location":"algorithms/classical/hill/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: ma tr\u1eadn vu\u00f4ng k\u00edch th\u01b0\u1edbc n\u00d7n (m\u1ea3ng s\u1ed1 nguy\u00ean modulo 26).  </li> <li>Block/Vector: m\u1ea3ng chi\u1ec1u n c\u1ee7a s\u1ed1 nguy\u00ean 0..25.  </li> <li>Mapping b\u1ea3ng k\u00fd t\u1ef1 (A\u2013Z \u2192 0\u201325).  </li> <li>Padding token v\u00e0 ch\u00ednh s\u00e1ch padding.</li> </ul>"},{"location":"algorithms/classical/hill/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi Caesar/Vigen\u00e8re: m\u00e3 h\u00f3a theo kh\u1ed1i, h\u1ee7y c\u1ea5u tr\u00fac n-gram, m\u1ea1nh h\u01a1n v\u1edbi k\u00edch th\u01b0\u1edbc kh\u1ed1i &gt;1.  </li> <li>So v\u1edbi m\u00e3 hi\u1ec7n \u0111\u1ea1i (AES): Hill l\u00e0 tuy\u1ebfn t\u00ednh v\u00e0 d\u1ec5 b\u1ecb t\u1ea5n c\u00f4ng tuy\u1ebfn t\u00ednh/bi\u1ebft-plaintext; kh\u00f4ng \u0111\u1ea1t \u0111\u1ed9 an to\u00e0n c\u1ee7a AES.  </li> <li>So v\u1edbi OTP: kh\u00f4ng \u0111\u1ea1t t\u00ednh b\u1ea5t kh\u1ea3 gi\u1ea3i (perfect secrecy) v\u00ec ph\u1ee5 thu\u1ed9c key c\u1ed1 \u0111\u1ecbnh.</li> </ul>"},{"location":"algorithms/classical/hill/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (Mermaid)","text":"<pre><code>flowchart TD\n    A[\"Plaintext\"] --&gt; B[\"Chu\u1ea9n h\u00f3a &amp; map -&gt; s\u1ed1\"]\n    B[\"Chu\u1ea9n h\u00f3a &amp; map =&gt; s\u1ed1\"] --&gt; C[\"Chia kh\u1ed1i n\"]\n    C[\"Chia kh\u1ed1i n\"] --&gt; D[\"Pad n\u1ebfu c\u1ea7n\"]\n    D[\"Pad n\u1ebfu c\u1ea7n\"] --&gt; E[\"Encrypt: C = K * P mod 26\"]\n    E[\"Encrypt: C = K * P mod 26\"] --&gt; F[\"Map s\u1ed1 -&gt; ch\u1eef =&gt; Ciphertext\"]\n    F[\"Map s\u1ed1 -&gt; ch\u1eef =&gt; Ciphertext\"] --&gt; G[\"Truy\u1ec1n / L\u01b0u tr\u1eef\"]\n    G[\"Truy\u1ec1n / L\u01b0u tr\u1eef\"] --&gt; H[\"Decrypt: P = K^{-1} * C mod 26\"]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/classical/hill/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng ma tr\u1eadn kh\u00f4ng kh\u1ea3 ngh\u1ecbch (det kh\u00f4ng ngh\u1ecbch v\u1edbi 26).  </li> <li>Ki\u1ec3m tra ngh\u1ecbch \u0111\u1ea3o b\u1eb1ng ph\u00e9p chia th\u1ef1c/float thay v\u00ec inverse modulo.  </li> <li>Kh\u00f4ng x\u1eed l\u00fd padding/\u0111\u1ed9 d\u00e0i cu\u1ed1i kh\u1ed1i.  </li> <li>D\u00f9ng ph\u00e9p nh\u00e2n ma tr\u1eadn v\u1edbi ki\u1ec3u s\u1ed1 th\u1ef1c d\u1eabn t\u1edbi l\u1ed7i.  </li> <li>T\u00e1i s\u1eed d\u1ee5ng c\u00f9ng key l\u00e2u d\u00e0i, kh\u00f4ng xoay key.  </li> <li>B\u1ecf qua k\u00fd t\u1ef1 kh\u00f4ng thu\u1ed9c b\u1ea3ng ho\u1eb7c bi\u1ebfn \u0111\u1ed5i kh\u00e1c kh\u00f4ng th\u1ed1ng nh\u1ea5t gi\u1eefa m\u00e3/gi\u1ea3i m\u00e3.</li> </ul>"},{"location":"algorithms/classical/hill/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng ciphertext-only: c\u00f3 th\u1ec3 thu th\u1eadp t\u1ea7n su\u1ea5t, \u0111\u1eb7c bi\u1ec7t v\u1edbi block nh\u1ecf.  </li> <li>Known-plaintext / chosen-plaintext: c\u00f3 th\u1ec3 gi\u1ea3i h\u1ec7 tuy\u1ebfn t\u00ednh \u0111\u1ec3 thu l\u1ea1i K (c\u1ea7n n kh\u1ed1i \u0111\u1ed9c l\u1eadp).  </li> <li>Side-channels: tri\u1ec3n khai r\u00f2 r\u1ec9 th\u00f4ng tin (th\u1eddi gian, cache).  </li> <li>Key compromise: m\u1ea5t to\u00e0n b\u1ed9 kh\u1ea3 n\u0103ng b\u1ea3o m\u1eadt nhi\u1ec1u kh\u1ed1i.</li> </ul>"},{"location":"algorithms/classical/hill/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Ki\u1ec3m tra v\u00e0 bu\u1ed9c det(K) coprime v\u1edbi 26; t\u1eeb ch\u1ed1i ma tr\u1eadn kh\u00f4ng h\u1ee3p l\u1ec7.  </li> <li>S\u1eed d\u1ee5ng k\u00edch th\u01b0\u1edbc block l\u1edbn h\u01a1n (n t\u0103ng l\u00e0m t\u1ea5n c\u00f4ng kh\u00f3 h\u01a1n nh\u01b0ng t\u0103ng chi ph\u00ed).  </li> <li>Xoay key th\u01b0\u1eddng xuy\u00ean, kh\u00f4ng d\u00f9ng key t\u0129nh cho nhi\u1ec1u tin nh\u1eafn.  </li> <li>K\u1ebft h\u1ee3p v\u1edbi non-linear b\u01b0\u1edbc (v\u00ed d\u1ee5 affine addition v) ho\u1eb7c d\u00f9ng cipher hi\u1ec7n \u0111\u1ea1i (AES-GCM) cho \u1ee9ng d\u1ee5ng th\u1eadt s\u1ef1 c\u1ea7n b\u1ea3o m\u1eadt.  </li> <li>S\u1eed d\u1ee5ng ch\u1ebf \u0111\u1ed9 m\u00e3 h\u00f3a c\u00f3 random IV/nonce v\u00e0 x\u00e1c th\u1ef1c (AEAD).  </li> <li>Ki\u1ec3m so\u00e1t r\u00f2 r\u1ec9 th\u1eddi gian/side-channel (thao t\u00e1c c\u1ed1 \u0111\u1ecbnh th\u1eddi gian).</li> </ul>"},{"location":"algorithms/classical/hill/#10-test-vectors","title":"10. Test Vectors","text":"<p>Key v\u00ed d\u1ee5 (n=2): K = [[3,3],[2,5]] (det=9, det^{-1}=3 mod26) K^{-1} = [[15,17],[20,9]] (mod 26)</p> <ul> <li>Plain \"HI\" (H=7,I=8): P=[7,8] \u2192 C = [19,2] \u2192 \"TC\"  </li> <li>Plain \"HELP\": blocks \"HE\" [7,4] \u2192 \"HI\"; \"LP\" [11,15] \u2192 \"AT\" \u2192 Cipher \"HIAT\"  </li> <li>Gi\u1ea3i m\u00e3 \"TC\" v\u1edbi K^{-1} \u2192 \"HI\"</li> </ul> <p>Ki\u1ec3m tra: encrypt then decrypt ph\u1ea3i tr\u1ea3 v\u1ec1 ch\u00ednh x\u00e1c plaintext (sau lo\u1ea1i padding).</p>"},{"location":"algorithms/classical/hill/#11-code-v\u00ed-d\u1ee5-python-t\u1ed1i-gi\u1ea3n","title":"11. Code (v\u00ed d\u1ee5 Python t\u1ed1i gi\u1ea3n)","text":"Python<pre><code>def mod26_inv(a):\n        for x in range(26):\n                if (a*x) % 26 == 1:\n                        return x\n        raise ValueError(\"No inverse\")\n\ndef mat_mul_mod(A, v):\n        return [sum(a*b for a,b in zip(row,v)) % 26 for row in A]\n\n# K: n\u00d7n list, P: list len n\ndef encrypt_block(K, P): return mat_mul_mod(K, P)\n# To get K^{-1} compute det, adjugate, multiply by inv_det modulo 26 (implement separately)\n</code></pre> (\u0110o\u1ea1n \u0111\u1ea7y \u0111\u1ee7 c\u1ea7n h\u00e0m t\u00ednh det, adjugate modulo 26; d\u00f9ng th\u01b0 vi\u1ec7n s\u1ed1 nguy\u00ean ho\u1eb7c numpy c\u00f9ng ki\u1ec3m tra modulo.)"},{"location":"algorithms/classical/hill/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> X\u00e1c nh\u1eadn det(K) coprime v\u1edbi 26 tr\u01b0\u1edbc khi ch\u1ea5p nh\u1eadn key.  </li> <li> \u00c1p d\u1ee5ng padding deterministically v\u00e0 ki\u1ec3m tra khi gi\u1ea3i m\u00e3.  </li> <li> Kh\u00f4ng d\u00f9ng kh\u00f3a t\u0129nh cho nhi\u1ec1u phi\u00ean l\u1edbn; \u00e1p ch\u00ednh s\u00e1ch thay key.  </li> <li> Ghi log/gi\u00e1m s\u00e1t qu\u00e1 tr\u00ecnh t\u1ea1o key \u0111\u1ec3 ph\u00e1t hi\u1ec7n l\u1eb7p/kh\u00f3a y\u1ebfu.  </li> <li> S\u1eed d\u1ee5ng ch\u1ebf \u0111\u1ed9 c\u00f3 nonce/IV n\u1ebfu gh\u00e9p v\u1edbi c\u01a1 ch\u1ebf kh\u00e1c; cung c\u1ea5p t\u00ednh x\u00e1c th\u1ef1c.  </li> <li> Ki\u1ec3m th\u1eed v\u1edbi test vectors v\u00e0 fuzzing \u0111\u1ec3 ph\u00e1t hi\u1ec7n l\u1ed7i bi\u00ean gi\u1edbi.  </li> <li> Tr\u00e1nh r\u00f2 r\u1ec9 side-channel trong tri\u1ec3n khai ph\u1ea7n m\u1ec1m/nh\u00fang.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o: - https://en.wikipedia.org/wiki/Hill_cipher - B\u00e0i gi\u1ea3ng m\u1eadt m\u00e3 \u0111\u1ea1i s\u1ed1, t\u00e0i li\u1ec7u \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh (cho ph\u00e9p t\u00ednh ngh\u1ecbch \u0111\u1ea3o ma tr\u1eadn modulo).</p>"},{"location":"algorithms/classical/playfair/","title":"Playfair Cipher","text":""},{"location":"algorithms/classical/playfair/#playfair-cipher","title":"Playfair Cipher","text":""},{"location":"algorithms/classical/playfair/#0-filevault-context","title":"0. Filevault context","text":"<ul> <li>M\u1ee5c \u0111\u00edch: T\u00e0i li\u1ec7u tham kh\u1ea3o thu\u1eadt to\u00e1n Playfair trong b\u1ed9 \u201cAlgorithms / Classical\u201d c\u1ee7a Filevault \u2014 m\u00f4 t\u1ea3, ph\u00e2n t\u00edch b\u1ea3o m\u1eadt, v\u00ed d\u1ee5, test vectors, v\u00e0 checklist.</li> </ul>"},{"location":"algorithms/classical/playfair/#1-kh\u00e1i-ni\u1ec7m-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<ul> <li>Playfair l\u00e0 m\u1ed9t cipher thay th\u1ebf theo c\u1eb7p k\u00fd t\u1ef1 (digraph substitution).</li> <li>Gi\u1ea3i quy\u1ebft: gi\u1ea3m b\u1edbt ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t \u0111\u01a1n k\u00fd t\u1ef1 b\u1eb1ng c\u00e1ch m\u00e3 h\u00f3a c\u1eb7p ch\u1eef c\u00e1i.</li> <li>B\u1ea3o v\u1ec7: ch\u1ed1ng ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t \u0111\u01a1n gi\u1ea3n; kh\u00f4ng b\u1ea3o v\u1ec7 t\u1ed1t tr\u01b0\u1edbc ph\u00e2n t\u00edch th\u1ed1ng k\u00ea hi\u1ec7n \u0111\u1ea1i ho\u1eb7c hai ch\u1eef c\u00e1i t\u1ea7n su\u1ea5t.</li> </ul>"},{"location":"algorithms/classical/playfair/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/classical/playfair/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Chu\u1ea9n h\u00f3a kh\u00f3a: lo\u1ea1i tr\u00f9ng, gh\u00e9p I/J (th\u01b0\u1eddng h\u1ee3p I v\u00e0 J c\u00f9ng \u00f4).</li> <li>T\u1ea1o ma tr\u1eadn 5\u00d75 t\u1eeb kh\u00f3a r\u1ed3i \u0111i\u1ec1n ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a b\u1ea3ng ch\u1eef c\u00e1i (b\u1ecf J).</li> <li>Ti\u1ec1n x\u1eed l\u00fd plaintext: lo\u1ea1i k\u00fd t\u1ef1 kh\u00f4ng ch\u1eef, \u0111\u1ed5i J\u2192I, t\u00e1ch th\u00e0nh digraphs, ch\u00e8n filler (th\u01b0\u1eddng X) khi hai k\u00fd t\u1ef1 tr\u00f9ng ho\u1eb7c khi ch\u1eef l\u1ebb.</li> <li>\u00c1p d\u1ee5ng quy t\u1eafc m\u00e3 h\u00f3a cho t\u1eebng c\u1eb7p.</li> <li>K\u1ebft h\u1ee3p c\u00e1c c\u1eb7p th\u00e0nh ciphertext.</li> </ol>"},{"location":"algorithms/classical/playfair/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Ma tr\u1eadn 5\u00d75 (array[5][5]) ch\u1ee9a k\u00fd t\u1ef1.</li> <li>B\u1ea3n \u0111\u1ed3 t\u1eeb k\u00fd t\u1ef1 -&gt; (h\u00e0ng, c\u1ed9t) \u0111\u1ec3 tra c\u1ee9u nhanh (dict/array).</li> <li>Plaintext t\u00e1ch digraphs l\u01b0u trong list/array.</li> </ul>"},{"location":"algorithms/classical/playfair/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi Caesar/Vigen\u00e8re: Playfair m\u00e3 h\u00f3a theo c\u1eb7p, gi\u1ea3m t\u1ea7n su\u1ea5t \u0111\u01a1n k\u00fd t\u1ef1.</li> <li>So v\u1edbi Hill cipher: Playfair l\u00e0 non-linear theo t\u1ecda \u0111\u1ed9 tr\u00ean ma tr\u1eadn k\u00fd t\u1ef1, Hill d\u00f9ng \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh (ma tr\u1eadn s\u1ed1) v\u00e0 c\u00f3 t\u00ednh to\u00e1n m\u00f4-\u0111un.</li> <li>So v\u1edbi modern ciphers (AES): Playfair c\u1ef1c k\u1ef3 y\u1ebfu, kh\u00f4ng c\u00f3 t\u00ednh to\u00e1n kh\u00f3a ph\u1ee9c t\u1ea1p hay b\u1ea3o m\u1eadt hi\u1ec7n \u0111\u1ea1i.</li> </ul>"},{"location":"algorithms/classical/playfair/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart TD\n    A[Input: Key, Plaintext] --&gt; B[Chu\u1ea9n h\u00f3a Key]\n    B --&gt; C[T\u1ea1o ma tr\u1eadn 5x5]\n    A --&gt; D[Ti\u1ec1n x\u1eed l\u00fd Plaintext: l\u1ecdc, J-&gt;I, t\u00e1ch digraph, ch\u00e8n X]\n    C --&gt; E[M\u00e3 h\u00f3a t\u1eebng digraph theo quy t\u1eafc]\n    D --&gt; E\n    E --&gt; F[Output: Ciphertext]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/classical/playfair/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Qu\u00ean gh\u00e9p I/J ho\u1eb7c x\u1eed l\u00fd J kh\u00f4ng nh\u1ea5t qu\u00e1n.</li> <li>X\u1eed l\u00fd kh\u00f4ng \u0111\u00fang khi hai k\u00fd t\u1ef1 tr\u00f9ng (kh\u00f4ng ch\u00e8n filler).</li> <li>S\u1eed d\u1ee5ng filler kh\u00f4ng nh\u1ea5t qu\u00e1n (X vs Q) g\u00e2y l\u1ed7i khi gi\u1ea3i m\u00e3 t\u1ef1 \u0111\u1ed9ng.</li> <li>Kh\u00f4ng chu\u1ea9n h\u00f3a ho\u1eb7c b\u1ecf qua k\u00fd t\u1ef1 kh\u00f4ng ph\u1ea3i ch\u1eef c\u00e1i.</li> <li>Sai v\u1ecb tr\u00ed khi \u00e1p d\u1ee5ng v\u00f2ng (mod 5) cho h\u00e0ng/c\u1ed9t.</li> </ul>"},{"location":"algorithms/classical/playfair/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>T\u1ea5n c\u00f4ng m\u1ee5c ti\u00eau: ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t digraph, known-plaintext, ciphertext-only.</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3: nhi\u1ec1u ciphertext, ph\u1ea7n plaintext bi\u1ebft tr\u01b0\u1edbc, ho\u1eb7c brute-force kh\u00f3a ng\u1eafn.</li> <li>Kh\u00f4ng ch\u1ed1ng \u0111\u01b0\u1ee3c: ph\u00e2n t\u00edch th\u1ed1ng k\u00ea digraphs, modern cryptoanalysis, t\u1ea5n c\u00f4ng m\u00e1y t\u00ednh.</li> </ul>"},{"location":"algorithms/classical/playfair/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Kh\u00f4ng d\u00f9ng Playfair cho b\u1ea3o m\u1eadt th\u1ef1c t\u1ebf.</li> <li>N\u1ebfu v\u1eabn d\u00f9ng trong m\u00f4i tr\u01b0\u1eddng gi\u00e1o d\u1ee5c/historical: k\u1ebft h\u1ee3p v\u1edbi thu\u1eadt to\u00e1n hi\u1ec7n \u0111\u1ea1i (v\u00ed d\u1ee5: Playfair ch\u1ec9 nh\u01b0 layer th\u00eam, kh\u00f4ng thay th\u1ebf).</li> <li>Thay \u0111\u1ed5i filler v\u00e0 quy \u01b0\u1edbc chu\u1ea9n ho\u00e1 r\u00f5 r\u00e0ng; kh\u00f3a d\u00e0i/ng\u1eabu nhi\u00ean h\u01a1n (d\u00f9 v\u1eabn y\u1ebfu).</li> <li>Gi\u1edbi h\u1ea1n l\u1ed9 l\u01b0\u1ee3ng ciphertext \u0111\u01b0\u1ee3c ph\u00e1t h\u00e0nh.</li> </ul>"},{"location":"algorithms/classical/playfair/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Key: MONARCHY     Ma tr\u1eadn:     M O N A R     C H Y B D     E F G I K     L P Q S T     U V W X Z</li> <li>Plaintext: HELLO \u2192 ti\u1ec1n x\u1eed l\u00fd: HE LX LO \u2192 Ciphertext: CF SU PM \u2192 \"CFSUPM\"</li> <li>Test th\u00eam: Plaintext HIDE THE GOLD IN THE TREE STUMP (chu\u1ea9n h\u00f3a/gh\u00e9p) \u2192 s\u1eed d\u1ee5ng vector tham kh\u1ea3o (tham kh\u1ea3o PracticalCryptography).</li> </ul>"},{"location":"algorithms/classical/playfair/#11-code-t\u00f3m-t\u1eaft-python","title":"11. Code (t\u00f3m t\u1eaft Python)","text":"Python<pre><code>def build_matrix(key):\n        import string\n        key = \"\".join(dict.fromkeys(key.upper().replace(\"J\",\"I\")))\n        alphabet = [c for c in string.ascii_uppercase if c != \"J\"]\n        seq = [c for c in key] + [c for c in alphabet if c not in key]\n        mat = [seq[i*5:(i+1)*5] for i in range(5)]\n        pos = {c:(r,cx) for r,row in enumerate(mat) for cx,c in enumerate(row)}\n        return mat,pos\n\ndef preprocess(pt):\n        pt = \"\".join(ch for ch in pt.upper() if ch.isalpha()).replace(\"J\",\"I\")\n        res=[]; i=0\n        while i&lt;len(pt):\n                a=pt[i]; b=pt[i+1] if i+1&lt;len(pt) else \"X\"\n                if a==b:\n                        res.append(a+\"X\"); i+=1\n                else:\n                        res.append(a+b); i+=2\n        if len(res[-1])==1: res[-1]+= \"X\"\n        return res\n\ndef encrypt_pair(a,b,mat,pos):\n        ra,ca = pos[a]; rb,cb = pos[b]\n        if ra==rb:\n                return mat[ra][(ca+1)%5] + mat[rb][(cb+1)%5]\n        if ca==cb:\n                return mat[(ra+1)%5][ca] + mat[(rb+1)%5][cb]\n        return mat[ra][cb] + mat[rb][ca]\n\ndef encrypt(pt,key):\n        mat,pos = build_matrix(key)\n        pairs = preprocess(pt)\n        return \"\".join(encrypt_pair(a,b,mat,pos) for a,b in pairs)\n</code></pre>"},{"location":"algorithms/classical/playfair/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Kh\u00f4ng d\u00f9ng Playfair cho d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m.</li> <li> Quy \u01b0\u1edbc I/J v\u00e0 filler \u0111\u01b0\u1ee3c t\u00e0i li\u1ec7u ho\u00e1.</li> <li> Ki\u1ec3m tra k\u1ef9 ti\u1ec1n x\u1eed l\u00fd plaintext tr\u00ean c\u1ea3 hai \u0111\u1ea7u (m\u00e3 h\u00f3a/gi\u1ea3i m\u00e3).</li> <li> H\u1ea1n ch\u1ebf l\u01b0\u1ee3ng ciphertext c\u00f4ng khai;</li> <li> Lu\u00f4n \u0111\u1eb7t Playfair trong l\u1edbp b\u1ea3o v\u1ec7 m\u1ea1nh (v\u00ed d\u1ee5: k\u1ebft h\u1ee3p v\u1edbi AES/HMAC n\u1ebfu c\u1ea7n t\u00ednh l\u1ecbch s\u1eed).</li> </ul>"},{"location":"algorithms/classical/playfair/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>Wikipedia \u2014 Playfair cipher: https://en.wikipedia.org/wiki/Playfair_cipher </li> <li>Practical Cryptography \u2014 Playfair: https://www.practicalcryptography.com/ciphers/playfair-cipher/ </li> <li>Bruce Schneier, \"Applied Cryptography\" (tham kh\u1ea3o l\u1ecbch s\u1eed v\u00e0 v\u00ed d\u1ee5)</li> </ul>"},{"location":"algorithms/classical/substitution/","title":"Substitution Cipher \u2014 Filevault context","text":""},{"location":"algorithms/classical/substitution/#substitution-cipher--filevault-context","title":"Substitution Cipher \u2014 Filevault context","text":""},{"location":"algorithms/classical/substitution/#0-filevault-context","title":"0. Filevault context","text":"<ul> <li>M\u1ee5c ti\u00eau: m\u00f4 t\u1ea3 k\u1ef9 thu\u1eadt M\u1eadt m\u00e3 thay th\u1ebf (Substitution Cipher) \u0111\u1ec3 hi\u1ec3u r\u1ee7i ro b\u1ea3o m\u1eadt, ki\u1ec3m th\u1eed, v\u00e0 h\u01b0\u1edbng thay th\u1ebf an to\u00e0n trong Filevault t\u00e0i li\u1ec7u.</li> </ul>"},{"location":"algorithms/classical/substitution/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<ul> <li>Kh\u00e1i ni\u1ec7m: thay th\u1ebf m\u1ed7i k\u00fd t\u1ef1 plaintext b\u1eb1ng k\u00fd t\u1ef1 ciphertext theo m\u1ed9t ho\u00e1n v\u1ecb (permutation) kh\u00f3a.  </li> <li>Gi\u1ea3i quy\u1ebft: che gi\u1ea5u n\u1ed9i dung b\u1eb1ng c\u00e1ch bi\u1ebfn k\u00fd t\u1ef1; b\u1ea3o v\u1ec7 t\u00ednh b\u1ea3o m\u1eadt (confidentiality) \u1edf m\u1ee9c c\u01a1 b\u1ea3n.  </li> <li>H\u1ea1n ch\u1ebf: kh\u00f4ng b\u1ea3o v\u1ec7 ch\u1ed1ng ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t, kh\u00f4ng \u0111\u1ea3m b\u1ea3o b\u1ea3o to\u00e0n d\u1eef li\u1ec7u hay x\u00e1c th\u1ef1c.</li> </ul>"},{"location":"algorithms/classical/substitution/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Kh\u00f4ng gian kh\u00f3a: \\(26! \\approx 4.03\\times10^{26}\\) (cho b\u1ea3ng ch\u1eef c\u00e1i Latin 26 ch\u1eef).  </li> <li>M\u00f4 t\u1ea3: kh\u00f3a l\u00e0 ho\u00e1n v\u1ecb \\(\\sigma\\) tr\u00ean t\u1eadp k\u00fd t\u1ef1 \\(A\\) (v\u00ed d\u1ee5 \\(A=\\{A..Z\\}\\)).  </li> <li>M\u00e3 h\u00f3a: \\(C = E_\\sigma(P)\\) v\u1edbi \\(E_\\sigma(p_i)=\\sigma(p_i)\\).  </li> <li>Gi\u1ea3i m\u00e3: \\(P = D_\\sigma(C)\\) v\u1edbi \\(D_\\sigma=\\sigma^{-1}\\).</li> </ul>"},{"location":"algorithms/classical/substitution/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>Kh\u00f3a: c\u1ea5p m\u1ed9t ho\u00e1n v\u1ecb \\(\\sigma\\).  </li> <li>M\u00e3 h\u00f3a: thay m\u1ed7i k\u00fd t\u1ef1 theo \\(\\sigma\\). K\u00fd t\u1ef1 kh\u00f4ng thu\u1ed9c b\u1ea3ng (s\u1ed1, d\u1ea5u) th\u01b0\u1eddng gi\u1eef nguy\u00ean ho\u1eb7c theo ch\u00ednh s\u00e1ch.  </li> <li>Gi\u1ea3i m\u00e3: \u00e1p d\u1ee5ng \\(\\sigma^{-1}\\).</li> </ul>"},{"location":"algorithms/classical/substitution/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>T\u1eeb \u0111i\u1ec3n/hash map: mapping k\u00fd t\u1ef1 -&gt; k\u00fd t\u1ef1 (v\u1edbi \u0111\u1ea3o ng\u01b0\u1ee3c).  </li> <li>M\u1ea3ng (size 26) cho \u00e1nh x\u1ea1 nhanh.  </li> <li>L\u01b0u tr\u1eef kh\u00f3a: bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng chu\u1ed7i 26 k\u00fd t\u1ef1 ho\u1eb7c m\u1ea3ng byte; c\u1ea7n t\u00ednh to\u00e1n ng\u01b0\u1ee3c cho gi\u1ea3i m\u00e3.</li> </ul>"},{"location":"algorithms/classical/substitution/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>Caesar: l\u00e0 tr\u01b0\u1eddng h\u1ee3p con (shift) c\u1ee7a Substitution v\u1edbi ho\u00e1n v\u1ecb d\u1ea1ng d\u1ecbch tr\u00f2n.  </li> <li>Vigen\u00e8re/Polyalphabetic: ch\u1ed1ng ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t t\u1ed1t h\u01a1n (nh\u01b0ng c\u00f3 l\u1ed7 h\u1ed5ng chu k\u1ef3).  </li> <li>One-time pad: cung c\u1ea5p b\u1ea3o m\u1eadt th\u00f4ng tin tuy\u1ec7t \u0111\u1ed1i n\u1ebfu kh\u00f3a th\u1ef1c s\u1ef1 ng\u1eabu nhi\u00ean, c\u00f9ng \u0111\u1ed9 d\u00e0i v\u00e0 ch\u1ec9 d\u00f9ng m\u1ed9t l\u1ea7n \u2014 kh\u00e1c h\u1eb3n substitution (kh\u00f4ng an to\u00e0n).  </li> <li>Homophonic substitution: gi\u1ea3m m\u1ed1i li\u00ean h\u1ec7 1:1 \u0111\u1ec3 l\u00e0m kh\u00f3 ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t.</li> </ul>"},{"location":"algorithms/classical/substitution/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart LR\n    P(Plaintext) --&gt;|Apply sigma| E[Encrypt]\n    E --&gt; C(Ciphertext)\n    C --&gt;|Apply sigma^-1| D[Decrypt]\n    D --&gt; P2(Recovered Plaintext)\n    subgraph Attack\n        C --&gt; FA[Frequency Analysis]\n        FA --&gt; Guess[Guess Mapping]\n        Guess --&gt; Decoded[Partial Decryption]\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/classical/substitution/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Sinh kh\u00f3a b\u1eb1ng RNG kh\u00f4ng \u0111\u1ee7 ng\u1eabu nhi\u00ean.  </li> <li>Kh\u00f4ng \u0111\u1ea3m b\u1ea3o ho\u00e1n v\u1ecb (tr\u00f9ng k\u00fd t\u1ef1 trong kh\u00f3a).  </li> <li>M\u00e3 h\u00f3a/gi\u1ea3i m\u00e3 kh\u00f4ng th\u1ed1ng nh\u1ea5t v\u1ec1 ch\u1eef hoa/ch\u1eef th\u01b0\u1eddng ho\u1eb7c Unicode.  </li> <li>\u0110\u1ec3 l\u1ea1i metadata (spaces, punctuation) m\u00e0 kh\u00f4ng c\u00e2n nh\u1eafc.  </li> <li>T\u00e1i s\u1eed d\u1ee5ng c\u00f9ng kh\u00f3a cho nhi\u1ec1u m\u1ee5c \u0111\u00edch m\u00e0 kh\u00f4ng thay \u0111\u1ed5i.</li> </ul>"},{"location":"algorithms/classical/substitution/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>M\u1ee5c ti\u00eau t\u1ea5n c\u00f4ng: thu \u0111\u01b0\u1ee3c plaintext t\u1eeb ciphertext.  </li> <li>Kh\u1ea3 n\u0103ng attacker: ciphertext-only (ph\u1ed5 bi\u1ebfn), known-plaintext, chosen-plaintext.  </li> <li>T\u00e1c h\u1ea1i: l\u1ed9 th\u00f4ng tin nh\u1ea1y c\u1ea3m do ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t, ng\u00f4n ng\u1eef, c\u1ea5u tr\u00fac v\u0103n b\u1ea3n.</li> </ul>"},{"location":"algorithms/classical/substitution/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Kh\u00f4ng d\u00f9ng Substitution cho d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m trong th\u1ef1c t\u1ebf.  </li> <li>N\u1ebfu v\u1eabn d\u00f9ng cho h\u1ecdc thu\u1eadt/legacy:  <ul> <li>K\u1ebft h\u1ee3p polyalphabetic/homophonic ho\u1eb7c l\u00e0m ti\u1ec1n x\u1eed l\u00fd (padding, chaff).  </li> <li>Che metadata, normalize input, t\u00e1ch t\u1eeb.  </li> <li>S\u1eed d\u1ee5ng RNG m\u1eadt m\u00e3 \u0111\u1ec3 sinh kh\u00f3a v\u00e0 b\u1ea3o v\u1ec7 kh\u00f3a.  </li> </ul> </li> <li>Khuy\u1ebfn ngh\u1ecb: d\u00f9ng chu\u1ea9n hi\u1ec7n \u0111\u1ea1i (v\u00ed d\u1ee5 AES-GCM cho confidentiality+integrity).</li> </ul>"},{"location":"algorithms/classical/substitution/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Key (v\u00ed d\u1ee5): sigma = \"QWERTYUIOPASDFGHJKLZXCVBNM\" (A-&gt;Q, B-&gt;W, ...).  </li> <li>Plaintext: \"HELLO WORLD\"  </li> <li>Ciphertext: \"ITSSG VGKSR\" (khi mapping theo sigma, kho\u1ea3ng tr\u1eafng gi\u1eef nguy\u00ean).  </li> <li>Ki\u1ec3m tra \u0111\u1ea3o ng\u01b0\u1ee3c: gi\u1ea3i m\u00e3 ciphertext v\u1edbi sigma^{-1} ph\u1ea3i tr\u1ea3 v\u1ec1 plaintext ban \u0111\u1ea7u.</li> </ul>"},{"location":"algorithms/classical/substitution/#11-code-ng\u1eafn-python","title":"11. Code (ng\u1eafn, Python)","text":"Python<pre><code>import secrets\nimport string\n\nALPH = string.ascii_uppercase\n\ndef gen_key():\n        arr = list(ALPH)\n        secrets.SystemRandom().shuffle(arr)\n        return ''.join(arr)\n\ndef encrypt(plain, key):\n        mp = {a:k for a,k in zip(ALPH, key)}\n        return ''.join(mp.get(ch, ch) for ch in plain.upper())\n\ndef decrypt(cipher, key):\n        mp = {k:a for a,k in zip(ALPH, key)}\n        return ''.join(mp.get(ch, ch) for ch in cipher.upper())\n</code></pre>"},{"location":"algorithms/classical/substitution/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> C\u00f3 thay th\u1ebf b\u1eb1ng thu\u1eadt to\u00e1n hi\u1ec7n \u0111\u1ea1i (AES-GCM) khi x\u1eed l\u00fd d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m?  </li> <li> Kh\u00f3a \u0111\u01b0\u1ee3c sinh b\u1eb1ng RNG m\u1eadt m\u00e3?  </li> <li> Kh\u00f3a l\u01b0u tr\u1eef an to\u00e0n (KMS/HSM) v\u00e0 kh\u00f4ng hard-code?  </li> <li> Chu\u1ea9n h\u00f3a \u0111\u1ea7u v\u00e0o (Unicode, case) tr\u01b0\u1edbc khi m\u00e3 h\u00f3a?  </li> <li> Ki\u1ec3m th\u1eed v\u1edbi vectors v\u00e0 t\u1ea5n c\u00f4ng ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t?  </li> <li> Log kh\u00f4ng ch\u1ee9a ciphertext/plaintext nh\u1ea1y c\u1ea3m?  </li> <li> C\u00f3 ch\u00ednh s\u00e1ch thay kh\u00f3a v\u00e0 b\u1ea3o qu\u1ea3n v\u00f2ng \u0111\u1eddi?</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o - https://en.wikipedia.org/wiki/Substitution_cipher - Katz &amp; Lindell, Introduction to Modern Cryptography (tham kh\u1ea3o kh\u00e1i ni\u1ec7m) - Bruce Schneier, Applied Cryptography (tham kh\u1ea3o l\u1ecbch s\u1eed/classical)</p>"},{"location":"algorithms/classical/vigenere/","title":"Vigen\u00e8re Cipher","text":""},{"location":"algorithms/classical/vigenere/#vigen\u00e8re-cipher","title":"Vigen\u00e8re Cipher","text":""},{"location":"algorithms/classical/vigenere/#0-filevault-context","title":"0. Filevault context","text":"<p>T\u00e0i li\u1ec7u n\u00e0y n\u1eb1m trong th\u01b0 m\u1ee5c algorithms/classical v\u00e0 m\u00f4 t\u1ea3 chi ti\u1ebft thu\u1eadt to\u00e1n Vigen\u00e8re d\u00f9ng l\u00e0m tham chi\u1ebfu gi\u00e1o d\u1ee5c v\u00e0 test vectors cho Filevault.</p>"},{"location":"algorithms/classical/vigenere/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n \u2014 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Vigen\u00e8re l\u00e0 m\u1ed9t m\u1eadt m\u00e3 thay th\u1ebf \u0111a b\u1ea3ng (polyalphabetic substitution) d\u00f9ng kh\u00f3a ch\u1eef \u0111\u1ec3 l\u00e0m d\u1ecbch chuy\u1ec3n tu\u1ea7n t\u1ef1 c\u00e1c k\u00fd t\u1ef1 plaintext. M\u1ee5c \u0111\u00edch: che gi\u1ea5u t\u1ea7n su\u1ea5t k\u00fd t\u1ef1 \u0111\u01a1n c\u1ee7a plaintext, l\u00e0m kh\u00f3 ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t so v\u1edbi Caesar \u0111\u01a1n b\u1ea3ng. Kh\u00f4ng b\u1ea3o v\u1ec7 ch\u1ed1ng ph\u00e2n t\u00edch chuy\u00ean s\u00e2u hay t\u1ea5n c\u00f4ng hi\u1ec7n \u0111\u1ea1i.</p>"},{"location":"algorithms/classical/vigenere/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>\u00c1nh x\u1ea1 k\u00fd t\u1ef1: A=0, B=1, \u2026, Z=25.</li> <li>V\u1edbi plaintext \\(P = P_0P_1\u2026\\), key \\(K = K_0\u2026K_{m-1}\\) (\u0111\u1ed9 d\u00e0i \\(m\\)).</li> <li>M\u00e3 h\u00f3a: \\(C_i = (P_i + K_{i \\bmod m}) \\bmod 26\\).</li> <li>Gi\u1ea3i m\u00e3: \\(P_i = (C_i - K_{i \\bmod m}) \\bmod 26\\).</li> <li>N\u1ebfu d\u00f9ng ch\u1eef th\u01b0\u1eddng/kh\u00f4ng ch\u1eef c\u00e1i, ch\u1ec9 \u00e1p d\u1ee5ng cho t\u1eadp k\u00fd t\u1ef1 \u0111\u1ecbnh tr\u01b0\u1edbc (v\u00ed d\u1ee5 A\u2013Z).</li> </ul>"},{"location":"algorithms/classical/vigenere/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>Chu\u1ea9n ho\u00e1 plaintext (lo\u1ea1i b\u1ecf/ghi nh\u00e3n k\u00fd t\u1ef1 kh\u00f4ng ch\u1eef, chuy\u1ec3n hoa).</li> <li>Chuy\u1ec3n m\u1ed7i k\u00fd t\u1ef1 th\u00e0nh s\u1ed1 theo \u00e1nh x\u1ea1.</li> <li>L\u1eb7p qua ch\u1ec9 s\u1ed1 i: c\u1ed9ng (ho\u1eb7c tr\u1eeb) gi\u00e1 tr\u1ecb key t\u1ea1i v\u1ecb tr\u00ed \\(i \\bmod m\\), l\u1ea5y modulo 26.</li> <li>Chuy\u1ec3n k\u1ebft qu\u1ea3 v\u1ec1 k\u00fd t\u1ef1.</li> </ul>"},{"location":"algorithms/classical/vigenere/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: m\u1ea3ng/chu\u1ed7i k\u00fd t\u1ef1 ho\u1eb7c m\u1ea3ng s\u1ed1 nguy\u00ean [0..25].</li> <li>Plaintext/Ciphertext: chu\u1ed7i ho\u1eb7c m\u1ea3ng byte/char.</li> <li>Implementation-friendly: buffer input, pointer key_index, ph\u00e9p to\u00e1n modulo nhanh.</li> </ul>"},{"location":"algorithms/classical/vigenere/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi Caesar: Vigen\u00e8re s\u1eed d\u1ee5ng nhi\u1ec1u b\u1ea3ng -&gt; ch\u1ed1ng ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t \u0111\u01a1n gi\u1ea3n t\u1ed1t h\u01a1n.</li> <li>So v\u1edbi OTP (One-Time Pad): Vigen\u00e8re d\u00f9ng kh\u00f3a l\u1eb7p l\u1ea1i =&gt; kh\u00f4ng th\u00f4ng tin-theoretic secure; OTP v\u1edbi kh\u00f3a d\u00e0i b\u1eb1ng plaintext v\u00e0 kh\u00f4ng l\u1eb7p th\u00ec an to\u00e0n.</li> <li>So v\u1edbi ciphers hi\u1ec7n \u0111\u1ea1i (AES): Vigen\u00e8re y\u1ebfu, kh\u00f4ng ch\u1ed1ng t\u1ea5n c\u00f4ng th\u1ed1ng k\u00ea, kh\u00f4ng ph\u00f9 h\u1ee3p b\u1ea3o m\u1eadt hi\u1ec7n \u0111\u1ea1i.</li> </ul>"},{"location":"algorithms/classical/vigenere/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng","text":"<p>Mermaid diagram: </p> <pre><code>flowchart LR\n    A[Input Plaintext] --&gt; B[\"Normalize&lt;br/&gt;Map to 0..25\"]\n    B --&gt; C{For each i}\n    C --&gt; D[\"Add key&lt;br/&gt;(i mod m) mod 26\"]\n    D --&gt; E[Map back to char]\n    E --&gt; F[Output Ciphertext]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/classical/vigenere/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng chu\u1ea9n ho\u00e1 ch\u1eef hoa/th\u01b0\u1eddng ho\u1eb7c \u0111\u1ec3 l\u1ea1i k\u00fd t\u1ef1 \u0111\u1eb7c bi\u1ec7t m\u00e0 kh\u00f4ng x\u1eed l\u00fd r\u00f5 r\u00e0ng.</li> <li>D\u00f9ng key l\u1eb7p ng\u1eafn (d\u1ec5 b\u1ecb Kasiski/Friedman).</li> <li>\u00c1nh x\u1ea1 k\u00fd t\u1ef1 kh\u00f4ng nh\u1ea5t qu\u00e1n (v\u00ed d\u1ee5 mix Unicode).</li> <li>\u00c1p d\u1ee5ng modulo sai (negative modulo kh\u00f4ng x\u1eed l\u00fd).</li> <li>Bao g\u1ed3m/lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng \u0111\u1ed3ng nh\u1ea5t gi\u1eefa m\u00e3 h\u00f3a/gi\u1ea3i m\u00e3.</li> </ul>"},{"location":"algorithms/classical/vigenere/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 ciphertext (ciphertext-only) ho\u1eb7c ciphertext + v\u00e0i plaintext x\u00e1c \u0111\u1ecbnh.</li> <li>M\u1ee5c ti\u00eau: ph\u1ee5c h\u1ed3i plaintext ho\u1eb7c key.</li> <li>C\u00f4ng c\u1ee5 t\u1ea5n c\u00f4ng: ph\u00e2n t\u00edch t\u1ea7n su\u1ea5t, Kasiski, Friedman, known-plaintext attacks.</li> <li>Kh\u00f4ng x\u00e9t c\u00e1c k\u00eanh b\u00ean (side-channels) chi ti\u1ebft; trong th\u1ef1c t\u1ebf, side-channels c\u0169ng c\u00f3 th\u1ec3 r\u00f2 r\u1ec9 kh\u00f3a.</li> </ul>"},{"location":"algorithms/classical/vigenere/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Kh\u00f4ng d\u00f9ng Vigen\u00e8re cho b\u1ea3o m\u1eadt th\u1ef1c t\u1ebf.</li> <li>N\u1ebfu b\u1eaft bu\u1ed9c s\u1eed d\u1ee5ng cho m\u1ee5c \u0111\u00edch l\u1ecbch s\u1eed/gi\u00e1o d\u1ee5c:<ul> <li>D\u00f9ng key \u0111\u1ee7 d\u00e0i v\u00e0 kh\u00f4ng l\u1eb7p (v\u1ec1 c\u01a1 b\u1ea3n tr\u1edf th\u00e0nh OTP).</li> <li>K\u1ebft h\u1ee3p v\u1edbi l\u1edbp m\u00e3 ho\u00e1 hi\u1ec7n \u0111\u1ea1i (v\u00ed d\u1ee5, s\u1eed d\u1ee5ng Vigen\u00e8re ch\u1ec9 nh\u01b0 tr\u00ecnh di\u1ec5n, c\u00f2n d\u1eef li\u1ec7u th\u1ef1c \u0111\u01b0\u1ee3c m\u00e3 ho\u00e1 b\u1eb1ng AEAD).</li> <li>Chu\u1ea9n ho\u00e1 encoding (ASCII/UTF-8) v\u00e0 x\u1eed l\u00fd k\u00fd t\u1ef1 nh\u1ea5t qu\u00e1n.</li> <li>Th\u1ef1c hi\u1ec7n ki\u1ec3m tra negative modulo \u0111\u00fang, sanitize input.</li> </ul> </li> </ul>"},{"location":"algorithms/classical/vigenere/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Vector 1:<ul> <li>Plaintext: \"HELLO\"</li> <li>Key: \"KEY\" (K=10,E=4,Y=24)</li> <li>Ciphertext: \"RIJVS\"</li> </ul> </li> <li>Vector 2:<ul> <li>Plaintext: \"ATTACKATDAWN\"</li> <li>Key: \"LEMON\"</li> <li>Ciphertext: \"LXFOPVEFRNHR\"</li> </ul> </li> <li>Vector 3 (non-letter ignored example):<ul> <li>Plaintext: \"HELLO, WORLD!\"</li> <li>Key: \"ABC\"</li> <li>With policy \"preserve non-letters\": \"HFNLP, YOSND!\" (verify implementation policy)</li> </ul> </li> </ul>"},{"location":"algorithms/classical/vigenere/#11-code-ng\u1eafn-python","title":"11. Code (ng\u1eafn, Python)","text":"Python<pre><code>def vigenere_encrypt(plain: str, key: str) -&gt; str:\n        key_nums = [(ord(c.upper()) - 65) for c in key if c.isalpha()]\n        if not key_nums: raise ValueError(\"empty key\")\n        out=[]\n        k=0\n        for ch in plain:\n                if ch.isalpha():\n                        base = 65 if ch.isupper() else 97\n                        p = ord(ch) - base\n                        shift = key_nums[k % len(key_nums)]\n                        c = (p + shift) % 26\n                        out.append(chr(c + base))\n                        k += 1\n                else:\n                        out.append(ch)\n        return ''.join(out)\n\ndef vigenere_decrypt(cipher: str, key: str) -&gt; str:\n        key_nums = [(ord(c.upper()) - 65) for c in key if c.isalpha()]\n        if not key_nums: raise ValueError(\"empty key\")\n        out=[]\n        k=0\n        for ch in cipher:\n                if ch.isalpha():\n                        base = 65 if ch.isupper() else 97\n                        c = ord(ch) - base\n                        shift = key_nums[k % len(key_nums)]\n                        p = (c - shift) % 26\n                        out.append(chr(p + base))\n                        k += 1\n                else:\n                        out.append(ch)\n        return ''.join(out)\n</code></pre>"},{"location":"algorithms/classical/vigenere/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Kh\u00f4ng d\u00f9ng Vigen\u00e8re cho d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m.</li> <li> Key kh\u00f4ng l\u1eb7p, \u0111\u1ee7 d\u00e0i; l\u01b0u tr\u1eef kh\u00f3a an to\u00e0n n\u1ebfu d\u00f9ng.</li> <li> X\u00e1c \u0111\u1ecbnh ch\u00ednh s\u00e1ch x\u1eed l\u00fd k\u00fd t\u1ef1 kh\u00f4ng ch\u1eef r\u00f5 r\u00e0ng.</li> <li> Th\u1ef1c thi modulo \u0111\u00fang cho s\u1ed1 \u00e2m.</li> <li> C\u00f3 b\u1ed9 test vectors t\u1ef1 \u0111\u1ed9ng (\u0111\u00e3 n\u00eau).</li> <li> Ki\u1ec3m tra encoding (UTF-8) v\u00e0 normalize tr\u01b0\u1edbc x\u1eed l\u00fd.</li> <li> Log/telemetry kh\u00f4ng ti\u1ebft l\u1ed9 key ho\u1eb7c intermediate states.</li> </ul>"},{"location":"algorithms/classical/vigenere/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher</li> <li>https://www.crypto101.io/ (gi\u00e1o d\u1ee5c m\u1eadt m\u00e3)</li> <li>Katz &amp; Lindell, Introduction to Modern Cryptography (\u0111\u1ec3 \u0111\u1ed1i chi\u1ebfu kh\u00e1i ni\u1ec7m b\u1ea3o m\u1eadt)</li> </ul>"},{"location":"algorithms/compression/bzip3/","title":"Bzip3","text":""},{"location":"algorithms/compression/bzip3/#0-filevault-context","title":"0. Filevault context","text":"<p>Filevault s\u1eed d\u1ee5ng Bzip3 nh\u01b0 m\u1ed9t ch\u1ebf \u0111\u1ed9 n\u00e9n lu\u1ed3ng d\u1eef li\u1ec7u kh\u00f4ng m\u1ea5t m\u00e1t trong pipeline l\u01b0u tr\u1eef/backup; m\u1ee5c ti\u00eau: gi\u1ea3m k\u00edch th\u01b0\u1edbc l\u01b0u tr\u1eef v\u00e0 b\u0103ng th\u00f4ng tr\u01b0\u1edbc khi m\u00e3 h\u00f3a/ch\u1eef k\u00fd. C\u1ea7n t\u00e1ch r\u1ea1ch vi\u1ec7c n\u00e9n v\u00e0 b\u1ea3o m\u1eadt (MAC/signature, encryption) \u2014 Bzip3 kh\u00f4ng thay th\u1ebf b\u1ea3o m\u1eadt.</p>"},{"location":"algorithms/compression/bzip3/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Bzip3 l\u00e0 chu\u1ed7i b\u01b0\u1edbc n\u00e9n lossless: BWT \u2192 MTF \u2192 RLE \u2192 m\u00e3 entropy (Huffman/ARN-like). Gi\u1ea3i quy\u1ebft: gi\u1ea3m dung l\u01b0\u1ee3ng d\u1eef li\u1ec7u cho l\u01b0u tr\u1eef/truy\u1ec1n t\u1ea3i. Kh\u00f4ng b\u1ea3o v\u1ec7 t\u00ednh ri\u00eang t\u01b0/\u0111\u1ed9 x\u00e1c th\u1ef1c/t\u00ednh to\u00e0n v\u1eb9n (tr\u1eeb khi b\u1ed5 sung checksum/HMAC/signature).</p>"},{"location":"algorithms/compression/bzip3/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Entropy ngu\u1ed3n: \\(H = -\\sum_i p_i \\log_2 p_i\\) (bit/symbol).</li> <li>Gi\u1edbi h\u1ea1n n\u00e9n t\u1ed1i thi\u1ec3u (lossless) ~ \\(H\\) bits/symbol.</li> <li>T\u1ef7 l\u1ec7 n\u00e9n x\u1ea5p x\u1ec9 \\(1 - \\dfrac{H}{\\text{bit\\_per\\_symbol}}\\) (t\u00f9y alphabet).</li> <li>K\u00edch th\u01b0\u1edbc m\u00e3 Huffman: \\(\\sum_i f_i \\, \\ell_i\\), v\u1edbi \\(\\ell_i\\) \u0111\u1ed9 d\u00e0i m\u00e3; Huffman t\u1ed1i \u01b0u trong l\u1edbp m\u00e3 r\u1eddi r\u1ea1c.</li> <li>L\u01b0u \u00fd: BWT t\u00e1i s\u1eafp x\u1ebfp d\u1eef li\u1ec7u \u0111\u1ec3 t\u0103ng t\u00ednh l\u1eb7p c\u1ee5c b\u1ed9 nh\u01b0ng kh\u00f4ng gi\u1ea3m entropy to\u00e0n c\u1ee5c.</li> </ul>"},{"location":"algorithms/compression/bzip3/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>T\u00e1ch input th\u00e0nh block k\u00edch th\u01b0\u1edbc gi\u1edbi h\u1ea1n (v\u00ed d\u1ee5 100\u2013900 KB).</li> <li>\u00c1p d\u1ee5ng BWT tr\u00ean m\u1ed7i block \u2192 chuy\u1ec3n c\u00e1c k\u00fd t\u1ef1 t\u01b0\u01a1ng t\u1ef1 v\u1ec1 g\u1ea7n nhau.</li> <li>\u00c1p d\u1ee5ng MTF \u0111\u1ec3 chuy\u1ec3n k\u00fd t\u1ef1 th\u00e0nh ch\u1ec9 s\u1ed1 v\u1ecb tr\u00ed \u0111\u1ed9ng (l\u00e0m n\u1ed5i b\u1eadt c\u00e1c gi\u00e1 tr\u1ecb nh\u1ecf).</li> <li>\u00c1p d\u1ee5ng RLE \u0111\u1ec3 n\u00e9n runs trong chu\u1ed7i MTF.</li> <li>X\u00e2y d\u1ef1ng b\u1ea3ng t\u1ea7n su\u1ea5t, m\u00e3 h\u00f3a b\u1eb1ng Huffman ho\u1eb7c m\u00f4 h\u00ecnh entropy kh\u00e1c.</li> <li>Ghi header block (metadata), b\u1ea3ng m\u00e3, bitstream n\u00e9n, checksum t\u00f9y ch\u1ecdn.</li> </ol>"},{"location":"algorithms/compression/bzip3/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Block buffer: byte[].</li> <li>Suffix array / SA ho\u1eb7c suffix-array induced sorting cho BWT.</li> <li>Danh s\u00e1ch MTF (array 256 ho\u1eb7c c\u1ea5u tr\u00fac linked/array \u0111\u1ed9ng).</li> <li>B\u1ea3ng t\u1ea7n su\u1ea5t: int[alphabet_size].</li> <li>C\u00e2y Huffman / b\u1ea3ng canonical Huffman (m\u00e3 chu\u1ea9n h\u00f3a).</li> <li>Bitstream reader/writer (bit-aligned, MSB/LSB order r\u00f5 r\u00e0ng).</li> <li>Checksum/HMAC (CRC32/CRC64/SHA256) cho integrity/auth.</li> </ul>"},{"location":"algorithms/compression/bzip3/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi LZ77/LZ78 (gzip/deflate): BWT-based th\u01b0\u1eddng n\u00e9n t\u1ed1t h\u01a1n cho v\u0103n b\u1ea3n c\u00f3 l\u1eb7p c\u1ee5c b\u1ed9 d\u00e0i, nh\u01b0ng \u0111\u00f2i CPU/RAM cao h\u01a1n.</li> <li>So v\u1edbi LZMA (xz): LZMA c\u00f3 kh\u1ea3 n\u0103ng n\u00e9n s\u00e2u h\u01a1n tr\u00ean nhi\u1ec1u lo\u1ea1i d\u1eef li\u1ec7u, nh\u01b0ng th\u01b0\u1eddng ch\u1eadm v\u00e0 ti\u00eau t\u1ed1n b\u1ed9 nh\u1edb.</li> <li>So v\u1edbi zstd/snappy: zstd c\u00e2n b\u1eb1ng t\u1ed1c \u0111\u1ed9 v\u00e0 n\u00e9n; snappy \u01b0u t\u1ed1c \u0111\u1ed9 r\u1ea5t cao, n\u00e9n th\u1ea5p.</li> <li>Trade-offs: throughput vs compression ratio vs memory.</li> </ul>"},{"location":"algorithms/compression/bzip3/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng","text":"<p>Mermaid (encode/decode flow): </p> <pre><code>flowchart LR\n    subgraph Encode\n        direction LR\n        A[Read block] --&gt; B[BWT]\n        B --&gt; C[MTF]\n        C --&gt; D[RLE]\n        D --&gt; E[Huffman]\n        E --&gt; F[Bitstream]\n    end\n\n    subgraph Decode\n        direction LR\n        F2[Bitstream] --&gt; E2[Huffman decode]\n        E2 --&gt; D2[RLE decode]\n        D2 --&gt; C2[MTF inverse]\n        C2 --&gt; B2[Inverse BWT]\n    end\n</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/compression/bzip3/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng thu\u1eadt to\u00e1n BWT O(n^2) cho block l\u1edbn (kh\u00f4ng kh\u1ea3 d\u1ee5ng).</li> <li>Kh\u00f4ng gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc block \u2192 DoS b\u1ed9 nh\u1edb.</li> <li>L\u1ed7i bitstream: sai bit-order ho\u1eb7c alignment.</li> <li>B\u1ea3ng Huffman kh\u00f4ng chu\u1ea9n h\u00f3a \u2192 decode kh\u00f4ng nh\u1ea5t qu\u00e1n.</li> <li>Thi\u1ebfu ki\u1ec3m tra input \u2192 OOB reads/writes.</li> <li>Qu\u00ean sentinel/EOF trong BWT \u2192 ph\u1ee5c h\u1ed3i sai.</li> </ul>"},{"location":"algorithms/compression/bzip3/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Malformed/huge input g\u00e2y DoS (CPU/Mem).</li> <li>Truncated/malicious bitstream g\u00e2y crash ho\u1eb7c decode sai.</li> <li>Buffer overflow d\u1eabn t\u1edbi RCE.</li> <li>Side-channel (timing) leaking n\u1ed9i dung.</li> <li>Compression bomb: file nh\u1ecf n\u00e9n cao g\u00e2y gi\u1ea3i n\u00e9n ti\u00eau th\u1ee5 t\u00e0i nguy\u00ean l\u1edbn.</li> </ul>"},{"location":"algorithms/compression/bzip3/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc block v\u00e0 t\u1ed5ng b\u1ed9 nh\u1edb s\u1eed d\u1ee5ng.</li> <li>Ki\u1ec3m tra header, checksum/HMAC tr\u01b0\u1edbc khi gi\u1ea3i n\u00e9n.</li> <li>Bound c\u00e1c tham s\u1ed1 (s\u1ed1 n\u00fat Huffman, \u0111\u1ed9 d\u00e0i code t\u1ed1i \u0111a).</li> <li>D\u00f9ng canonical Huffman \u0111\u1ec3 tr\u00e1nh gi\u1ea3i m\u00e3 kh\u00f4ng nh\u1ea5t qu\u00e1n.</li> <li>S\u1eed d\u1ee5ng ng\u00f4n ng\u1eef an to\u00e0n ho\u1eb7c sanitizers (ASan/UBSan).</li> <li>Rate limiting, timeouts, quota cho d\u1ecbch v\u1ee5 n\u00e9n/gi\u1ea3i n\u00e9n.</li> <li>Fuzz testing decoder v\u00e0 static analysis.</li> </ul>"},{"location":"algorithms/compression/bzip3/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Vector 1: Input \"\" \u2192 expect archive h\u1ee3p l\u1ec7, block length = 0.</li> <li>Vector 2: Input \"banana\" \u2192 round-trip decode(encode(\"banana\")) == \"banana\". Ki\u1ec3m tra BWT/IBWT.</li> <li>Vector 3: Input \"aaaaaaa\" \u2192 RLE m\u1ea1nh, high compression.</li> <li>Vector 4: Random block size = block_limit \u2192 n\u00e9n k\u00e9m, verify lossless.</li> <li>Vector 5: Truncated header/bitstream \u2192 decoder ph\u1ea3i fail-safe (kh\u00f4ng crash).</li> <li>Ki\u1ec3m tra checksum/HMAC failure handling.</li> </ul>"},{"location":"algorithms/compression/bzip3/#11-code-pseudo-code","title":"11. Code (pseudo-code)","text":"<p>Encoder (t\u00f3m t\u1eaft): </p>Text Only<pre><code>func encode(block):\n    if len(block) == 0: write_empty_block(); return\n    bwt = BWT(block)\n    mtf = MTF_encode(bwt)\n    rle = RLE_encode(mtf)\n    freqs = freq_table(rle)\n    table = build_canonical_huffman(freqs)\n    bits = huffman_encode(rle, table)\n    write_header(table, len(block))\n    write_bits(bits)\n    write_checksum(hash(block))\n</code></pre> Decoder (t\u00f3m t\u1eaft): Text Only<pre><code>func decode(stream):\n    header = read_header()\n    validate_header(header)\n    table = read_huffman_table()\n    bits = read_bits()\n    rle = huffman_decode(bits, table)\n    mtf = RLE_decode(rle)\n    bwt = MTF_decode(mtf)\n    block = inverseBWT(bwt, header.orig_len)\n    verify_checksum(block)\n    return block\n</code></pre> (Ghi ch\u00fa: ki\u1ec3m tra l\u1ed7i m\u1ecdi b\u01b0\u1edbc; x\u1eed l\u00fd resource limits.)<p></p>"},{"location":"algorithms/compression/bzip3/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc block v\u00e0 t\u1ed5ng b\u1ed9 nh\u1edb.</li> <li> Validate header v\u00e0 b\u1ea3ng Huffman tr\u01b0\u1edbc khi gi\u1ea3i m\u00e3.</li> <li> S\u1eed d\u1ee5ng canonical Huffman \u0111\u1ec3 chu\u1ea9n h\u00f3a b\u1ea3ng.</li> <li> Bounds-checking cho m\u1ecdi buffer access.</li> <li> Bitstream reader an to\u00e0n (kh\u00f4ng \u0111\u1ecdc v\u01b0\u1ee3t/underflow).</li> <li> Ki\u1ec3m tra checksum/HMAC tr\u01b0\u1edbc khi tr\u1ea3 d\u1eef li\u1ec7u tin c\u1eady.</li> <li> Rate limits, timeouts, CPU/memory quotas.</li> <li> Fuzz tests + CI v\u1edbi ASan/UBSan v\u00e0 static analysis.</li> <li> Log h\u1ea1n ch\u1ebf (kh\u00f4ng ti\u1ebft l\u1ed9 d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m).</li> <li> Fail-safe: decoder ph\u1ea3i t\u1eeb ch\u1ed1i input malformed ch\u1ee9 kh\u00f4ng crash.</li> </ul>"},{"location":"algorithms/compression/bzip3/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>Burrows &amp; Wheeler, \u201cA Block-sorting Lossless Data Compression Algorithm\u201d.</li> <li>Move-to-front v\u00e0 RLE kh\u00e1i ni\u1ec7m: s\u00e1ch gi\u00e1o khoa n\u00e9n d\u1eef li\u1ec7u.</li> <li>Huffman, D. A., \u201cA Method for the Construction of Minimum-Redundancy Codes\u201d.</li> <li>bzip2 implementation notes: https://sourceware.org/bzip2/</li> <li>RFC/notes v\u1ec1 canonical Huffman v\u00e0 bitstream handling.</li> </ul>"},{"location":"algorithms/compression/compression/","title":"Compression","text":""},{"location":"algorithms/compression/compression/#compression","title":"Compression","text":""},{"location":"algorithms/compression/compression/#0-filevault-context","title":"0. FileVault context","text":"<p>FileVault n\u00e9n d\u1eef li\u1ec7u tr\u01b0\u1edbc khi m\u00e3 h\u00f3a \u0111\u1ec3 gi\u1ea3m dung l\u01b0\u1ee3ng l\u01b0u tr\u1eef v\u00e0 t\u1ed1i \u01b0u I/O. M\u00f4 h\u00ecnh v\u1eadn h\u00e0nh: d\u1eef li\u1ec7u t\u0129nh (file) \u2192 n\u00e9n \u2192 m\u00e3 h\u00f3a (AEAD) \u2192 l\u01b0u tr\u1eef.</p>"},{"location":"algorithms/compression/compression/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n--gi\u1ea3i-quy\u1ebft-v\u00e0-b\u1ea3o-v\u1ec7","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n \u2014 gi\u1ea3i quy\u1ebft v\u00e0 b\u1ea3o v\u1ec7","text":"<ul> <li>M\u1ee5c ti\u00eau: lo\u1ea1i b\u1ecf t\u00ednh d\u01b0 th\u1eeba nh\u1eb1m gi\u1ea3m k\u00edch th\u01b0\u1edbc v\u00e0 b\u0103ng th\u00f4ng.</li> <li>Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1: gi\u1ea3m k\u00edch th\u01b0\u1edbc l\u01b0u tr\u1eef/backup, t\u0103ng hi\u1ec7u qu\u1ea3 truy\u1ec1n t\u1ea3i.</li> <li>B\u1ea3o v\u1ec7: n\u00e9n kh\u00f4ng ph\u1ea3i l\u00e0 b\u1ea3o m\u1eadt; n\u00e9n tr\u01b0\u1edbc m\u00e3 h\u00f3a c\u00f3 th\u1ec3 l\u00e0m l\u1ed9 th\u00f4ng tin v\u1ec1 k\u00edch th\u01b0\u1edbc/\u0111\u1ed9 d\u00e0i, v\u00ec v\u1eady c\u1ea7n m\u00e3 h\u00f3a m\u1ea1nh (AEAD) v\u00e0 ch\u00fa \u00fd threat model.</li> </ul>"},{"location":"algorithms/compression/compression/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Entropy Shannon: \\(H(X) = -\\sum_i p_i \\log_2 p_i\\).</li> <li>T\u1ef7 l\u1ec7 n\u00e9n (compression ratio): \\(\\mathrm{CR} = \\frac{\\text{compressed\\_size}}{\\text{original\\_size}}\\) (nh\u1ecf h\u01a1n 1 t\u1ed1t h\u01a1n).</li> <li>L\u1ee3i \u00edch t\u1ed1i \u0111a l\u00fd thuy\u1ebft khi \\(H(X)\\) th\u1ea5p; n\u00e9n kh\u00f4ng th\u1ec3 gi\u1ea3m d\u01b0\u1edbi entropy ngu\u1ed3n.</li> </ul>"},{"location":"algorithms/compression/compression/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ul> <li>LZ-based (Zlib/Deflate, LZMA): t\u00ecm c\u00e1c chu\u1ed7i l\u1eb7p (dictionary), m\u00e3 h\u00f3a v\u1ecb tr\u00ed/\u0111\u1ed9 d\u00e0i, sau \u0111\u00f3 entropy-coding (Huffman/Range).</li> <li>BWT (bzip2): bi\u1ebfn \u0111\u1ed5i Burrows\u2013Wheeler \u2192 RLE \u2192 Huffman.</li> <li>C\u00e1c b\u01b0\u1edbc chung: ph\u00e2n t\u00edch chu\u1ed7i \u2192 bi\u1ec3u di\u1ec5n l\u1eb7p l\u1ea1i \u2192 m\u00e3 h\u00f3a entropy \u2192 output stream.</li> </ul>"},{"location":"algorithms/compression/compression/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Dictionary / sliding window (LZ77): buffer tr\u01b0\u1ee3t, hash/hashtable \u0111\u1ec3 t\u00ecm match.</li> <li>Suffix arrays/trees (m\u1ed9t s\u1ed1 thu\u1eadt to\u00e1n t\u1ed1i \u01b0u t\u00ecm match).</li> <li>Fenwick/bitstream cho entropy coding; c\u00e2y Huffman ho\u1eb7c coder t\u1ea7n su\u1ea5t / range coder.</li> </ul>"},{"location":"algorithms/compression/compression/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c-t\u00f3m-t\u1eaft","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c (t\u00f3m t\u1eaft)","text":"<ul> <li>Zlib/Deflate: nhanh, t\u1ec9 l\u1ec7 trung b\u00ecnh \u2014 t\u1ed1t cho realtime.</li> <li>LZMA: t\u1ec9 l\u1ec7 cao, ch\u1eadm khi n\u00e9n, b\u1ed9 nh\u1edb l\u1edbn \u2014 t\u1ed1t cho archival.</li> <li>Bzip2: trung gian t\u1ec9 l\u1ec7/\u0111\u1ed9 tr\u1ec5, CPU-bound.</li> <li>L\u1ef1a ch\u1ecdn d\u1ef1a tr\u00ean: t\u1ed1c \u0111\u1ed9 n\u00e9n/gi\u1ea3i n\u00e9n, RAM, k\u00edch th\u01b0\u1edbc \u0111\u1ea7u ra, latency.</li> </ul>"},{"location":"algorithms/compression/compression/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-pipeline","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (pipeline)","text":"<p>Mermaid: </p> <pre><code>flowchart LR\n    A[Plain File] --&gt; B[Compress]\n    B --&gt; C[\"Encrypt (AEAD)\"]\n    C --&gt; D[Store]\n    subgraph Verify\n        C --&gt; E[Integrity check at decrypt]\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/compression/compression/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Compress-then-encrypt b\u1ecb b\u1ecf qua \u2192 Encrypt-then-compress (v\u00f4 hi\u1ec7u).</li> <li>N\u00e9n theo-chunk m\u00e0 d\u00f9ng k\u00edch th\u01b0\u1edbc c\u1ed1 \u0111\u1ecbnh kh\u00f4ng s\u1ea1ch s\u1ebd d\u1eabn t\u1edbi r\u00f2 r\u1ec9 chi\u1ec1u d\u00e0i.</li> <li>D\u00f9ng thu\u1eadt to\u00e1n n\u00e9n deterministic + attacker-control input \u2192 CRIME/BREACH style leakage n\u1ebfu \u1ee9ng d\u1ee5ng stream/HTTP.</li> <li>Thi\u1ebfu authentication (MAC/AEAD) \u2014 cho ph\u00e9p tampering.</li> <li>Kh\u00f4ng ki\u1ec3m so\u00e1t gi\u1edbi h\u1ea1n b\u1ed9 nh\u1edb/\u0111\u1ed9c quy\u1ec1n d\u1eabn \u0111\u1ebfn DoS.</li> </ul>"},{"location":"algorithms/compression/compression/#8-threat-model-c\u1ee5-th\u1ec3-cho-filevault","title":"8. Threat Model (c\u1ee5 th\u1ec3 cho FileVault)","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 kh\u1ea3 n\u0103ng \u0111\u1ecdc ciphertext (l\u01b0u tr\u1eef b\u1ecb l\u1ed9) v\u00e0 c\u00f3 th\u1ec3 ch\u00e8n/\u0111i\u1ec1u ch\u1ec9nh plaintext tr\u01b0\u1edbc khi n\u00e9n? (th\u01b0\u1eddng kh\u00f4ng trong file static).</li> <li>M\u1ed1i \u0111e d\u1ecda ch\u00ednh: ti\u1ebft l\u1ed9 \u0111\u1ed9 d\u00e0i, metadata, t\u1eeb k\u00edch th\u01b0\u1edbc n\u00e9n.</li> <li>Kh\u00f4ng x\u00e9t threat: passive offline attacker kh\u00f4ng c\u00f3 kh\u1ea3 n\u0103ng chosen-plaintext.</li> </ul>"},{"location":"algorithms/compression/compression/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Always: Compress-then-Encrypt.</li> <li>D\u00f9ng AEAD (AES-GCM, ChaCha20-Poly1305) cho t\u00ednh b\u1ea3o m\u1eadt &amp; integritiy.</li> <li>Th\u00eam padding / length-hiding n\u1ebfu c\u1ea7n ch\u1ed1ng leak k\u00edch th\u01b0\u1edbc.</li> <li>Ph\u00e2n \u0111o\u1ea1n an to\u00e0n: chunked compression + per-chunk AEAD nonces.</li> <li>Gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc v\u00e0 t\u00e0i nguy\u00ean khi gi\u1ea3i n\u00e9n \u0111\u1ec3 tr\u00e1nh DoS.</li> <li>Kh\u00f4ng cho ph\u00e9p attacker-chosen data g\u1eafn li\u1ec1n v\u1edbi b\u00ed m\u1eadt s\u1ed1ng trong c\u00f9ng block tr\u01b0\u1edbc khi n\u00e9n.</li> </ul>"},{"location":"algorithms/compression/compression/#10-test-vectors-ki\u1ec3m-tra-c\u01a1-b\u1ea3n","title":"10. Test Vectors (ki\u1ec3m tra c\u01a1 b\u1ea3n)","text":"<ul> <li>Round-trip test:<ul> <li>Input: \"The quick brown fox jumps over the lazy dog\" (UTF-8).</li> <li>Steps: compress \u2192 encrypt \u2192 decrypt \u2192 decompress \u2192 equals original.</li> </ul> </li> <li>Edge cases:<ul> <li>Empty file.</li> <li>Repetitive data (1 MiB of 'A').</li> <li>High-entropy data (random bytes) \u2014 n\u00e9n kh\u00f4ng gi\u1ea3m k\u00edch th\u01b0\u1edbc.</li> </ul> </li> <li>\u0110o: x\u00e1c nh\u1eadn CR, th\u00e0nh c\u00f4ng gi\u1ea3i n\u00e9n, tag AEAD h\u1ee3p l\u1ec7, kh\u00f4ng crash.</li> </ul>"},{"location":"algorithms/compression/compression/#11-code-v\u00ed-d\u1ee5-ng\u1eafn-compress-then-encrypt-b\u1eb1ng-python--zlib--cryptography","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn, compress-then-encrypt b\u1eb1ng Python + zlib + cryptography)","text":"Python<pre><code>import zlib, os\nfrom cryptography.hazmat.primitives.ciphers.aead import AESGCM\n\ndef compress_then_encrypt(plaintext: bytes, key: bytes) -&gt; bytes:\n        comp = zlib.compress(plaintext)\n        aesgcm = AESGCM(key)\n        nonce = os.urandom(12)\n        ct = aesgcm.encrypt(nonce, comp, None)\n        return nonce + ct\n\ndef decrypt_then_decompress(blob: bytes, key: bytes) -&gt; bytes:\n        nonce, ct = blob[:12], blob[12:]\n        aesgcm = AESGCM(key)\n        comp = aesgcm.decrypt(nonce, ct, None)\n        return zlib.decompress(comp)\n</code></pre> L\u01b0u \u00fd: qu\u1ea3n l\u00fd key/nonce theo chu\u1ea9n; d\u00f9ng KDF cho key, kh\u00f4ng t\u00e1i s\u1eed d\u1ee5ng nonce."},{"location":"algorithms/compression/compression/#12-checklist-b\u1ea3o-m\u1eadt-ng\u1eafn","title":"12. Checklist b\u1ea3o m\u1eadt (ng\u1eafn)","text":"<ul> <li> Compress-then-encrypt \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng.</li> <li> S\u1eed d\u1ee5ng AEAD; ki\u1ec3m tra tag tr\u01b0\u1edbc gi\u1ea3i n\u00e9n.</li> <li> Nonce/IV qu\u1ea3n l\u00fd an to\u00e0n (unique per key).</li> <li> Padding/length-hiding n\u1ebfu threat model y\u00eau c\u1ea7u.</li> <li> Gi\u1edbi h\u1ea1n b\u1ed9 nh\u1edb/CPU cho n\u00e9n/gi\u1ea3i n\u00e9n.</li> <li> Test vectors cho edge cases \u0111\u00e3 ch\u1ea1y.</li> <li> Logging/monitoring cho l\u1ed7i n\u00e9n/gi\u1ea3i n\u00e9n.</li> </ul>"},{"location":"algorithms/compression/compression/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 1951 \u2014 DEFLATE</li> <li>LZMA SDK (docs)</li> <li>Bzip2 specification</li> <li>Articles on CRIME/BREACH (side-channel compression leaks)</li> <li>Shannon entropy fundamentals</li> </ul>"},{"location":"algorithms/compression/zlib/","title":"Zlib","text":""},{"location":"algorithms/compression/zlib/#zlib","title":"Zlib","text":""},{"location":"algorithms/compression/zlib/#0-filevault-context","title":"0. Filevault context","text":"<p>Filevault docs \u2014 m\u1ee5c \"algorithms/compression\": t\u00f3m t\u1eaft k\u1ef9 thu\u1eadt, r\u1ee7i ro b\u1ea3o m\u1eadt v\u00e0 h\u01b0\u1edbng d\u1eabn ki\u1ec3m th\u1eed cho zlib/DEFLATE \u0111\u1ec3 d\u00f9ng trong \u0111\u00e1nh gi\u00e1 th\u00e0nh ph\u1ea7n v\u00e0 thi\u1ebft k\u1ebf h\u1ec7 th\u1ed1ng l\u01b0u tr\u1eef/m\u00e3 h\u00f3a.</p>"},{"location":"algorithms/compression/zlib/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Zlib l\u00e0 th\u01b0 vi\u1ec7n v\u00e0 \u0111\u1ecbnh d\u1ea1ng wrapper cho thu\u1eadt to\u00e1n DEFLATE (k\u1ebft h\u1ee3p LZ77 + Huffman). M\u1ee5c ti\u00eau: gi\u1ea3m k\u00edch th\u01b0\u1edbc d\u1eef li\u1ec7u \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u0103ng th\u00f4ng/l\u01b0u tr\u1eef. Zlib kh\u00f4ng cung c\u1ea5p b\u1ea3o m\u1eadt (kh\u00f4ng m\u00e3 h\u00f3a); ch\u1ec9 c\u00f3 checksum (Adler\u201132 trong wrapper) \u0111\u1ec3 ki\u1ec3m tra to\u00e0n v\u1eb9n b\u1ec1 m\u1eb7t, kh\u00f4ng \u0111\u1ea3m b\u1ea3o t\u00ednh x\u00e1c th\u1ef1c.</p>"},{"location":"algorithms/compression/zlib/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>LZ77: thay th\u1ebf c\u00e1c \u0111o\u1ea1n l\u1eb7p b\u1eb1ng c\u1eb7p (distance, length).  </li> <li>Huffman coding: m\u00e3 ti\u1ec1n t\u1ed1 t\u1ed1i \u01b0u d\u1ef1a tr\u00ean t\u1ea7n su\u1ea5t; \u0111\u1ed9 d\u00e0i trung b\u00ecnh m\u00e3 \u2265 entropy \\(H(X)= -\\sum_x p(x)\\log_2 p(x)\\).  </li> <li>Adler\u201132: c\u1eadp nh\u1eadt A,B tr\u00ean modulo \\(65521\\), checksum \\(= (B \\ll 16) | A\\). C\u1eadp nh\u1eadt cho byte \\(b\\): \\(A=(A+b)\\bmod 65521\\), \\(B=(B+A)\\bmod 65521\\).  </li> <li>CRC32: t\u00ednh theo \u0111a th\u1ee9c modulo-2; t\u1ed5ng qu\u00e1t: checksum l\u00e0 ph\u1ea7n d\u01b0 c\u1ee7a ph\u00e9p chia \u0111a th\u1ee9c d\u1eef li\u1ec7u nh\u00e2n \\(x^{32}\\) cho \u0111a th\u1ee9c sinh \\(G(x)\\) (v\u00ed d\u1ee5 CRC\u201132/ISO\u2011HDLC).</li> </ul>"},{"location":"algorithms/compression/zlib/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>D\u1eef li\u1ec7u chia th\u00e0nh block.  </li> <li>Trong m\u1ed7i block: t\u00ecm match LZ77 trong c\u1eeda s\u1ed5 tr\u01b0\u1ee3t (max 32 KB) v\u00e0 ph\u00e1t sinh literal ho\u1eb7c (distance,length).  </li> <li>Thu th\u1eadp t\u1ea7n su\u1ea5t; x\u00e2y d\u1ef1ng Huffman dynamic (ho\u1eb7c d\u00f9ng m\u00e3 t\u0129nh).  </li> <li>Ghi block header, m\u00e3 h\u00f3a b\u1eb1ng bit-level v\u00e0o bitstream, xu\u1ea5t wrapper header v\u00e0 checksum (Adler\u201132 cho zlib).</li> </ul>"},{"location":"algorithms/compression/zlib/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Sliding window buffer (32 KB).  </li> <li>Hash table / hash chains cho t\u00ecm match nhanh.  </li> <li>Frequency table / tree cho Huffman (ho\u1eb7c canonical code tables).  </li> <li>Bit buffer / bit writer-reader.  </li> <li>Struct header: CMF/FLG (zlib), t\u00f9y ch\u1ecdn gzip header/trailer.</li> </ul>"},{"location":"algorithms/compression/zlib/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>gzip: c\u00f9ng DEFLATE, kh\u00e1c wrapper/headers.  </li> <li>bzip2: BWT+MTF+Huffman \u2014 th\u01b0\u1eddng n\u00e9n t\u1ed1t h\u01a1n v\u0103n b\u1ea3n, ch\u1eadm h\u01a1n.  </li> <li>LZ4: t\u1ed1i \u01b0u t\u1ed1c \u0111\u1ed9 (n\u00e9n/gi\u1ea3i n\u00e9n r\u1ea5t nhanh), t\u1ec9 l\u1ec7 th\u1ea5p h\u01a1n.  </li> <li>Zstandard: c\u00e2n b\u1eb1ng t\u1ed1c \u0111\u1ed9 v\u00e0 t\u1ec9 l\u1ec7, th\u01b0\u1eddng v\u01b0\u1ee3t DEFLATE.  </li> <li>Brotli: hi\u1ec7u qu\u1ea3 n\u00e9n cao cho web, t\u1ed1n CPU h\u01a1n DEFLATE.</li> </ul>"},{"location":"algorithms/compression/zlib/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<pre><code>flowchart LR\n    A[Input] --&gt; B[Split into blocks]\n\n    subgraph LZ77_Stage [LZ77 Stage]\n        direction LR\n        B --&gt; C[LZ77 match search]\n        C --&gt; D[Produce literals &amp; matches]\n    end\n\n    subgraph Entropy_Coding [Entropy Coding]\n        direction LR\n        D --&gt; E[\"Compute frequencies\\n(optional)\"]\n        E --&gt; F[Build / Use Huffman codes]\n        F --&gt; G[\"Emit block headers\\n+ bitstream\"]\n    end\n\n    G --&gt; H[Append wrapper checksum]\n    H --&gt; I[Output]\n</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/compression/zlib/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng x\u1eed l\u00fd/ki\u1ec3m tra return code t\u1eeb API.  </li> <li>Tr\u00e0n/b\u1ed9i/thi\u1ebfu ki\u1ec3m so\u00e1t khi \u0111\u1ecdc/ghi bitstream ho\u1eb7c window.  </li> <li>Kh\u00f4ng gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc gi\u1ea3i n\u00e9n (decompression bomb).  </li> <li>Tin checksum l\u00e0 b\u1ea3o m\u1eadt (Adler\u201132 d\u1ec5 va ch\u1ea1m).  </li> <li>Hash chain qu\u00e1 s\u00e2u g\u00e2y CPU DoS.  </li> <li>Parse header/trailer kh\u00f4ng \u0111\u1ea7y \u0111\u1ee7 g\u00e2y l\u1ed7i khi \u0111\u1ecdc d\u1eef li\u1ec7u t\u00f9y bi\u1ebfn.</li> </ul>"},{"location":"algorithms/compression/zlib/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Attacker g\u1eedi d\u1eef li\u1ec7u n\u00e9n \u0111\u1ed9c h\u1ea1i \u0111\u1ec3: g\u00e2y tr\u00e0n b\u1ed9 nh\u1edb, l\u00e0m c\u1ea1n CPU (CPU exhaustion), k\u00edch ho\u1ea1t l\u1ed7 h\u1ed5ng native (RCE), ho\u1eb7c thay \u0111\u1ed5i n\u1ed9i dung n\u1ebfu kh\u00f4ng ki\u1ec3m tra checksum/kh\u00f4ng d\u00f9ng authenticity.  </li> <li>K\u1ef3 v\u1ecdng attacker c\u00f3 th\u1ec3 t\u1ea1o block/streams \u0111\u1eb7c bi\u1ec7t \u0111\u1ec3 g\u00e2y deep recursion ho\u1eb7c very long matches.</li> </ul>"},{"location":"algorithms/compression/zlib/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc gi\u1ea3i n\u00e9n t\u1ed1i \u0111a v\u00e0 s\u1ed1 block.  </li> <li>Thi\u1ebft l\u1eadp quotas: b\u1ed9 nh\u1edb, th\u1eddi gian CPU, I/O.  </li> <li>Ki\u1ec3m tra t\u1ea5t c\u1ea3 return codes; validate header v\u00e0 checksum.  </li> <li>Ch\u1ea1y gi\u1ea3i n\u00e9n trong sandbox/process isolation; s\u1eed d\u1ee5ng throttling.  </li> <li>S\u1eed d\u1ee5ng phi\u00ean b\u1ea3n zlib \u0111\u00e3 v\u00e1; b\u1eadt hardening (ASLR, DEP, stack canaries).  </li> <li>N\u1ebfu c\u1ea7n integrity+authenticity: d\u00f9ng HMAC/signature ch\u1ee9 kh\u00f4ng d\u1ef1a v\u00e0o Adler\u201132.</li> </ul>"},{"location":"algorithms/compression/zlib/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Empty: \"\" -&gt; zlib: 78 9C 03 00 00 00 00 01 (v\u00ed d\u1ee5).  </li> <li>Short text: \"hello world\" \u2014 round\u2011trip check.  </li> <li>Repetitive: \"A\"*10000 \u2014 k\u1ef3 v\u1ecdng t\u1ec9 l\u1ec7 n\u00e9n cao.  </li> <li>Random: random bytes \u2014 kh\u00f4ng n\u00e9n t\u1ed1t. Ki\u1ec3m tra: decompress(compress(x)) == x; verify checksum; ki\u1ec3m th\u1eed gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc v\u00e0 t\u00e0i nguy\u00ean.</li> </ul>"},{"location":"algorithms/compression/zlib/#11-code-v\u00ed-d\u1ee5-ng\u1eafn","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn)","text":"Python<pre><code>import zlib\ndata = b\"hello hello hello\"\nc = zlib.compress(data)\nd = zlib.decompress(c)\nassert d == data\n</code></pre>"},{"location":"algorithms/compression/zlib/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> D\u00f9ng phi\u00ean b\u1ea3n zlib \u0111\u00e3 c\u1eadp nh\u1eadt.  </li> <li> Validate/parse header an to\u00e0n.  </li> <li> Gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc gi\u1ea3i n\u00e9n v\u00e0 t\u00e0i nguy\u00ean.  </li> <li> Ki\u1ec3m tra return codes v\u00e0 l\u1ed7i.  </li> <li> Ch\u1ea1y gi\u1ea3i n\u00e9n trong sandbox n\u1ebfu d\u1eef li\u1ec7u kh\u00f4ng tin c\u1eady.  </li> <li> D\u00f9ng HMAC/signature khi c\u1ea7n authenticity.  </li> <li> Th\u00eam test vectors (empty/repetitive/random/large).  </li> <li> Audit native bindings v\u00e0 memory handling.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o - RFC 1950 (zlib format), RFC 1951 (DEFLATE) - https://zlib.net/ - T\u00e0i li\u1ec7u CRC/Adler (RFCs, b\u00e0i b\u00e1o k\u1ef9 thu\u1eadt) - Hi\u1ec7n th\u1ef1c zlib (source code) \u2014 \u0111\u1ec3 audit c\u00e1c \u0111i\u1ec3m r\u1ee7i ro native.</p>"},{"location":"algorithms/compression/zlma/","title":"Zlma","text":""},{"location":"algorithms/compression/zlma/#zlma-filevault-context","title":"Zlma (Filevault context)","text":""},{"location":"algorithms/compression/zlma/#0-filevault-context","title":"0. Filevault context","text":"<p>M\u00f4 t\u1ea3: Zlma l\u00e0 bi\u1ebfn th\u1ec3 LZMA d\u00f9ng trong h\u1ec7 th\u1ed1ng Filevault \u0111\u1ec3 n\u00e9n d\u1eef li\u1ec7u l\u01b0u tr\u1eef/backup tr\u01b0\u1edbc khi (tu\u1ef3 ch\u1ecdn) m\u00e3 h\u00f3a. Y\u00eau c\u1ea7u: an to\u00e0n trong gi\u1ea3i n\u00e9n, gi\u1edbi h\u1ea1n t\u00e0i nguy\u00ean, auditability v\u00e0 test vectors cho d\u1eef li\u1ec7u kh\u00f4ng tin c\u1eady.</p>"},{"location":"algorithms/compression/zlma/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Zlma k\u1ebft h\u1ee3p LZ (dictionary-based matching) v\u00e0 range/arithmetic coder \u0111\u1ec3 \u0111\u1ea1t t\u1ef7 l\u1ec7 n\u00e9n g\u1ea7n entropy. M\u1ee5c ti\u00eau: gi\u1ea3m dung l\u01b0\u1ee3ng l\u01b0u tr\u1eef, t\u1ed1i \u01b0u t\u1ec9 l\u1ec7 cho file nh\u1ecb ph\u00e2n/text. Kh\u00f4ng cung c\u1ea5p confidentiality \u2014 ch\u1ec9 integrity s\u01a1 b\u1ed9 qua checksum; c\u1ea7n k\u1ebft h\u1ee3p MAC/cryptography \u0111\u1ec3 b\u1ea3o v\u1ec7 n\u1ed9i dung.</p>"},{"location":"algorithms/compression/zlma/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Entropy: \\(H(X) = -\\sum_x p(x)\\log_2 p(x)\\).  </li> <li>Gi\u1edbi h\u1ea1n n\u00e9n (k\u1ef3 v\u1ecdng): kh\u00f4ng th\u1ec3 th\u1ea5p h\u01a1n \\(H(X)\\).  </li> <li>T\u1ef7 l\u1ec7 n\u00e9n: \\(R = \\dfrac{|C|}{|O|}\\) (|C|: k\u00edch th\u01b0\u1edbc n\u00e9n, |O|: g\u1ed1c).  </li> <li>LZ references: d\u1eef li\u1ec7u bi\u1ec3u di\u1ec5n b\u1eb1ng c\u1eb7p (offset, length) khi xu\u1ea5t hi\u1ec7n match; benefit khi chu\u1ed7i l\u1eb7p l\u00e0m gi\u1ea3m \u0111\u1ed9 entropi hi\u1ec7u d\u1ee5ng.  </li> <li>Range coder/Arithmetic: m\u00e3 ho\u00e1 bit/bi\u1ec3u t\u01b0\u1ee3ng theo ph\u00e2n ph\u1ed1i x\u00e1c su\u1ea5t li\u00ean t\u1ee5c, ti\u1ebfn g\u1ea7n t\u1edbi entropy ngu\u1ed3n.</li> </ul>"},{"location":"algorithms/compression/zlma/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>Qu\u00e9t input b\u1eb1ng c\u1eeda s\u1ed5 tr\u01b0\u1ee3t.  </li> <li>T\u00ecm match d\u00e0i nh\u1ea5t (hash/chain ho\u1eb7c suffix structure).  </li> <li>N\u1ebfu match &gt;= MIN_MATCH: emit (offset,length); else emit literal.  </li> <li>S\u1eed d\u1ee5ng m\u00f4 h\u00ecnh ng\u1eef c\u1ea3nh (counters, state) \u0111\u1ec3 d\u1ef1 \u0111o\u00e1n bit/byte probabilities.  </li> <li>M\u00e3 ho\u00e1 lu\u1ed3ng b\u1eb1ng range coder; ghi header (properties, dict size) v\u00e0 checksum/footer.</li> </ul>"},{"location":"algorithms/compression/zlma/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Sliding window buffer (circular).  </li> <li>Hash table + chains cho t\u00ecm match nhanh.  </li> <li>(T\u00f9y ch\u1ecdn) Suffix array / trie cho match d\u00e0i h\u01a1n.  </li> <li>Context model: b\u1ea3ng counters, state machine, probability/price tables.  </li> <li>Output buffer, block header/footer, checksum/MAC slot.</li> </ul>"},{"location":"algorithms/compression/zlma/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>gzip/DEFLATE: nhanh h\u01a1n, t\u1ec9 l\u1ec7 th\u01b0\u1eddng k\u00e9m h\u01a1n v\u1edbi patterns d\u00e0i.  </li> <li>Zstd: t\u1ed1t c\u00e2n b\u1eb1ng t\u1ed1c \u0111\u1ed9/t\u1ec9 l\u1ec7; Zlma th\u01b0\u1eddng cho t\u1ec9 l\u1ec7 t\u1ed1t h\u01a1n nh\u01b0ng CPU/RAM cao h\u01a1n.  </li> <li>Brotli: t\u1ed1i \u01b0u cho web text; Zlma ph\u00f9 h\u1ee3p file l\u1edbn nh\u1ecb ph\u00e2n.  </li> <li>Trade-offs: t\u1ed1c \u0111\u1ed9 \u2194 t\u1ef7 l\u1ec7 \u2194 b\u1ed9 nh\u1edb.</li> </ul>"},{"location":"algorithms/compression/zlma/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-flow","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (flow)","text":"<ul> <li>Parse/validate header \u2192 Init structures \u2192 Loop parse block: t\u00ecm match/emit literal \u2192 update model \u2192 range encode \u2192 flush \u2192 write checksum. Mermaid: <pre><code>flowchart TD\n  A[Read header] --&gt; B{Valid?}\n  B -- Yes --&gt; C[Init structures]\n  C --&gt; D[While input]\n  D --&gt; E[Find match]\n  E --&gt; F{match &gt;= MIN}\n  F -- Yes --&gt; G[\"Emit (offset,len)\"]\n  F -- No --&gt; H[Emit literal]\n  G --&gt; I[Update models]\n  H --&gt; I\n  I --&gt; J[Range encode]\n  J --&gt; D\n  B -- No --&gt; K[Reject]\n  D --&gt; L[Flush &amp; write checksum]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  </li> </ul>"},{"location":"algorithms/compression/zlma/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc window/input \u2192 OOM.  </li> <li>Off-by-one d\u1eabn \u0111\u1ebfn overrun/underrun khi \u00e1p offset/length.  </li> <li>Kh\u00f4ng validate header/fiels \u2192 crash/undefined behavior.  </li> <li>Counters overflow/underflow trong model \u2192 decode mismatch.  </li> <li>Kh\u00f4ng ki\u1ec3m tra offset/length t\u1eeb stream \u2192 \u0111\u1ecdc ngo\u00e0i v\u00f9ng buffer.</li> </ul>"},{"location":"algorithms/compression/zlma/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Decompression bomb (DoS: CPU/RAM).  </li> <li>Malformed stream \u2192 memory corruption / RCE n\u1ebfu d\u00f9ng native unsafe APIs.  </li> <li>Crafted offsets/lengths \u2192 OOB reads/writes.  </li> <li>Tampering/bit-flip \u2192 integrity/denial or incorrect outputs.  </li> <li>Side-channels (timing) n\u1ebfu x\u1eed l\u00fd d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m.</li> </ul>"},{"location":"algorithms/compression/zlma/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Gi\u1edbi h\u1ea1n t\u00e0i nguy\u00ean: max input, max window, timeout CPU.  </li> <li>Strict validation header/fields tr\u01b0\u1edbc s\u1eed d\u1ee5ng.  </li> <li>Validate offset/length khi expand match.  </li> <li>D\u00f9ng API an to\u00e0n (checked arithmetic, bounds-checked reads).  </li> <li>Sandbox/privilege separation cho decompression.  </li> <li>S\u1eed d\u1ee5ng checksum + MAC/Signature \u0111\u1ec3 b\u1ea3o v\u1ec7 integrity/authenticity.  </li> <li>Throttling/quotas cho requests nhi\u1ec1u lu\u1ed3ng.</li> </ul>"},{"location":"algorithms/compression/zlma/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Empty: \"\" \u2192 round-trip.  </li> <li>Short literals: \"abc\", \"Hello, world!\"  </li> <li>Repetition: \"A\" * 10000 \u2192 check high compression.  </li> <li>Structured: repeated JSON fields.  </li> <li>Random: 1 MB random \u2192 compressed \u2248 original or slightly l\u1edbn h\u01a1n.  </li> <li>Malformed: header n\u00f3i k\u00edch th\u01b0\u1edbc l\u1edbn nh\u01b0ng stream ng\u1eafn \u2192 decoder ph\u1ea3i t\u1eeb ch\u1ed1i.  </li> <li>Stress: many small streams, long runs to detect OOM/CPU spikes. Ki\u1ec3m tra: decompress(compress(input)) == input; resource limits respected; malformed rejected.</li> </ul> <ol> <li>Code (skeleton, pseudocode) C<pre><code>// skeleton\ninit_state(props);\nwhile(read_block(in)) {\n  while(has_input()){\n    match = find_longest_match(window, lookahead);\n    if(match.length &gt;= MIN_MATCH) emit_match(match);\n    else emit_literal(next_byte());\n    update_models(...);\n    range_encode(bitstream, model);\n  }\n}\nwrite_footer(checksum);\n</code></pre></li> </ol>"},{"location":"algorithms/compression/zlma/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Gi\u1edbi h\u1ea1n input/block/window v\u00e0 timeouts  </li> <li> Validate t\u1ea5t c\u1ea3 tr\u01b0\u1eddng header tr\u01b0\u1edbc x\u1eed l\u00fd  </li> <li> Ki\u1ec3m tra overflow/underflow cho offset/length  </li> <li> D\u00f9ng checked arithmetic v\u00e0 API an to\u00e0n  </li> <li> Th\u1ef1c thi trong sandbox/process ri\u00eang v\u1edbi data kh\u00f4ng tin c\u1eady  </li> <li> Th\u00eam checksum + MAC/Signature cho integrity/authenticity  </li> <li> Unit/integration tests (round-trip, malformed, stress)  </li> <li> Review/scan m\u00e3 (ASAN, UBSAN, fuzzing, SAST)</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o (ch\u1ecdn l\u1ecdc) - RFC 1951 DEFLATE: https://www.ietf.org/rfc/rfc1951.txt - LZ77/LZMA overview: https://en.wikipedia.org/wiki/LZ77 , https://www.7-zip.org - Range coding overview: https://en.wikipedia.org/wiki/Arithmetic_coding - Practical robustness: OWASP and librosa/OSS hardening guides.</p>"},{"location":"algorithms/hash/blake2/","title":"BLAKE2","text":""},{"location":"algorithms/hash/blake2/#blake2","title":"BLAKE2","text":""},{"location":"algorithms/hash/blake2/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>BLAKE2 l\u00e0 h\u1ecd h\u00e0m b\u0103m m\u1eadt m\u00e3 nhanh, an to\u00e0n (h\u1eadu du\u1ec7 c\u1ee7a BLAKE). M\u1ee5c ti\u00eau: thay th\u1ebf SHA-2/SHA-3 cho checksum, MAC, KDF, v\u00e0 hash table v\u1edbi t\u1ed1c \u0111\u1ed9 cao. B\u1ea3o v\u1ec7 t\u00ednh to\u00e0n v\u1eb9n d\u1eef li\u1ec7u, ch\u1ed1ng va ch\u1ea1m (collision resistance), ch\u1ed1ng preimage; h\u1ed7 tr\u1ee3 keyed hashing \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o t\u00ednh x\u00e1c th\u1ef1c.</p>"},{"location":"algorithms/hash/blake2/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c-t\u00f3m-t\u1eaft","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c (t\u00f3m t\u1eaft)","text":""},{"location":"algorithms/hash/blake2/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>Init: t\u1ea1o vector tr\u1ea1ng th\u00e1i h t\u1eeb IV v\u00e0 tham s\u1ed1 (key, outlen, fanout,\u2026).</li> <li>X\u1eed l\u00fd kh\u1ed1i: chia message th\u00e0nh kh\u1ed1i k\u00edch th\u01b0\u1edbc B (64/128 bytes), c\u1eadp nh\u1eadt counter t, g\u1ecdi compression F cho m\u1ed7i kh\u1ed1i.</li> <li>Finalize: x\u1eed l\u00fd kh\u1ed1i cu\u1ed1i v\u1edbi flag final, xu\u1ea5t digest length bytes t\u1eeb h.</li> </ul>"},{"location":"algorithms/hash/blake2/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Tr\u1ea1ng th\u00e1i n\u1ed9i b\u1ed9: h (8 t\u1eeb), v (16 t\u1eeb t\u1ea1m), m (16 t\u1eeb message block).</li> <li>Tham s\u1ed1 c\u1ea5u h\u00ecnh (param block): digest_length, key_length, fanout, depth, leaf_length, node_offset, node_depth, inner_length, salt, personal.</li> <li>Counter t: 128-bit (hai t\u1eeb) \u0111\u1ebfm t\u1ed5ng s\u1ed1 byte \u0111\u00e3 x\u1eed l\u00fd.</li> </ul>"},{"location":"algorithms/hash/blake2/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi MD5/SHA-1: an to\u00e0n h\u01a1n, kh\u00f4ng y\u1ebfu v\u1ec1 va ch\u1ea1m.</li> <li>So v\u1edbi SHA-2: th\u01b0\u1eddng nhanh h\u01a1n tr\u00ean CPU hi\u1ec7n \u0111\u1ea1i; b\u1ea3o m\u1eadt t\u01b0\u01a1ng \u0111\u01b0\u01a1ng cho m\u1ee5c \u0111\u00edch chung.</li> <li>So v\u1edbi SHA-3: thi\u1ebft k\u1ebf kh\u00e1c (sponge vs HAIFA-like); th\u01b0\u1eddng BLAKE2 nhanh h\u01a1n cho nhi\u1ec1u \u1ee9ng d\u1ee5ng.</li> <li>H\u1ed7 tr\u1ee3 keyed hashing tr\u1ef1c ti\u1ebfp (kh\u00f4ng c\u1ea7n HMAC) n\u00ean ti\u1ec7n cho MAC/KDF.</li> </ul>"},{"location":"algorithms/hash/blake2/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-flow","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (flow)","text":"<ol> <li>Kh\u1edfi t\u1ea1o h v\u1edbi IV v\u00e0 tham s\u1ed1.</li> <li>N\u1ebfu c\u00f3 key, pad key th\u00e0nh m\u1ed9t kh\u1ed1i \u0111\u1ea7u.</li> <li>L\u1eb7p: \u0111\u1ecdc kh\u1ed1i message, t\u0103ng counter t, g\u1ecdi compression F.</li> <li>\u1ede kh\u1ed1i cu\u1ed1i \u0111\u1eb7t final flag, g\u1ecdi F.</li> <li>Tr\u00edch xu\u1ea5t digest t\u1eeb h.</li> </ol> <pre><code>flowchart TD\n    A[\"Kh\u1edfi t\u1ea1o h (IV + param block)\"] --&gt; B{C\u00f3 key?}\n    B -- C\u00f3 --&gt; C[Pad key th\u00e0nh 1 block; x\u1eed l\u00fd block key]\n    B -- Kh\u00f4ng --&gt; D[Ti\u1ebfp t\u1ee5c \u0111\u1ecdc message]\n    C --&gt; D\n    D --&gt; E[\u0110\u1ecdc kh\u1ed1i message]\n    E --&gt; F[C\u1eadp nh\u1eadt counter t]\n    F --&gt; G[\"Compress F(h, m, t, final=false)\"]\n    G --&gt; H{C\u00f2n kh\u1ed1i?}\n    H -- C\u00f3 --&gt; E\n    H -- Kh\u00f4ng --&gt; I[\u0110\u1eb7t final flag]\n    I --&gt; J[\"Compress cu\u1ed1i c\u00f9ng F(..., final=true)\"]\n    J --&gt; K[\"Tr\u00edch xu\u1ea5t digest (truncate theo outlen)\"]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <pre><code>graph LR\n    h[\"State h (8 words)\"] --&gt; v[\"v = h || IV\"]\n    m[\"Message m (16 words)\"] --&gt; v\n    t[\"Counter t (128-bit)\"] --&gt; v\n    f[Final flag] --&gt; v\n    v --&gt; rounds[\"G rounds (mixing, \u03c3 permutation)\"]\n    rounds --&gt; h2[\"h' = h xor (v0..7 xor v8..15)\"]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/hash/blake2/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Sai k\u00edch th\u01b0\u1edbc t\u1eeb (d\u00f9ng 32-bit/64-bit kh\u00f4ng \u0111\u00fang bi\u1ebfn th\u1ec3).</li> <li>Kh\u00f4ng x\u1eed l\u00fd \u0111\u00fang counter 128-bit khi t\u1ed5ng bytes v\u01b0\u1ee3t qu\u00e1 2^64.</li> <li>B\u1ecf qu\u00ean finalization flag \u2192 digest sai ho\u1eb7c k\u00e9m an to\u00e0n.</li> <li>Kh\u00f4ng l\u00e0m r\u00f5 padding cho key ho\u1eb7c x\u1eed l\u00fd key nh\u01b0 d\u1eef li\u1ec7u b\u00ecnh th\u01b0\u1eddng.</li> <li>Implement non-constant-time cho thao t\u00e1c li\u00ean quan \u0111\u1ebfn key \u2192 r\u00f2 r\u1ec9 th\u00f4ng tin.</li> </ul>"},{"location":"algorithms/hash/blake2/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Threats: collision attacks, preimage attacks, length-extension (BLAKE2 kh\u00f4ng m\u1eafc length-extension trong ch\u1ebf \u0111\u1ed9 keyed), side-channel (timing, cache), chosen-prefix.</li> <li>Kh\u1ea3 n\u0103ng t\u1ea5n c\u00f4ng th\u1ef1c t\u1ebf ph\u1ee5 thu\u1ed9c bi\u1ebfn th\u1ec3, \u0111\u1ed9 d\u00e0i digest, v\u00e0 c\u00e1ch d\u00f9ng (keystore, KDF, streaming).</li> </ul>"},{"location":"algorithms/hash/blake2/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>D\u00f9ng digest \u0111\u1ee7 d\u00e0i (&gt;= 256 bit cho b\u1ea3o m\u1eadt d\u00e0i h\u1ea1n).</li> <li>D\u00f9ng ch\u1ebf \u0111\u1ed9 keyed ho\u1eb7c d\u00f9ng HMAC-like construction khi c\u1ea7n authenticate.</li> <li>B\u1ea3o v\u1ec7 implementation kh\u1ecfi side-channel: constant-time cho thao t\u00e1c li\u00ean quan key, tr\u00e1nh branch ph\u1ee5 thu\u1ed9c key.</li> <li>Ki\u1ec3m so\u00e1t input size v\u00e0 x\u1eed l\u00fd counter \u0111\u00fang.</li> <li>D\u00f9ng th\u01b0 vi\u1ec7n ch\u00ednh th\u1ee9c \u0111\u01b0\u1ee3c review, kh\u00f4ng t\u1ef1 tri\u1ec3n khai n\u1ebfu kh\u00f4ng c\u1ea7n thi\u1ebft.</li> </ul>"},{"location":"algorithms/hash/blake2/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>S\u1eed d\u1ee5ng RFC 7693 v\u00e0 b\u1ea3n vi\u1ebft t\u1eaft ch\u00ednh th\u1ee9c \u0111\u1ec3 ki\u1ec3m tra: t\u1ea1o test cases cho empty, short ASCII, long stream, keyed mode, personalization/salt.</li> <li>V\u00ed d\u1ee5 ki\u1ec3m tra c\u01a1 b\u1ea3n (ki\u1ec3m tra t\u1ef1 \u0111\u1ed9ng v\u1edbi reference implementation):<ul> <li>empty string \u2192 compare digest v\u1edbi vector tham chi\u1ebfu.</li> <li>\"abc\" \u2192 compare v\u1edbi vector tham chi\u1ebfu.</li> <li>keyed(\"key\", \"message\") \u2192 compare. (T\u00e0i li\u1ec7u ch\u00ednh th\u1ee9c ch\u1ee9a b\u1ea3ng gi\u00e1 tr\u1ecb hex chi ti\u1ebft \u2014 lu\u00f4n d\u00f9ng vector RFC/implementation \u0111\u1ec3 ki\u1ec3m tra.)</li> </ul> </li> </ul>"},{"location":"algorithms/hash/blake2/#11-code-b\u1ecf-qua-c\u0169ng-\u0111\u01b0\u1ee3c","title":"11. Code (b\u1ecf qua c\u0169ng \u0111\u01b0\u1ee3c)","text":"<ul> <li>Khuy\u1ebfn ngh\u1ecb: s\u1eed d\u1ee5ng implementation \u0111\u00e3 \u0111\u01b0\u1ee3c audit (libsodium, BLAKE2 reference C, OpenSSL 1.1+/libcrypto n\u1ebfu h\u1ed7 tr\u1ee3).</li> <li>N\u1ebfu c\u1ea7n minimal pseudocode:<ul> <li>init(h, param)</li> <li>for each block B: t += len(B); compress(h, B, t, final=false)</li> <li>compress last block with final=true</li> <li>return truncate(h, digest_len)</li> </ul> </li> </ul>"},{"location":"algorithms/hash/blake2/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> D\u00f9ng bi\u1ebfn th\u1ec3 ph\u00f9 h\u1ee3p (BLAKE2b cho 64-bit, BLAKE2s cho 32-bit).</li> <li> Ch\u1ecdn digest length \u0111\u1ee7 l\u1edbn.</li> <li> S\u1eed d\u1ee5ng implementation \u0111\u00e3 audit ho\u1eb7c ch\u00ednh th\u1ee9c.</li> <li> X\u1eed l\u00fd key v\u00e0 param \u0111\u00fang (padding, param block).</li> <li> Ki\u1ec3m tra test vectors (RFC 7693).</li> <li> B\u1ea3o v\u1ec7 kh\u1ecfi side-channel n\u1ebfu d\u00f9ng key.</li> <li> Ki\u1ec3m so\u00e1t k\u00edch th\u01b0\u1edbc input v\u00e0 counter overflow.</li> <li> \u0110\u0103ng k\u00fd/ghi nh\u1eadn personalization/salt khi c\u1ea7n \u0111\u1ec3 tr\u00e1nh collision qua s\u1eed d\u1ee5ng chung.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o chu\u1ea9n: RFC 7693 (BLAKE2) v\u00e0 implementation ch\u00ednh th\u1ee9c \u0111\u1ec3 test v\u00e0 test vectors.</p>"},{"location":"algorithms/hash/blake2/#13-\u0111\u1eb7c-\u0111i\u1ec3m-v\u00e0-bi\u1ebfn-th\u1ec3","title":"13. \u0110\u1eb7c \u0111i\u1ec3m v\u00e0 bi\u1ebfn th\u1ec3","text":"<ul> <li>\u0110\u1eb7c \u0111i\u1ec3m ch\u00ednh:<ul> <li>R\u1ea5t nhanh tr\u00ean CPU hi\u1ec7n \u0111\u1ea1i; thi\u1ebft k\u1ebf t\u1ed1i \u01b0u cho c\u00e1c ISA 64-bit/32-bit.</li> <li>H\u1ed7 tr\u1ee3 keyed hashing (MAC), personalization, salt, v\u00e0 output length bi\u1ebfn thi\u00ean.</li> <li>An to\u00e0n theo c\u00e1c thu\u1ed9c t\u00ednh m\u1eadt m\u00e3 ti\u00eau chu\u1ea9n (collision/preimage) v\u1edbi m\u1ee9c b\u1ea3o m\u1eadt ph\u1ee5 thu\u1ed9c digest length.</li> <li>Thi\u1ebft k\u1ebf m\u00f4-\u0111un: compression function nh\u1eb9, d\u1ec5 streaming v\u00e0 incremental.</li> <li>Kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o c\u1ea5u tr\u00fac sponge \u2192 kh\u00e1c v\u1edbi SHA\u20113; kh\u00f4ng c\u1ea7n HMAC khi d\u00f9ng keyed mode.</li> </ul> </li> <li>Bi\u1ebfn th\u1ec3 ti\u00eau bi\u1ec3u:<ul> <li>BLAKE2b: cho h\u1ec7 64-bit, digest t\u1ed1i \u0111a 64 bytes (512 bit), t\u1ed1i \u01b0u cho server/desktop.</li> <li>BLAKE2s: cho h\u1ec7 32-bit/nh\u00fang, digest t\u1ed1i \u0111a 32 bytes (256 bit).</li> <li>BLAKE2bp / BLAKE2sp: bi\u1ebfn th\u1ec3 \u0111a lu\u1ed3ng (parallel) d\u00f9ng tree hashing \u0111\u1ec3 t\u1eadn d\u1ee5ng nhi\u1ec1u l\u00f5i.</li> <li>BLAKE2X: ch\u1ebf \u0111\u1ed9 extendable-output (t\u1ea1o lu\u1ed3ng d\u00e0i output) d\u1ef1a tr\u00ean BLAKE2.</li> <li>(L\u01b0u \u00fd) BLAKE3 l\u00e0 h\u1ecd ti\u1ebfp theo v\u1edbi thi\u1ebft k\u1ebf kh\u00e1c (sinh parallel m\u1ea1nh h\u01a1n) \u2014 kh\u00f4ng ph\u1ea3i bi\u1ebfn th\u1ec3 tr\u1ef1c ti\u1ebfp c\u1ee7a BLAKE2.</li> </ul> </li> <li>C\u00e1c t\u00ednh n\u0103ng tri\u1ec3n khai:<ul> <li>Tree hashing cho d\u1eef li\u1ec7u l\u1edbn / parallel processing.</li> <li>Param block cho c\u1ea5u h\u00ecnh (personalization, salt, fanout, depth, \u2026).</li> <li>H\u1ed7 tr\u1ee3 incremental API, streaming v\u00e0 keyed API.</li> </ul> </li> </ul>"},{"location":"algorithms/hash/blake2/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>Ki\u1ec3m tra t\u00ednh to\u00e0n v\u1eb9n d\u1eef li\u1ec7u: checksums, file integrity, deduplication.</li> <li>MAC / authentication: thay th\u1ebf HMAC trong nhi\u1ec1u tr\u01b0\u1eddng h\u1ee3p b\u1eb1ng keyed BLAKE2.</li> <li>KDF/PRF: d\u00f9ng l\u00e0m th\u00e0nh ph\u1ea7n trong KDF/HKDF ho\u1eb7c PRF; l\u01b0u \u00fd c\u1ea7n thi\u1ebft k\u1ebf KDF \u0111\u00fang ti\u00eau chu\u1ea9n n\u1ebfu d\u00f9ng cho m\u1eadt kh\u1ea9u.</li> <li>Content-addressed storage v\u00e0 hash-based IDs (v\u00ed d\u1ee5: h\u1ec7 th\u1ed1ng l\u01b0u tr\u1eef, cache, dedupe).</li> <li>Signatures / certificates: l\u00e0m hash \u0111\u1ea7u v\u00e0o cho ch\u1eef k\u00fd s\u1ed1.</li> <li>Network protocols v\u00e0 TLS extensions, file formats, container checksums \u2014 n\u01a1i c\u1ea7n hash nhanh v\u00e0 an to\u00e0n.</li> <li>Embedded/IoT: BLAKE2s ph\u00f9 h\u1ee3p cho thi\u1ebft b\u1ecb 32-bit.</li> <li>Kh\u00f4ng khuy\u1ebfn ngh\u1ecb d\u00f9ng BLAKE2 nh\u01b0 thay th\u1ebf password hash chuy\u00ean d\u1ee5ng (d\u00f9ng Argon2/Bcrypt/scrypt cho m\u1eadt kh\u1ea9u).</li> <li>L\u1ee3i \u00edch th\u1ef1c t\u1ebf: l\u1ef1a ch\u1ecdn bi\u1ebfn th\u1ec3 theo m\u00f4i tr\u01b0\u1eddng (BLAKE2b cho server, BLAKE2s cho nh\u00fang, BLAKE2bp/sp cho \u0111a l\u00f5i).</li> <li>Th\u1ef1c t\u1ebf: \u01b0u ti\u00ean libraries \u0111\u00e3 audit (libsodium, reference impl., OpenSSL n\u1ebfu h\u1ed7 tr\u1ee3) thay v\u00ec t\u1ef1 tri\u1ec3n khai.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o: RFC 7693 v\u00e0 t\u00e0i li\u1ec7u implementation cho t\u1eebng bi\u1ebfn th\u1ec3.</p>"},{"location":"algorithms/hash/md5/","title":"Md5","text":""},{"location":"algorithms/hash/md5/#0-filevault-context","title":"0. Filevault context","text":"<p>Filevault docs: m\u00f4 t\u1ea3 ng\u1eafn MD5, nh\u1ea5n m\u1ea1nh r\u1ee7i ro b\u1ea3o m\u1eadt, khuy\u1ebfn ngh\u1ecb thay th\u1ebf (SHA-\u2154, BLAKE\u2154). D\u00f9ng \u0111\u1ec3 ph\u1ee5c v\u1ee5 t\u00e0i li\u1ec7u k\u1ef9 thu\u1eadt, test vectors v\u00e0 chuy\u1ec3n \u0111\u1ed5i legacy; kh\u00f4ng khuy\u1ebfn kh\u00edch d\u00f9ng cho b\u1ea3o m\u1eadt.</p>"},{"location":"algorithms/hash/md5/#1-kh\u00e1i-ni\u1ec7m-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-b\u1ea3o-v\u1ec7-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1, b\u1ea3o v\u1ec7 g\u00ec","text":"<p>MD5 l\u00e0 h\u00e0m b\u0103m m\u1eadt m\u00e3 sinh digest 128\u2011bit t\u1eeb d\u1eef li\u1ec7u b\u1ea5t k\u1ef3. M\u1ee5c \u0111\u00edch ch\u00ednh: ki\u1ec3m tra t\u00ednh to\u00e0n v\u1eb9n (checksum) v\u00e0 nh\u1eadn d\u1ea1ng d\u1eef li\u1ec7u, kh\u00f4ng b\u1ea3o v\u1ec7 ch\u1ed1ng collision hi\u1ec7n \u0111\u1ea1i hay l\u00e0m kh\u00f3a/m\u1eadt kh\u1ea9u/ ch\u1eef k\u00fd.</p>"},{"location":"algorithms/hash/md5/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c-s\u1eed-d\u1ee5ng-math-markdown","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c (s\u1eed d\u1ee5ng math markdown)","text":""},{"location":"algorithms/hash/md5/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ul> <li>Padding: th\u00eam bit 1, r\u1ed3i 0 \u0111\u1ebfn khi \u0111\u1ed9 d\u00e0i \u2261 448 mod 512, sau \u0111\u00f3 th\u00eam 64\u2011bit bi\u1ec3u di\u1ec5n \u0111\u1ed9 d\u00e0i ban \u0111\u1ea7u (little\u2011endian).  </li> <li>Chia message th\u00e0nh kh\u1ed1i 512\u2011bit.  </li> <li>Kh\u1edfi t\u1ea1o 4 thanh ghi 32\u2011bit c\u1ed1 \u0111\u1ecbnh.  </li> <li>V\u1edbi m\u1ed7i kh\u1ed1i: th\u1ef1c hi\u1ec7n 64 b\u01b0\u1edbc (4 v\u00f2ng \u00d7 16 b\u01b0\u1edbc) c\u1eadp nh\u1eadt A,B,C,D theo h\u00e0m F/G/H/I.  </li> <li>K\u1ebft h\u1ee3p A,B,C,D cho digest 128\u2011bit.</li> </ul>"},{"location":"algorithms/hash/md5/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Block input: 512\u2011bit = 16 \u00d7 32\u2011bit words \\(M[0..15]\\).  </li> <li>State: 4 \u00d7 32\u2011bit registers \\((A,B,C,D)\\).  </li> <li>B\u1ea3ng: \\(K[0..63]\\), \\(s[0..63]\\).  </li> <li>Padding ch\u1ee9a \u0111\u1ed9 d\u00e0i g\u1ed1c 64\u2011bit.</li> </ul>"},{"location":"algorithms/hash/md5/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>SHA\u20111: d\u00e0i h\u01a1n, an to\u00e0n h\u01a1n MD5 nh\u01b0ng \u0111\u00e3 c\u00f3 collision th\u1ef1c t\u1ebf.  </li> <li>SHA\u2011256 / SHA\u20113: digest 256\u2011bit, kh\u00e1ng collision/preimage m\u1ea1nh h\u01a1n; d\u00f9ng cho h\u1ea7u h\u1ebft m\u1ee5c \u0111\u00edch b\u1ea3o m\u1eadt.  </li> <li>BLAKE2/BLAKE3: nhanh h\u01a1n v\u00e0 an to\u00e0n h\u01a1n MD5, ph\u00f9 h\u1ee3p thay th\u1ebf cho hashing kh\u00f4ng\u2011tr\u1ecdng y\u1ebfu. K\u1ebft lu\u1eadn: MD5 nhanh nh\u01b0ng y\u1ebfu v\u1ec1 b\u1ea3o m\u1eadt; tr\u00e1nh d\u00f9ng cho t\u00ednh n\u0103ng b\u1ea3o m\u1eadt.</li> </ul>"},{"location":"algorithms/hash/md5/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-flow","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (flow)","text":"<ul> <li>Input -&gt; Padding -&gt; Split into 512\u2011bit blocks -&gt; Init state (A,B,C,D) -&gt; For each block: prepare M[0..15], 64 rounds update -&gt; Output digest.</li> </ul> <p>Mermaid sequence (flowchart): </p> <pre><code>flowchart LR\n    I[Input] --&gt; P[Padding]\n    P --&gt; B[\"Blocks (512-bit)\"]\n    B --&gt; S[Init A,B,C,D]\n    S --&gt; R[For each block: 64 rounds]\n    R --&gt; O[\"Output digest (128-bit)\"]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/hash/md5/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng MD5 cho m\u1eadt kh\u1ea9u, token, ch\u1eef k\u00fd.  </li> <li>Implement padding/endianness sai.  </li> <li>S\u1eed d\u1ee5ng \u0111\u1ea7u ra MD5 tr\u1ef1c ti\u1ebfp l\u00e0m kh\u00f3a m\u1eadt m\u00e3.  </li> <li>T\u1ef1 tri\u1ec3n khai cryptographic primitives thay v\u00ec d\u00f9ng th\u01b0 vi\u1ec7n \u0111\u00e3 \u0111\u01b0\u1ee3c ki\u1ec3m \u0111\u1ecbnh.</li> </ul>"},{"location":"algorithms/hash/md5/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Attacker c\u00f3 kh\u1ea3 n\u0103ng t\u1ea1o collision (t\u1ea1o hai input kh\u00e1c nhau c\u00f3 c\u00f9ng MD5) =&gt; gi\u1ea3 m\u1ea1o file, bypass checksum.  </li> <li>Kh\u00f4ng tin c\u1eady MD5 \u0111\u1ec3 ch\u1ed1ng preimage n\u1ebfu attacker c\u00f3 ngu\u1ed3n l\u1ef1c l\u1edbn.  </li> <li>Threat surface: file distribution, backups, artifact verification, legacy APIs.</li> </ul>"},{"location":"algorithms/hash/md5/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Kh\u00f4ng d\u00f9ng MD5 cho b\u1ea3o m\u1eadt; thay b\u1eb1ng SHA\u2011256/SHA\u20113/BLAKE2.  </li> <li>V\u1edbi legacy: c\u00f4 l\u1eadp scope, chuy\u1ec3n sang HMAC\u2011SHA256 n\u1ebfu c\u1ea7n x\u00e1c th\u1ef1c. Tr\u00e1nh HMAC\u2011MD5 tr\u1eeb khi t\u01b0\u01a1ng th\u00edch b\u1eaft bu\u1ed9c.  </li> <li>Ki\u1ec3m tra v\u00e0 s\u1eeda l\u1ed7i padding/endianness, d\u00f9ng th\u01b0 vi\u1ec7n \u0111\u01b0\u1ee3c duy tr\u00ec.  </li> <li>D\u00f9ng ch\u1eef k\u00fd s\u1ed1/TLS v\u00e0 c\u00f4ng khai ngu\u1ed3n tin \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o integrity/ authenticity.  </li> <li>Th\u00eam test vectors v\u00e0 CI checks \u0111\u1ec3 ph\u00e1t hi\u1ec7n regressions.</li> </ul>"},{"location":"algorithms/hash/md5/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>\"\" \u2192 d41d8cd98f00b204e9800998ecf8427e  </li> <li>\"a\" \u2192 0cc175b9c0f1b6a831c399e269772661  </li> <li>\"abc\" \u2192 900150983cd24fb0d6963f7d28e17f72  </li> <li>\"message digest\" \u2192 f96b697d7cb7938d525a2f31aaf161d0  </li> <li>\"abcdefghijklmnopqrstuvwxyz\" \u2192 c3fcd3d76192e4007dfb496cca67e13b</li> </ul>"},{"location":"algorithms/hash/md5/#11-code-v\u00ed-d\u1ee5-ng\u1eafn","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn)","text":"<p>Python: </p>Python<pre><code>import hashlib\nhashlib.md5(b\"abc\").hexdigest()  # -&gt; 900150983cd24fb0d6963f7d28e17f72\n</code></pre><p></p>"},{"location":"algorithms/hash/md5/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Kh\u00f4ng d\u00f9ng MD5 cho m\u1eadt kh\u1ea9u/kh\u00f3a/ch\u1eef k\u00fd.  </li> <li> N\u1ebfu c\u00f2n d\u00f9ng v\u00ec t\u01b0\u01a1ng th\u00edch, h\u1ea1n ch\u1ebf scope v\u00e0 \u0111\u00e1nh gi\u00e1 r\u1ee7i ro.  </li> <li> Thay HMAC\u2011MD5 b\u1eb1ng HMAC\u2011SHA256 khi c\u00f3 th\u1ec3.  </li> <li> D\u00f9ng th\u01b0 vi\u1ec7n \u0111\u00e3 \u0111\u01b0\u1ee3c duy tr\u00ec, c\u1eadp nh\u1eadt CVE.  </li> <li> Th\u00eam test vectors v\u00e0o CI.  </li> <li> Ki\u1ec3m tra padding v\u00e0 endianness khi implement.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o (khuy\u1ebfn ngh\u1ecb) - RFC 1321 \u2014 The MD5 Message\u2011Digest Algorithm - NIST guidance / migration recommendations - Th\u01b0 vi\u1ec7n ti\u00eau chu\u1ea9n (OpenSSL, hashlib, libsodium) \u0111\u1ec3 tham kh\u1ea3o API v\u00e0 v\u00ed d\u1ee5.</p>"},{"location":"algorithms/hash/sha1/","title":"Sha1","text":""},{"location":"algorithms/hash/sha1/#0-filevault-context","title":"0. Filevault context","text":"<p>T\u00e0i li\u1ec7u m\u00f4 t\u1ea3 thu\u1eadt to\u00e1n SHA\u20111 (ch\u00fa \u00fd: SHA\u20111 \u0111\u00e3 b\u1ecb coi l\u00e0 y\u1ebfu; ch\u1ec9 d\u00f9ng cho compatibility/legacy).</p>"},{"location":"algorithms/hash/sha1/#1-kh\u00e1i-ni\u1ec7m","title":"1. Kh\u00e1i ni\u1ec7m","text":"<p>SHA\u20111 l\u00e0 h\u00e0m b\u0103m m\u1eadt m\u00e3 t\u1ea1o gi\u00e1 tr\u1ecb b\u0103m 160\u2011bit t\u1eeb d\u1eef li\u1ec7u tu\u1ef3 \u00fd. Gi\u1ea3i quy\u1ebft: \u0111\u1ea3m b\u1ea3o t\u00ednh to\u00e0n v\u1eb9n d\u1eef li\u1ec7u (integrity), nh\u1eadn d\u1ea1ng d\u1eef li\u1ec7u; KH\u00d4NG b\u1ea3o \u0111\u1ea3m ch\u1ed1ng gi\u1ea3 m\u1ea1o n\u1ebfu d\u00f9ng tr\u1ef1c ti\u1ebfp l\u00e0m MAC. B\u1ea3o v\u1ec7: ph\u00e1t hi\u1ec7n s\u1eeda \u0111\u1ed5i d\u1eef li\u1ec7u, ki\u1ec3m tra \u0111\u1ed3ng nh\u1ea5t.</p>"},{"location":"algorithms/hash/sha1/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/hash/sha1/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ol> <li>Padding message t\u1edbi b\u1ed9i s\u1ed1 512 bit.</li> <li>Chia th\u00e0nh kh\u1ed1i 512\u2011bit; m\u1ed7i kh\u1ed1i th\u00e0nh 16 words 32\u2011bit.</li> <li>M\u1edf r\u1ed9ng m\u1ed7i kh\u1ed1i th\u00e0nh 80 words.</li> <li>Kh\u1edfi t\u1ea1o a..e = H0..H4; l\u1eb7p 80 v\u00f2ng c\u1eadp nh\u1eadt theo ft, Kt.</li> <li>Sau m\u1ed7i kh\u1ed1i, c\u1ed9ng tr\u1edf l\u1ea1i v\u00e0o H0..H4.</li> <li>K\u1ebft qu\u1ea3: n\u1ed1i H0..H4 (big\u2011endian) t\u1ea1o digest 160\u2011bit.</li> </ol>"},{"location":"algorithms/hash/sha1/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Input block: 512 bit</li> <li>Word: 32\u2011bit unsigned integers</li> <li>State: 5 \u00d7 32\u2011bit (H0..H4)</li> <li>W array: 80 \u00d7 32\u2011bit</li> <li>Endianness: x\u1eed l\u00fd theo big\u2011endian khi ghi/\u0111\u1ecdc bytes v\u00e0o words.</li> </ul>"},{"location":"algorithms/hash/sha1/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>MD5: output 128\u2011bit, c\u0169ng broken; SHA\u20111 d\u00e0i h\u01a1n (160\u2011bit) nh\u01b0ng hi\u1ec7n v\u1eabn b\u1ecb t\u1ea5n c\u00f4ng collision.</li> <li>SHA\u20112 family (SHA\u2011256, SHA\u2011512): hi\u1ec7n an to\u00e0n h\u01a1n, kh\u00e1c thi\u1ebft k\u1ebf, khuy\u1ebfn ngh\u1ecb chuy\u1ec3n \u0111\u1ed5i.</li> <li>SHA\u20113: kh\u00e1c thi\u1ebft k\u1ebf (sponge), kh\u00f4ng ch\u1ecbu c\u00e1c l\u1edbp t\u1ea5n c\u00f4ng t\u01b0\u01a1ng t\u1ef1.</li> </ul>"},{"location":"algorithms/hash/sha1/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-flow","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (flow)","text":"<pre><code>flowchart LR\n    M[Message] --&gt; Pad[Padding]\n    Pad --&gt; Split[512-bit Blocks]\n    Split --&gt; ForEach[For each block]\n    ForEach --&gt; Expand[Expand W0..W79]\n    Expand --&gt; Compress[\"Compression (80 rounds)\"]\n    Compress --&gt; Update[Update H0..H4]\n    Update --&gt; End[Digest H0..H4]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/hash/sha1/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Sai endianness khi chuy\u1ec3n byte\u2194word.</li> <li>Kh\u00f4ng \u00e1p d\u1ee5ng padding \u0111\u00fang (\u0111\u1ed9 d\u00e0i 64\u2011bit).</li> <li>D\u00f9ng SHA\u20111 l\u00e0m MAC thay v\u00ec HMAC \u2192 d\u1ec5 b\u1ecb t\u1ea5n c\u00f4ng length\u2011extension.</li> <li>C\u1eaft output (truncation) m\u00e0 kh\u00f4ng \u0111\u00e1nh gi\u00e1 r\u1ee7i ro.</li> <li>Reuse state gi\u1eefa message kh\u00f4ng t\u00e1ch r\u00f5 r\u00e0ng.</li> </ul>"},{"location":"algorithms/hash/sha1/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 kh\u1ea3 n\u0103ng t\u1ea1o va ch\u1ea1m (collision) trong SHA\u20111 \u2014 t\u1ea5n c\u00f4ng th\u1ef1c t\u1ebf \u0111\u00e3 \u0111\u01b0\u1ee3c demo.</li> <li>Threats: collision forging, chosen\u2011prefix collision (\u0111\u00e1nh l\u1eeba h\u1ec7 th\u1ed1ng ch\u1ea5p nh\u1eadn file kh\u00e1c), length\u2011extension khi d\u00f9ng \u0111\u1ec3 l\u00e0m MAC.</li> <li>M\u00f4i tr\u01b0\u1eddng: h\u1ec7 th\u1ed1ng ch\u1eef k\u00fd s\u1ed1, ki\u1ec3m tra integrity, provenance.</li> </ul>"},{"location":"algorithms/hash/sha1/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Kh\u00f4ng d\u00f9ng SHA\u20111 cho ch\u1eef k\u00fd s\u1ed1 ho\u1eb7c \u1ee9ng d\u1ee5ng m\u1edbi; migrate sang SHA\u2011256/3 ho\u1eb7c SHA\u20112 family.</li> <li>N\u1ebfu c\u1ea7n MAC: d\u00f9ng HMAC\u2011SHA256 (ho\u1eb7c HMAC\u2011SHA\u20113).</li> <li>Ki\u1ec3m tra c\u1eadp nh\u1eadt th\u01b0 vi\u1ec7n, validate endianness, d\u00f9ng test vectors.</li> <li>Tr\u00e1nh tin t\u01b0\u1edfng v\u00e0o SHA\u20111 cho non\u2011repudiation/forgery-sensitive flows.</li> </ul>"},{"location":"algorithms/hash/sha1/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>\"\" (empty):     da39a3ee5e6b4b0d3255bfef95601890afd80709</li> <li>\"abc\":     a9993e364706816aba3e25717850c26c9cd0d89d</li> <li>\"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq\":     84983e441c3bd26ebaae4aa1f95129e5e54670f1</li> </ul>"},{"location":"algorithms/hash/sha1/#11-code-m\u00f4-t\u1ea3-ng\u1eafn--pseudocode","title":"11. Code (m\u00f4 t\u1ea3 ng\u1eafn / pseudocode)","text":"<ul> <li>Khuy\u1ebfn ngh\u1ecb: d\u00f9ng th\u01b0 vi\u1ec7n \u0111\u00e3 ki\u1ec3m \u0111\u1ecbnh (OpenSSL, libsodium, BoringSSL).</li> <li>Pseudocode ng\u1eafn:<ul> <li>Padding \u2192 for each 512\u2011bit block: W expand \u2192 a..e = H \u2192 80 rounds update \u2192 H += a..e (Chi ti\u1ebft implement ph\u1ee9c t\u1ea1p; tr\u00e1nh t\u1ef1 tri\u1ec3n khai tr\u1eeb khi c\u1ea7n).</li> </ul> </li> </ul>"},{"location":"algorithms/hash/sha1/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Kh\u00f4ng d\u00f9ng SHA\u20111 cho ch\u1eef k\u00fd s\u1ed1, ch\u1ee9ng ch\u1ec9, TLS.</li> <li> N\u1ebfu c\u00f2n legacy: gi\u1edbi h\u1ea1n scope, th\u00eam detection transition.</li> <li> D\u00f9ng HMAC\u2011SHA256 cho MAC.</li> <li> Ki\u1ec3m tra endianness v\u00e0 padding v\u1edbi test vectors.</li> <li> S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n \u0111\u00e3 \u0111\u01b0\u1ee3c duy tr\u00ec, c\u1eadp nh\u1eadt.</li> <li> Log v\u00e0 c\u1ea3nh b\u00e1o khi nh\u1eadn digest SHA\u20111 t\u1eeb b\u00ean ngo\u00e0i.</li> <li> C\u00f3 l\u1ed9 tr\u00ecnh di chuy\u1ec3n/migrate sang SHA\u20112/SHA\u20113.</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o - FIPS PUB 180\u20114 (SHA family), RFC 3174 (SHA\u20111), \"Shattered\" collision (Google), Wikipedia (SHA\u20111). - V\u00ed d\u1ee5 implement: OpenSSL, BoringSSL docs.</p>"},{"location":"algorithms/hash/sha2/","title":"Sha2","text":""},{"location":"algorithms/hash/sha2/#0-filevault-context","title":"0. FileVault context","text":"<ul> <li>FileVault s\u1eed d\u1ee5ng SHA-256 l\u00e0m h\u00e0m b\u0103m m\u1eb7c \u0111\u1ecbnh cho integrity checks v\u00e0 HMAC.</li> <li>M\u1ee5c ti\u00eau: b\u1ea3o to\u00e0n t\u00ednh to\u00e0n v\u1eb9n metadata, ki\u1ec3m tra file g\u1ed1c sau gi\u1ea3i m\u00e3, v\u00e0 l\u00e0m primitive cho HMAC-SHA256.</li> </ul>"},{"location":"algorithms/hash/sha2/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n \u2014 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<ul> <li>SHA-2 l\u00e0 h\u1ecd h\u00e0m b\u0103m m\u1eadt m\u00e3 (SHA-224/256/384/512) sinh ra digest c\u1ed1 \u0111\u1ecbnh t\u1eeb d\u1eef li\u1ec7u t\u00f9y chi\u1ec1u.</li> <li>Gi\u1ea3i quy\u1ebft: ph\u00e1t hi\u1ec7n s\u1eeda \u0111\u1ed5i d\u1eef li\u1ec7u (integrity) v\u00e0 l\u00e0m c\u01a1 s\u1edf cho MAC/signature.</li> <li>B\u1ea3o v\u1ec7: ch\u1ed1ng s\u1eeda \u0111\u1ed5i d\u1eef li\u1ec7u (tamper detection), l\u00e0m c\u01a1 s\u1edf cho x\u00e1c th\u1ef1c v\u00e0 li\u00ean k\u1ebft an to\u00e0n.</li> </ul>"},{"location":"algorithms/hash/sha2/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/hash/sha2/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft-b\u01b0\u1edbc","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft b\u01b0\u1edbc)","text":"<ol> <li>Pre-processing: padding v\u00e0 chia block 512-bit.</li> <li>Kh\u1edfi t\u1ea1o vector tr\u1ea1ng th\u00e1i H0 (8 t\u1eeb 32-bit c\u1ed1 \u0111\u1ecbnh).</li> <li>V\u1edbi m\u1ed7i block:<ul> <li>M\u1edf r\u1ed9ng 16 t\u1eeb th\u00e0nh 64 t\u1eeb w[0..63].</li> <li>Kh\u1edfi t\u1ea1o a..h = H_i.</li> <li>L\u1eb7p t=0..63: T1 = h + \u03a31(e) + Ch(e,f,g) + K[t] + w[t]; T2 = \u03a30(a) + Maj(a,b,c); h=g; g=f; f=e; e=d+T1; d=c; c=b; b=a; a=T1+T2.</li> <li>H_i+1 = H_i + (a..h).</li> </ul> </li> <li>K\u1ebft qu\u1ea3 l\u00e0 H_final = concat(H0..H7).</li> </ol>"},{"location":"algorithms/hash/sha2/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Input block: 512-bit chia th\u00e0nh 16 t\u1eeb 32-bit.</li> <li>State: 8 t\u1eeb 32-bit (SHA-256) ho\u1eb7c 16 t\u1eeb 32-bit (SHA-512 uses 64-bit words).</li> <li>B\u1ea3ng h\u1eb1ng K[0..63] (32-bit constants).</li> </ul>"},{"location":"algorithms/hash/sha2/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>SHA-1: SHA-256 m\u1ea1nh h\u01a1n, kh\u00e1ng collision t\u1ed1t h\u01a1n.</li> <li>SHA-3: kh\u00e1c thi\u1ebft k\u1ebf (sponge), SHA-3 kh\u00f4ng ph\u1ea3i replacement tr\u1ef1c ti\u1ebfp; SHA-2 v\u1eabn an to\u00e0n v\u00e0 nhanh tr\u00ean HW/SW hi\u1ec7n c\u00f3.</li> <li>BLAKE2/BLAKE3: th\u01b0\u1eddng nhanh h\u01a1n v\u00e0 c\u00f3 t\u00ednh n\u0103ng configurable, nh\u01b0ng SHA-2 ph\u1ed5 bi\u1ebfn v\u00e0 ti\u00eau chu\u1ea9n.</li> </ul>"},{"location":"algorithms/hash/sha2/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (Mermaid)","text":"<pre><code>flowchart LR\n    A[Input message] --&gt; B[Padding]\n    B --&gt; C[Split into 512-bit blocks]\n    C --&gt; D[Initialize H0..H7]\n    D --&gt; E[For each block]\n    E --&gt; F[\"Message schedule w[0..63]\"]\n    F --&gt; G[\"64 rounds (compress)\"]\n    G --&gt; H[Update H]\n    H --&gt; I[Final digest]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/hash/sha2/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Sai padding (kh\u00f4ng th\u00eam length ho\u1eb7c th\u00eam sai endian).</li> <li>X\u1eed l\u00fd bit-length v\u01b0\u1ee3t 2^64 cho SHA-256.</li> <li>S\u1eed d\u1ee5ng ki\u1ec3u d\u1eef li\u1ec7u kh\u00f4ng modulo 2^32 (overflow handling).</li> <li>L\u01b0u tr\u1eef h\u1eb1ng sai endian khi serialize/deserialize.</li> <li>S\u1eed d\u1ee5ng SHA-256 tr\u1ef1c ti\u1ebfp cho password hashing (kh\u00f4ng d\u00f9ng salt ho\u1eb7c KDF).</li> <li>Reuse key tr\u1ef1c ti\u1ebfp cho HMAC m\u00e0 kh\u00f4ng theo chu\u1ea9n (sai kh\u00f3a d\u00e0i/short).</li> </ul>"},{"location":"algorithms/hash/sha2/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng: mu\u1ed1n gi\u1ea3 m\u1ea1o file ho\u1eb7c metadata m\u00e0 FileVault d\u00f9ng \u0111\u1ec3 verify.</li> <li>Kh\u1ea3 n\u0103ng: thay \u0111\u1ed5i file, th\u00e2m nh\u1eadp v\u00e0o metadata, replay.</li> <li>M\u1ee5c ti\u00eau t\u1ea5n c\u00f4ng: g\u00e2y collision hay preimage \u0111\u1ec3 v\u01b0\u1ee3t ki\u1ec3m tra integrity ho\u1eb7c HMAC.</li> </ul>"},{"location":"algorithms/hash/sha2/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>D\u00f9ng HMAC-SHA256 cho integrity/authentication, kh\u00f4ng ch\u1ec9 hash th\u00f4.</li> <li>Ki\u1ec3m tra v\u00e0 b\u1ea3o v\u1ec7 metadata (signature ho\u1eb7c AEAD).</li> <li>Th\u1ef1c hi\u1ec7n padding/endianness \u0111\u00fang chu\u1ea9n.</li> <li>D\u00f9ng KDF (PBKDF2/Argon2) cho password-derived keys.</li> <li>B\u1ea3o v\u1ec7 kh\u00f3a HMAC, kh\u00f3a signing b\u1eb1ng kho kh\u00f3a v\u00e0 ACL.</li> <li>Log v\u00e0 detect b\u1ea5t th\u01b0\u1eddng (tampering attempts).</li> </ul>"},{"location":"algorithms/hash/sha2/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>SHA-256(\"\")<ul> <li>hex: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</li> </ul> </li> <li>SHA-256(\"abc\")<ul> <li>hex: ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad</li> </ul> </li> <li>SHA-256(\"The quick brown fox jumps over the lazy dog\")<ul> <li>hex: d7a8fbb307d7809469ca9abcb0082e4f8d5651e46d3cdb762d02d0bf37c9e592</li> </ul> </li> </ul>"},{"location":"algorithms/hash/sha2/#11-code-v\u00ed-d\u1ee5-nhanh--python-hashlib","title":"11. Code (v\u00ed d\u1ee5 nhanh \u2014 Python hashlib)","text":"Python<pre><code>import hashlib\n\ndef sha256_hex(data: bytes) -&gt; str:\n        return hashlib.sha256(data).hexdigest()\n\n# examples\nprint(sha256_hex(b\"\"))        # e3b0c4...\nprint(sha256_hex(b\"abc\"))     # ba7816...\n</code></pre>"},{"location":"algorithms/hash/sha2/#12-checklist-b\u1ea3o-m\u1eadt-filevault-specific","title":"12. Checklist b\u1ea3o m\u1eadt (FileVault-specific)","text":"<ul> <li> D\u00f9ng HMAC-SHA256 \u0111\u1ec3 b\u1ea3o v\u1ec7 metadata, kh\u00f4ng ch\u1ec9 hash.</li> <li> B\u1ea3o v\u1ec7 v\u00e0 rotate keys theo ch\u00ednh s\u00e1ch.</li> <li> Ki\u1ec3m tra padding v\u00e0 endian khi serialize metadata.</li> <li> D\u00f9ng KDF ph\u00f9 h\u1ee3p cho m\u1eadt kh\u1ea9u (Argon2/PBKDF2) tr\u01b0\u1edbc l\u00e0m key HMAC.</li> <li> Th\u1ef1c hi\u1ec7n test vector checks trong pipeline CI.</li> <li> Audit th\u01b0 vi\u1ec7n crypto (upstream, CVEs).</li> <li> Log failed integrity checks v\u00e0 gi\u1edbi h\u1ea1n retry.</li> </ul>"},{"location":"algorithms/hash/sha2/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>FIPS PUB 180-4 (SHA-2) \u2014 NIST</li> <li>RFC 6234 (US Secure Hash Algorithms)</li> <li>RFC 2104 (HMAC)</li> </ul>"},{"location":"algorithms/hash/sha3/","title":"Sha3","text":""},{"location":"algorithms/hash/sha3/#0-filevault-context","title":"0. FileVault context","text":"<ul> <li>D\u00f9ng trong FileVault l\u00e0m h\u00e0m b\u0103m m\u1eadt cho integrity, fingerprinting, v\u00e0 derivation (SHA3-256, SHA3-512).  </li> <li>L\u1ef1a ch\u1ecdn l\u00e0m ph\u01b0\u01a1ng \u00e1n d\u1ef1 ph\u00f2ng song song v\u1edbi SHA-2/KECCAK.</li> </ul>"},{"location":"algorithms/hash/sha3/#1-kh\u00e1i-ni\u1ec7m-m\u1ee5c-ti\u00eau-b\u1ea3o-v\u1ec7","title":"1. Kh\u00e1i ni\u1ec7m, m\u1ee5c ti\u00eau b\u1ea3o v\u1ec7","text":"<ul> <li>SHA\u20113 (Keccak) l\u00e0 chu\u1ea9n h\u00e0m b\u0103m d\u1ef1a tr\u00ean sponge construction.  </li> <li>Gi\u1ea3i quy\u1ebft: t\u1ea1o digest c\u1ed1 \u0111\u1ecbnh t\u1eeb d\u1eef li\u1ec7u bi\u1ebfn \u0111\u1ed9 d\u00e0i, kh\u00e1ng collision, preimage, second\u2011preimage; kh\u00e1c c\u1ea5u tr\u00fac v\u1edbi Merkle\u2013Damg\u00e5rd (kh\u00f4ng b\u1ecb length\u2011extension).  </li> <li>B\u1ea3o v\u1ec7: t\u00ednh to\u00e0n v\u1eb9n d\u1eef li\u1ec7u, nh\u1eadn d\u1ea1ng duy nh\u1ea5t, c\u01a1 s\u1edf cho MAC/KDF (khi k\u1ebft h\u1ee3p \u0111\u00fang).</li> </ul>"},{"location":"algorithms/hash/sha3/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c-math-markdown","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c (math markdown)","text":""},{"location":"algorithms/hash/sha3/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ul> <li>Hai giai \u0111o\u1ea1n: Absorb (h\u1ea5p thu) v\u00e0 Squeeze (v\u1eaft).  </li> <li>Absorb: chia input th\u00e0nh block k\u00edch th\u01b0\u1edbc \\(r\\), XOR v\u00e0o ph\u1ea7n rate c\u1ee7a state, r\u1ed3i \u00e1p d\u1ee5ng permutation Keccak\u2011f. L\u1eb7p cho t\u1ea5t c\u1ea3 block.  </li> <li>Squeeze: xu\u1ea5t t\u1eebng kh\u1ed1i \\(r\\) t\u1eeb state, n\u1ebfu c\u1ea7n th\u00eam output th\u00ec ti\u1ebfp t\u1ee5c \u00e1p d\u1ee5ng permutation r\u1ed3i xu\u1ea5t th\u00eam.</li> </ul>"},{"location":"algorithms/hash/sha3/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>State: ma tr\u1eadn 5\u00d75 lanes (m\u1ed7i lane \\(w\\) bit).  </li> <li>Permutation Keccak\u2011f[b]: h\u00e0ng c\u00e1c b\u01b0\u1edbc (\u03b8, \u03c1, \u03c0, \u03c7, \u03b9) th\u1ef1c hi\u1ec7n tr\u00ean state; s\u1eed d\u1ee5ng constants v\u00f2ng (round constants).  </li> <li>Padding: pad10*1 (g\u1ed3m bit domain\u2011separation cho SHA\u20113).</li> </ul>"},{"location":"algorithms/hash/sha3/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>VS SHA\u20112: kh\u00e1c c\u1ea5u tr\u00fac (sponge vs Merkle\u2013Damg\u00e5rd), kh\u00f4ng d\u1ec5 b\u1ecb length\u2011extension; SHA\u20113 kh\u00f4ng thay th\u1ebf tr\u1ef1c ti\u1ebfp SHA\u20112 nh\u01b0ng l\u00e0 l\u1ef1a ch\u1ecdn b\u1ed5 sung.  </li> <li>VS Keccak\u2011x (original): SHA\u20113 c\u00f3 domain separation/padding kh\u00e1c so v\u1edbi Keccak submitter.</li> </ul>"},{"location":"algorithms/hash/sha3/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-flow","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (flow)","text":"<ul> <li>Input -&gt; Padding (pad10*1 + domain) -&gt; Split v\u00e0o blocks r-bit  </li> <li>For each block: state.rate ^= block; state = Keccak\u2011f(state)  </li> <li>Output: l\u1ea5y ra t\u1eeb state.rate; l\u1eb7p khi c\u1ea7n.</li> </ul> <p>Mermaid (s\u01a1 \u0111\u1ed3 \u0111\u01a1n gi\u1ea3n): </p> <pre><code>flowchart TD\n    In[Input] --&gt; Pad[Padding pad10*1]\n    Pad --&gt; Split[Split v\u00e0o block r-bit]\n    Split --&gt; Absorb[Absorb: XOR v\u00e0o state.rate]\n    Absorb --&gt; Perm[Keccak-f permutation]\n    Perm --&gt; Check{C\u00f2n block?}\n    Check -- Yes --&gt; Absorb\n    Check -- No --&gt; Squeeze[Squeeze: xu\u1ea5t t\u1eeb state.rate]\n    Squeeze --&gt; Out[Digest/Stream]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/hash/sha3/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng d\u00f9ng \u0111\u00fang padding ho\u1eb7c domain\u2011separation (d\u1eabn t\u1edbi colliding v\u1edbi bi\u1ebfn th\u1ec3 kh\u00e1c).  </li> <li>Endianness/bit ordering sai khi \u0111\u1ecdc/ghi lanes.  </li> <li>Kh\u00f4ng x\u00f3a state nh\u1ea1y c\u1ea3m kh\u1ecfi b\u1ed9 nh\u1edb.  </li> <li>Kh\u00f4ng th\u1ef1c hi\u1ec7n c\u00e1c ph\u00e9p to\u00e1n \u1edf th\u1eddi gian c\u1ed1 \u0111\u1ecbnh khi d\u00f9ng trong KDF/MAC c\u00f3 kh\u00f3a (side\u2011channel).  </li> <li>D\u00f9ng SHA3 thay cho SHAKE khi c\u1ea7n output bi\u1ebfn \u0111\u1ed9 d\u00e0i (ho\u1eb7c ng\u01b0\u1ee3c l\u1ea1i) sai m\u1ee5c \u0111\u00edch.</li> </ul>"},{"location":"algorithms/hash/sha3/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>T\u1ea5n c\u00f4ng cryptanalytic: t\u00ecm collision, preimage.  </li> <li>T\u1ea5n c\u00f4ng implementation: side\u2011channel (timing, cache), fault injection.  </li> <li>T\u1ea5n c\u00f4ng ph\u00e2n ph\u1ed1i/tho\u00e1n \u0111\u1ed5i padding ho\u1eb7c domain separation.  </li> <li>M\u1ed1i nguy t\u1eeb reuse state ho\u1eb7c re\u2011initialization sai.</li> </ul>"},{"location":"algorithms/hash/sha3/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n \u0111\u00e3 review v\u00e0 chu\u1ea9n (v\u00ed d\u1ee5 OpenSSL/libkeccak/libcrypto) thay v\u00ec t\u1ef1 tri\u1ec3n khai.  </li> <li>Ki\u1ec3m tra padding v\u00e0 domain\u2011separation.  </li> <li>X\u00f3a state khi kh\u00f4ng c\u00f2n d\u00f9ng.  </li> <li>Thi\u1ebft k\u1ebf constant\u2011time cho ph\u1ea7n nh\u1ea1y c\u1ea3m (M\u1edf kho\u00e1, KDF).  </li> <li>Gi\u1edbi h\u1ea1n th\u00f4ng tin l\u1ed7i v\u00e0 logging.</li> </ul>"},{"location":"algorithms/hash/sha3/#10-test-vectors-c\u00e1ch-sinh-ki\u1ec3m-tra","title":"10. Test Vectors (c\u00e1ch sinh ki\u1ec3m tra)","text":"<ul> <li>Sinh b\u1eb1ng openssl / program \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o k\u1ebft qu\u1ea3 trong m\u00f4i tr\u01b0\u1eddng:<ul> <li>echo -n \"\" | openssl dgst -sha3-256</li> <li>echo -n \"abc\" | openssl dgst -sha3-256</li> <li>echo -n \"\" | openssl dgst -sha3-512</li> </ul> </li> <li>So s\u00e1nh v\u1edbi NIST/Keccak team official vectors (tham kh\u1ea3o ph\u00eda d\u01b0\u1edbi).</li> </ul>"},{"location":"algorithms/hash/sha3/#11-code-v\u00ed-d\u1ee5-ng\u1eafn-python","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn Python)","text":"Python<pre><code>import hashlib\nd = hashlib.sha3_256(b\"abc\").hexdigest()\nprint(d)\n</code></pre> - Ghi ch\u00fa: Python 3.6+ h\u1ed7 tr\u1ee3 sha3_* trong hashlib."},{"location":"algorithms/hash/sha3/#12-checklist-b\u1ea3o-m\u1eadt-nh\u1ecf-g\u1ecdn","title":"12. Checklist b\u1ea3o m\u1eadt (nh\u1ecf g\u1ecdn)","text":"<ul> <li> D\u00f9ng implementation \u0111\u01b0\u1ee3c audit.  </li> <li> Ki\u1ec3m tra \u0111\u00fang padding v\u00e0 domain bits.  </li> <li> X\u1eed l\u00fd endianness khi thao t\u00e1c lanes.  </li> <li> X\u00f3a state sau d\u00f9ng/xu\u1ea5t.  </li> <li> \u0110\u1ea3m b\u1ea3o constant\u2011time \u1edf ph\u1ea7n nh\u1ea1y c\u1ea3m.  </li> <li> Ki\u1ec3m tra test vectors t\u1ef1 \u0111\u1ed9ng trong CI.  </li> <li> Kh\u00f4ng d\u00f9ng SHA3 l\u00e0m MAC thay cho HMAC tr\u1eeb khi bi\u1ebft r\u00f5 c\u01a1 ch\u1ebf (d\u00f9ng KMAC n\u1ebfu c\u1ea7n).</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o - Keccak team: https://keccak.team - NIST FIPS 202 (SHA\u20113): https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf - OpenSSL docs / hashlib docs</p> <p>T\u00e0i li\u1ec7u b\u1ed5 sung: xem NIST vectors ch\u00ednh th\u1ee9c v\u00e0 Keccak specs \u0111\u1ec3 \u0111\u1ed1i chi\u1ebfu test vectors ch\u00ednh x\u00e1c.</p>"},{"location":"algorithms/kdf/argon2/","title":"Argon2","text":""},{"location":"algorithms/kdf/argon2/#1-t\u00f3m-t\u1eaft","title":"1. T\u00f3m t\u1eaft","text":"<p>Argon2 l\u00e0 thu\u1eadt to\u00e1n chi\u1ebfn th\u1eafng cu\u1ed9c thi Password Hashing Competition (PHC) n\u0103m 2015. N\u00f3 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 ch\u1ed1ng l\u1ea1i c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng brute-force b\u1eb1ng GPU, ASIC v\u00e0 FPGA b\u1eb1ng c\u00e1ch y\u00eau c\u1ea7u nhi\u1ec1u b\u1ed9 nh\u1edb (memory-hard).</p> <p>Trong FileVault, Argon2id l\u00e0 KDF m\u1eb7c \u0111\u1ecbnh cho ch\u1ebf \u0111\u1ed9 <code>PROFESSIONAL</code> v\u00e0 <code>ADVANCED</code>, \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 chuy\u1ec3n \u0111\u1ed5i m\u1eadt kh\u1ea9u ng\u01b0\u1eddi d\u00f9ng th\u00e0nh kh\u00f3a m\u00e3 h\u00f3a (encryption key) 256-bit.</p>"},{"location":"algorithms/kdf/argon2/#2-thu\u1eadt-to\u00e1n--n\u1ec1n-t\u1ea3ng","title":"2. Thu\u1eadt to\u00e1n &amp; N\u1ec1n t\u1ea3ng","text":"<p>Argon2 c\u00f3 3 bi\u1ebfn th\u1ec3 ch\u00ednh: 1.  Argon2d: T\u1ed1i \u01b0u kh\u00e1ng GPU (data-dependent addressing), nh\u01b0ng d\u1ec5 b\u1ecb side-channel attacks. D\u00f9ng cho ti\u1ec1n m\u00e3 h\u00f3a (cryptocurrencies). 2.  Argon2i: T\u1ed1i \u01b0u kh\u00e1ng side-channel (data-independent addressing). D\u00f9ng cho x\u00e1c th\u1ef1c m\u1eadt kh\u1ea9u. 3.  Argon2id: K\u1ebft h\u1ee3p c\u1ea3 hai (n\u1eeda \u0111\u1ea7u l\u00e0 Argon2i, n\u1eeda sau l\u00e0 Argon2d). \u0110\u00e2y l\u00e0 bi\u1ebfn th\u1ec3 \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb v\u00e0 s\u1eed d\u1ee5ng trong FileVault.</p>"},{"location":"algorithms/kdf/argon2/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<p>Argon2 ho\u1ea1t \u0111\u1ed9ng b\u1eb1ng c\u00e1ch \u0111i\u1ec1n \u0111\u1ea7y m\u1ed9t v\u00f9ng nh\u1edb l\u1edbn (memory buffer) v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb gi\u1ea3 ng\u1eabu nhi\u00ean \u0111\u01b0\u1ee3c t\u00ednh to\u00e1n t\u1eeb m\u1eadt kh\u1ea9u v\u00e0 salt. 1.  Initialization: Kh\u1edfi t\u1ea1o lane (lu\u1ed3ng song song) v\u00e0 memory blocks. 2.  Filling Loop: T\u00ednh to\u00e1n gi\u00e1 tr\u1ecb cho t\u1eebng block d\u1ef1a tr\u00ean c\u00e1c block tr\u01b0\u1edbc \u0111\u00f3.     *   V\u1edbi Argon2i: \u0110\u1ecba ch\u1ec9 block tham chi\u1ebfu \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi b\u1ed9 sinh s\u1ed1 gi\u1ea3 ng\u1eabu nhi\u00ean.     *   V\u1edbi Argon2d: \u0110\u1ecba ch\u1ec9 block tham chi\u1ebfu ph\u1ee5 thu\u1ed9c v\u00e0o d\u1eef li\u1ec7u trong block tr\u01b0\u1edbc. 3.  Finalization: XOR c\u00e1c block cu\u1ed1i c\u00f9ng c\u1ee7a m\u1ed7i lane v\u00e0 hash \u0111\u1ec3 t\u1ea1o ra output key.</p>"},{"location":"algorithms/kdf/argon2/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u--tham-s\u1ed1","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u &amp; Tham s\u1ed1","text":"<p>FileVault s\u1eed d\u1ee5ng c\u00e1c tham s\u1ed1 sau cho Argon2id:</p> <ul> <li>Salt: 16 bytes (128 bits), sinh ng\u1eabu nhi\u00ean cho m\u1ed7i file.</li> <li>Output Key Length: 32 bytes (256 bits) - d\u00f9ng l\u00e0m kh\u00f3a cho AES-256 ho\u1eb7c ChaCha20.</li> <li>Parallelism (p): S\u1ed1 lu\u1ed3ng x\u1eed l\u00fd song song.</li> <li>Memory (m): L\u01b0\u1ee3ng RAM s\u1eed d\u1ee5ng (t\u00ednh b\u1eb1ng KB).</li> <li>Iterations (t): S\u1ed1 v\u00f2ng l\u1eb7p qua b\u1ed9 nh\u1edb.</li> </ul>"},{"location":"algorithms/kdf/argon2/#c\u1ea5u-h\u00ecnh-trong-filevault-theo-security-level","title":"C\u1ea5u h\u00ecnh trong FileVault (theo Security Level)","text":"Level Iterations (t) Memory (m) Parallelism (p) \u01af\u1edbc t\u00ednh th\u1eddi gian WEAK 1 4 MB 1 R\u1ea5t nhanh (&lt; 0.1s) MEDIUM 2 16 MB 2 ~1-2s (Default) STRONG 3 64 MB 4 ~5-10s PARANOID 4 128 MB 4 ~20-30s"},{"location":"algorithms/kdf/argon2/#5-lu\u1ed3ng-d\u1eef-li\u1ec7u-key-derivation","title":"5. Lu\u1ed3ng d\u1eef li\u1ec7u (Key Derivation)","text":"<pre><code>sequenceDiagram\n    participant User\n    participant App\n    participant CSPRNG\n    participant Argon2id\n    participant CryptoEngine\n\n    User-&gt;&gt;App: Nh\u1eadp Password\n    App-&gt;&gt;CSPRNG: Generate Salt (16 bytes)\n    CSPRNG--&gt;&gt;App: Salt\n    App-&gt;&gt;Argon2id: Derive(Password, Salt, t, m, p)\n    activate Argon2id\n    Argon2id-&gt;&gt;Argon2id: Allocate Memory (m KB)\n    Argon2id-&gt;&gt;Argon2id: Fill Memory (t passes)\n    Argon2id--&gt;&gt;App: Derived Key (32 bytes)\n    deactivate Argon2id\n    App-&gt;&gt;CryptoEngine: Use Key for Encryption\n    App-&gt;&gt;Storage: Save Salt + Params (t, m, p) with File</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/kdf/argon2/#6-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"6. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Hardcoded Salt: D\u00f9ng c\u00f9ng m\u1ed9t salt cho m\u1ecdi user/file.<ul> <li>H\u1eadu qu\u1ea3: Rainbow table attack kh\u1ea3 thi.</li> <li>FileVault Check: Code lu\u00f4n g\u1ecdi <code>generate_salt(16)</code> cho m\u1ed7i file m\u1edbi.</li> </ul> </li> <li>Tham s\u1ed1 qu\u00e1 th\u1ea5p: D\u00f9ng \\(m=1MB, t=1\\) tr\u00ean ph\u1ea7n c\u1ee9ng hi\u1ec7n \u0111\u1ea1i.<ul> <li>H\u1eadu qu\u1ea3: GPU c\u00f3 th\u1ec3 brute-force nhanh.</li> <li>FileVault Check: Level <code>MEDIUM</code> (default) d\u00f9ng 16MB, 2 iterations l\u00e0 m\u1ee9c ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c cho desktop app, nh\u01b0ng n\u00ean c\u00e2n nh\u1eafc t\u0103ng l\u00ean 64MB n\u1ebfu c\u00f3 th\u1ec3.</li> </ul> </li> <li>D\u00f9ng sai bi\u1ebfn th\u1ec3: D\u00f9ng Argon2d cho password hashing (d\u1ec5 b\u1ecb side-channel).<ul> <li>FileVault Check: Code s\u1eed d\u1ee5ng <code>Argon2id</code> (ho\u1eb7c <code>Argon2i</code> n\u1ebfu c\u1ea5u h\u00ecnh), tr\u00e1nh <code>Argon2d</code>.</li> </ul> </li> </ol>"},{"location":"algorithms/kdf/argon2/#7-threat-model","title":"7. Threat Model","text":"<ul> <li>Asset: Master Password c\u1ee7a ng\u01b0\u1eddi d\u00f9ng.</li> <li>Attacker: C\u00f3 file \u0111\u00e3 m\u00e3 h\u00f3a (ch\u1ee9a salt + params) v\u00e0 mu\u1ed1n t\u00ecm password.</li> <li>Attack Scenarios:<ol> <li>Offline Brute-force: Attacker d\u00f9ng GPU cluster \u0111\u1ec3 th\u1eed h\u00e0ng t\u1ef7 password/gi\u00e2y.<ul> <li>Mitigation: Argon2 memory-hardness l\u00e0m gi\u1ea3m t\u1ed1c \u0111\u1ed9 th\u1eed c\u1ee7a GPU \u0111\u00e1ng k\u1ec3 so v\u1edbi PBKDF2/SHA256.</li> </ul> </li> <li>Time-Memory Tradeoff (TMTO): Attacker d\u00f9ng \u00edt b\u1ed9 nh\u1edb h\u01a1n nh\u01b0ng t\u00ednh to\u00e1n nhi\u1ec1u h\u01a1n.<ul> <li>Mitigation: Argon2id kh\u00e1ng TMTO t\u1ed1t.</li> </ul> </li> </ol> </li> </ul>"},{"location":"algorithms/kdf/argon2/#8-v\u00ed-d\u1ee5-code-python","title":"8. V\u00ed d\u1ee5 Code (Python)","text":"<p>S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n <code>argon2-cffi</code>:</p> Python<pre><code>from argon2 import PasswordHasher, Type\n\ndef derive_key_argon2id(password, salt):\n    # C\u1ea5u h\u00ecnh t\u01b0\u01a1ng \u0111\u01b0\u01a1ng SecurityLevel::STRONG\n    ph = PasswordHasher(\n        time_cost=3,         # Iterations\n        memory_cost=65536,   # 64 MB\n        parallelism=4,       # Threads\n        hash_len=32,         # 256-bit key\n        salt_len=16,\n        type=Type.ID\n    )\n\n    # L\u01b0u \u00fd: th\u01b0 vi\u1ec7n argon2-cffi th\u01b0\u1eddng t\u1ef1 sinh salt v\u00e0 tr\u1ea3 v\u1ec1 chu\u1ed7i encoded\n    # \u0110\u1ec3 derive raw key v\u1edbi salt c\u1ee5 th\u1ec3 c\u1ea7n d\u00f9ng low-level API ho\u1eb7c hash_raw\n    # \u0110\u00e2y l\u00e0 v\u00ed d\u1ee5 hash_raw gi\u1ea3 \u0111\u1ecbnh (API th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 kh\u00e1c t\u00f9y version)\n    return ph.hash(password, salt=salt)\n\n# Ki\u1ec3m tra verify\nph = PasswordHasher()\nhash = ph.hash(\"correct horse battery staple\")\nassert ph.verify(hash, \"correct horse battery staple\")\n</code></pre>"},{"location":"algorithms/kdf/argon2/#9-checklist-b\u1ea3o-m\u1eadt","title":"9. Checklist B\u1ea3o M\u1eadt","text":"<ul> <li> Lu\u00f4n s\u1eed d\u1ee5ng Argon2id cho password hashing.</li> <li> Salt ph\u1ea3i l\u00e0 16 bytes ng\u1eabu nhi\u00ean (CSPRNG).</li> <li> Tham s\u1ed1 b\u1ed9 nh\u1edb (\\(m\\)) n\u00ean c\u00e0ng l\u1edbn c\u00e0ng t\u1ed1t (t\u00f9y thu\u1ed9c v\u00e0o RAM kh\u1ea3 d\u1ee5ng c\u1ee7a thi\u1ebft b\u1ecb ng\u01b0\u1eddi d\u00f9ng).</li> <li> L\u01b0u tr\u1eef tham s\u1ed1 (\\(t, m, p\\)) c\u00f9ng v\u1edbi salt trong header file \u0111\u1ec3 c\u00f3 th\u1ec3 gi\u1ea3i m\u00e3 l\u1ea1i trong t\u01b0\u01a1ng lai (future-proof n\u1ebfu \u0111\u1ed5i default).</li> </ul>"},{"location":"algorithms/kdf/argon2/#10-test-vectors","title":"10. Test Vectors","text":"<p>Do Argon2 d\u00f9ng salt ng\u1eabu nhi\u00ean, test vectors th\u01b0\u1eddng y\u00eau c\u1ea7u fix salt. Gi\u1ea3 s\u1eed: *   Password: <code>password</code> *   Salt: <code>somesalt</code> (8 bytes - l\u01b0u \u00fd: FileVault d\u00f9ng 16 bytes) *   Params: t=2, m=65536 (64MB), p=1</p> <p>Output (Encoded): <code>$argon2id$v=19$m=65536,t=2,p=1$c29tZXNhbHQ$ctMy0p+G...</code></p>"},{"location":"algorithms/kdf/argon2/#argon2id","title":"Argon2id","text":""},{"location":"algorithms/kdf/argon2/#1-t\u00f3m-t\u1eaft_1","title":"1. T\u00f3m t\u1eaft","text":"<p>Argon2id l\u00e0 bi\u1ebfn th\u1ec3 an to\u00e0n nh\u1ea5t c\u1ee7a Argon2, \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho h\u1ea7u h\u1ebft c\u00e1c \u1ee9ng d\u1ee5ng l\u01b0u tr\u1eef m\u1eadt kh\u1ea9u v\u00e0 sinh kh\u00f3a (KDF).</p>"},{"location":"algorithms/kdf/argon2/#2-t\u1ea1i-sao-ch\u1ecdn-argon2id","title":"2. T\u1ea1i sao ch\u1ecdn Argon2id?","text":"<ul> <li>Argon2d: Kh\u00e1ng GPU t\u1ed1t nh\u1ea5t nh\u01b0ng y\u1ebfu tr\u01b0\u1edbc side-channel attacks (cache timing).</li> <li>Argon2i: Kh\u00e1ng side-channel t\u1ed1t nh\u1ea5t nh\u01b0ng kh\u00e1ng GPU k\u00e9m h\u01a1n Argon2d.</li> <li>Argon2id: K\u1ebft h\u1ee3p c\u1ea3 hai.<ul> <li>N\u1eeda \u0111\u1ea7u (First Pass): Ho\u1ea1t \u0111\u1ed9ng nh\u01b0 Argon2i \u0111\u1ec3 tr\u00e1nh side-channel khi b\u1ed9 nh\u1edb ch\u01b0a \u0111\u01b0\u1ee3c \u0111i\u1ec1n \u0111\u1ea7y.</li> <li>N\u1eeda sau (Subsequent Passes): Ho\u1ea1t \u0111\u1ed9ng nh\u01b0 Argon2d \u0111\u1ec3 t\u1ed1i \u0111a h\u00f3a chi ph\u00ed b\u1ed9 nh\u1edb (Memory Hardness).</li> </ul> </li> </ul>"},{"location":"algorithms/kdf/argon2/#3-c\u1ea5u-h\u00ecnh-trong-filevault","title":"3. C\u1ea5u h\u00ecnh trong FileVault","text":"<p>FileVault s\u1eed d\u1ee5ng Argon2id l\u00e0m m\u1eb7c \u0111\u1ecbnh. *   Salt: 16 bytes. *   Parallelism: 4 threads (t\u1eadn d\u1ee5ng CPU \u0111a nh\u00e2n). *   Memory: T\u00f9y ch\u1ecdn t\u1eeb 16MB \u0111\u1ebfn 1GB. *   Iterations: T\u00f9y ch\u1ec9nh (m\u1eb7c \u0111\u1ecbnh 3).</p>"},{"location":"algorithms/kdf/hkdf/","title":"Hkdf","text":""},{"location":"algorithms/kdf/hkdf/#0-ng\u1eef-c\u1ea3nh-filevault","title":"0/ Ng\u1eef c\u1ea3nh Filevault","text":"<p>T\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 HKDF (HMAC-based Key Derivation Function) d\u00f9ng \u0111\u1ec3 sinh kh\u00f3a an to\u00e0n t\u1eeb kh\u00f3a/secret g\u1ed1c trong h\u1ec7 th\u1ed1ng Filevault: ph\u00e2n t\u00e1ch tr\u00e1ch nhi\u1ec7m kh\u00f3a, sinh nhi\u1ec1u kh\u00f3a con t\u1eeb m\u1ed9t ngu\u1ed3n, b\u1ea3o \u0111\u1ea3m t\u00ednh \u0111\u1ed9c l\u1eadp gi\u1eefa c\u00e1c m\u1ee5c \u0111\u00edch s\u1eed d\u1ee5ng.</p>"},{"location":"algorithms/kdf/hkdf/#1-kh\u00e1i-ni\u1ec7m","title":"1/ Kh\u00e1i ni\u1ec7m","text":"<p>HKDF l\u00e0 m\u1ed9t KDF d\u1ef1a tr\u00ean HMAC. M\u1ee5c \u0111\u00edch: chuy\u1ec3n input keying material (IKM) c\u00f3 th\u1ec3 \u00edt ng\u1eabu nhi\u00ean th\u00e0nh c\u00e1c kh\u00f3a m\u1eadt m\u00e3 c\u00f3 t\u00ednh an to\u00e0n, ph\u00e2n ph\u1ed1i l\u1ea1i entropy, t\u00e1ch salt/info theo ng\u1eef c\u1ea3nh \u0111\u1ec3 gi\u1ea3m r\u1ee7i ro l\u1ed9 kh\u00f3a.</p>"},{"location":"algorithms/kdf/hkdf/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2/ To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/kdf/hkdf/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3/ C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ol> <li>EXTRACT: gom entropy t\u1eeb IKM b\u1eb1ng HMAC v\u1edbi salt -&gt; PRK (m\u1ed9t \"pseudo-random key\").</li> <li>EXPAND: d\u00f9ng PRK l\u00e0m HMAC key, k\u1ebft h\u1ee3p info + counter \u0111\u1ec3 sinh chu\u1ed7i kh\u1ed1i T(i), gh\u00e9p th\u00e0nh OKM.</li> </ol>"},{"location":"algorithms/kdf/hkdf/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4/ C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>IKM: input keying material (byte[])</li> <li>salt: optional (byte[]), khuy\u1ebfn ngh\u1ecb ng\u1eabu nhi\u00ean/kh\u00e1c nhau</li> <li>info: context/application-specific (byte[])</li> <li>PRK: HashLen bytes</li> <li>OKM: output key material, k\u00edch th\u01b0\u1edbc L bytes</li> </ul>"},{"location":"algorithms/kdf/hkdf/#5-so-s\u00e1nh-v\u1edbi-kdf-kh\u00e1c","title":"5/ So s\u00e1nh v\u1edbi KDF kh\u00e1c","text":"<ul> <li>PBKDF2: th\u00edch h\u1ee3p cho m\u1eadt kh\u1ea9u (k\u00e9o d\u00e0i b\u1eb1ng iter), HKDF th\u00edch h\u1ee3p cho key material c\u00f3 entropy t\u1ed1t.</li> <li>HKDF vs HKDF-Expand-Only: EXTRACT t\u0103ng t\u00ednh robust n\u1ebfu IKM \u00edt ng\u1eabu nhi\u00ean.</li> <li>Argon2/scrypt: d\u00e0nh cho l\u00e0m ch\u1eadm d\u1ea1ng m\u1eadt kh\u1ea9u, kh\u00e1c m\u1ee5c \u0111\u00edch.</li> </ul>"},{"location":"algorithms/kdf/hkdf/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-sequenceflow","title":"6/ Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (sequence/flow)","text":"<pre><code>flowchart LR\n    A[IKM] --&gt; B{Salt provided?}\n\n    subgraph Extract [HKDF-Extract]\n        direction LR\n        B -- Yes --&gt; C[\"PRK = HMAC(salt, IKM)\"]\n        B -- No --&gt; C[\"PRK = HMAC(0x00..., IKM)\"]\n    end\n\n    subgraph Expand [HKDF-Expand]\n        direction LR\n        C --&gt; D[\"T(1), T(2), ... , T(n)\"]\n        D --&gt; E[\"OKM (truncate to L bytes)\"]\n    end\n\n    E --&gt; F[\"Derived subkeys for different purposes\"]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/kdf/hkdf/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7/ C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng d\u00f9ng ho\u1eb7c d\u00f9ng salt c\u1ed1 \u0111\u1ecbnh/kh\u00f4ng ng\u1eabu nhi\u00ean.</li> <li>D\u00f9ng info kh\u00f4ng kh\u00e1c nhau gi\u1eefa m\u1ee5c \u0111\u00edch =&gt; ph\u00e1t sinh reuse key.</li> <li>C\u1eaft OKM kh\u00f4ng gi\u1eef ranh gi\u1edbi kh\u1ed1i HMAC (v\u1eabn h\u1ee3p l\u1ec7 nh\u01b0ng ph\u1ea3i \u0111\u00fang L &lt;= 255*HashLen).</li> <li>D\u00f9ng HMAC kh\u00f4ng an to\u00e0n ho\u1eb7c HMAC v\u1edbi hash y\u1ebfu kh\u00f4ng ph\u00f9 h\u1ee3p.</li> <li>Kh\u00f4ng ki\u1ec3m so\u00e1t gi\u1edbi h\u1ea1n L d\u1eabn t\u1edbi qu\u00e1 d\u00e0i.</li> </ul>"},{"location":"algorithms/kdf/hkdf/#8-threat-model","title":"8/ Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c c\u00e1c kh\u00f3a con c\u1ee5c b\u1ed9, m\u1ee5c ti\u00eau: kh\u00f4i ph\u1ee5c IKM ho\u1eb7c c\u00e1c kh\u00f3a con kh\u00e1c.</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 ch\u1ec9 th\u1ea5y info/salt public.</li> <li>M\u1ee5c ti\u00eau b\u1ea3o v\u1ec7: t\u00ednh suy bi\u1ebfn (preimage) c\u1ee7a IKM, t\u00ednh \u0111\u1ed9c l\u1eadp gi\u1eefa c\u00e1c OKM kh\u00e1c nhau.</li> </ul>"},{"location":"algorithms/kdf/hkdf/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9/ Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n d\u00f9ng salt ng\u1eabu nhi\u00ean n\u1ebfu IKM c\u00f3 entropy th\u1ea5p; n\u1ebfu salt public th\u00ec v\u1eabn t\u0103ng t\u00ednh t\u00e1ch r\u1eddi.</li> <li>T\u00e1ch r\u00f5 info theo m\u1ee5c \u0111\u00edch, version, context.</li> <li>Ch\u1ecdn hash m\u1ea1nh (SHA-256/512); theo nhu c\u1ea7u, t\u0103ng l\u00ean SHA-512.</li> <li>H\u1ea1n ch\u1ebf L theo needs; tr\u00e1nh c\u1ea5p OKM qu\u00e1 d\u00e0i.</li> <li>L\u00e0m to\u00e0n b\u1ed9 HMAC/so s\u00e1nh trong constant time khi c\u1ea7n.</li> </ul>"},{"location":"algorithms/kdf/hkdf/#10-test-vectors-v\u00ed-d\u1ee5-ng\u1eafn-theo-rfc-5869","title":"10/ Test Vectors (v\u00ed d\u1ee5 ng\u1eafn, theo RFC 5869)","text":"<p>V\u00ed d\u1ee5 (SHA-256, r\u00fat g\u1ecdn): - IKM: 0x0b0b0b0b0b0b0b0b0b0b0b - salt: 0x000102030405060708090a0b0c - info: 0xf0f1f2f3f4f5f6f7f8f9 - L: 42 K\u1ebft qu\u1ea3 OKM (hex b\u1eaft \u0111\u1ea7u): 0x3cb25f25faacd57a90434f64d0362f2a2d2d... (\u0110\u1ec3 ki\u1ec3m tra chi ti\u1ebft, s\u1eed d\u1ee5ng RFC 5869 test vectors.)</p>"},{"location":"algorithms/kdf/hkdf/#11-code-v\u00ed-d\u1ee5-ng\u1eafn-python","title":"11/ Code (v\u00ed d\u1ee5 ng\u1eafn, Python)","text":"Python<pre><code>import hmac, hashlib\n\ndef hkdf_extract(salt, ikm, hash=hashlib.sha256):\n        if not salt:\n                salt = b'\\x00' * hash().digest_size\n        return hmac.new(salt, ikm, hash).digest()\n\ndef hkdf_expand(prk, info, length, hash=hashlib.sha256):\n        n = (length + hash().digest_size - 1) // hash().digest_size\n        okm = b''\n        t = b''\n        for i in range(1, n+1):\n                t = hmac.new(prk, t + (info or b'') + bytes([i]), hash).digest()\n                okm += t\n        return okm[:length]\n</code></pre>"},{"location":"algorithms/kdf/hkdf/#12-checklist-b\u1ea3o-m\u1eadt-ng\u1eafn","title":"12/ Checklist b\u1ea3o m\u1eadt (ng\u1eafn)","text":"<ul> <li> Ch\u1ecdn hash th\u00edch h\u1ee3p (SHA-256/512).</li> <li> Salt c\u00f3 entropy khi IKM y\u1ebfu.</li> <li> D\u00f9ng info kh\u00e1c nhau cho t\u1eebng m\u1ee5c \u0111\u00edch/version.</li> <li> Ki\u1ec3m tra L &lt;= 255*HashLen.</li> <li> Th\u1ef1c hi\u1ec7n so s\u00e1nh, l\u01b0u tr\u1eef kh\u00f3a an to\u00e0n (constant-time).</li> </ul>"},{"location":"algorithms/kdf/hkdf/#13-h\u1ea1n-ch\u1ebf","title":"13/ H\u1ea1n ch\u1ebf","text":"<ul> <li>Kh\u00f4ng t\u0103ng c\u01b0\u1eddng m\u1eadt kh\u1ea9u y\u1ebfu (d\u00f9ng PBKDF2/Argon2 cho m\u1eadt kh\u1ea9u).</li> <li>Kh\u00f4ng b\u1ea3o v\u1ec7 kh\u1ecfi leakage b\u00ean ngo\u00e0i n\u1ebfu IKM b\u1ecb l\u1ed9.</li> </ul>"},{"location":"algorithms/kdf/hkdf/#14-\u1ee9ng-d\u1ee5ng","title":"14/ \u1ee8ng d\u1ee5ng","text":"<ul> <li>Sinh key cho AEAD, MAC, session keys, key separation trong h\u1ec7 th\u1ed1ng l\u01b0u tr\u1eef m\u00e3 h\u00f3a.</li> </ul>"},{"location":"algorithms/kdf/hkdf/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15/ Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 5869 \u2014 HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</li> <li>Kelsey, H., &amp; HMAC papers / t\u00e0i li\u1ec7u HMAC, t\u00e0i li\u1ec7u hash primitives</li> <li>Kho l\u01b0u tr\u1eef m\u00e3 ngu\u1ed3n: v\u00ed d\u1ee5 tri\u1ec3n khai OpenSSL, libsodium (tham kh\u1ea3o)</li> </ul>"},{"location":"algorithms/kdf/pbkdf2/","title":"Pbkdf2","text":""},{"location":"algorithms/kdf/pbkdf2/#0-filevault-context","title":"0. FileVault context","text":"<p>PBKDF2 \u0111\u01b0\u1ee3c FileVault h\u1ed7 tr\u1ee3 cho t\u01b0\u01a1ng th\u00edch ng\u01b0\u1ee3c v\u00e0 ch\u1ebf \u0111\u1ed9 <code>STUDENT</code> / <code>WEAK</code>. Kh\u00f4ng khuy\u1ebfn ngh\u1ecb cho h\u1ec7 th\u1ed1ng m\u1edbi n\u1ebfu c\u00f3 th\u1ec3 d\u00f9ng Argon2id.</p>"},{"location":"algorithms/kdf/pbkdf2/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n \u2014 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>PBKDF2 bi\u1ebfn m\u1eadt kh\u1ea9u (c\u00f3 entropy th\u1ea5p) th\u00e0nh kh\u00f3a m\u1eadt m\u00e3 m\u1ea1nh h\u01a1n b\u1eb1ng c\u00e1ch \"k\u00e9o d\u00e0i\" (stretching) v\u00e0 th\u00eam salt \u0111\u1ec3 ch\u1ed1ng rainbow tables v\u00e0 l\u00e0m t\u1ea5n c\u00f4ng brute-force ngo\u1ea1i tuy\u1ebfn t\u1ed1n th\u1eddi gian h\u01a1n. B\u1ea3o v\u1ec7: t\u00ednh to\u00e0n v\u1eb9n/\u0111\u1ed9 b\u00ed m\u1eadt c\u1ee7a kh\u00f3a d\u1eabn xu\u1ea5t kh\u1ecfi t\u1ea5n c\u00f4ng brute-force/offline.</p>"},{"location":"algorithms/kdf/pbkdf2/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/kdf/pbkdf2/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft-b\u01b0\u1edbc","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft b\u01b0\u1edbc)","text":"<ol> <li>Sinh salt (ng\u1eabu nhi\u00ean, &gt;=16 bytes).  </li> <li>V\u1edbi m\u1ed7i kh\u1ed1i ch\u1ec9 m\u1ee5c \\(i\\), t\u00ednh \\(U_1 = PRF(P, S||INT(i))\\).  </li> <li>L\u1eb7p \\(c-1\\) l\u1ea7n: \\(U_j = PRF(P, U_{j-1})\\) v\u00e0 XOR v\u00e0o \\(T_i\\).  </li> <li>N\u1ed1i c\u00e1c \\(T_i\\) l\u1ea5y \\(DK\\) \u0111\u1ed9 d\u00e0i mong mu\u1ed1n.</li> </ol>"},{"location":"algorithms/kdf/pbkdf2/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>salt: byte[], duy nh\u1ea5t, &gt;=16 bytes.  </li> <li>iterations \\(c\\): integer (chi ph\u00ed th\u1eddi gian).  </li> <li>PRF: HMAC-SHA256 / HMAC-SHA512.  </li> <li>dklen: s\u1ed1 byte \u0111\u1ea7u ra mong mu\u1ed1n.</li> </ul>"},{"location":"algorithms/kdf/pbkdf2/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>Argon2id: memory-hard \u2192 kh\u00e1ng GPU/ASIC t\u1ed1t h\u01a1n. Khuy\u1ebfn ngh\u1ecb cho m\u1eadt kh\u1ea9u ng\u01b0\u1eddi d\u00f9ng.  </li> <li>scrypt: memory-hard nh\u01b0ng c\u1ea5u h\u00ecnh ph\u1ee9c t\u1ea1p h\u01a1n.  </li> <li>bcrypt: t\u1ed1t, nh\u01b0ng gi\u1edbi h\u1ea1n \u0111\u1ed9 d\u00e0i salt/kh\u00f3a; \u00edt linh ho\u1ea1t h\u01a1n so v\u1edbi Argon2id. PBKDF2: CPU-bound, d\u1ec5 t\u1ed1i \u01b0u tr\u00ean GPU/ASIC \u2192 c\u1ea7n iterations r\u1ea5t l\u1edbn \u0111\u1ec3 b\u00f9.</li> </ul>"},{"location":"algorithms/kdf/pbkdf2/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart LR\n    A[Password P] --&gt; B[\"PRF(P, Salt || INT(i))\"]\n    B --&gt; C[U1]\n\n    subgraph Iteration [Iterations]\n        direction LR\n        C --&gt; D[\"PRF(P, Uj)\"]\n        D --&gt; E[\"U(j+1)\"]\n        E --&gt; D\n    end\n\n    C --&gt; F[\"XOR(U1 ... Uc)\"]\n    F --&gt; G[\"Ti (block key)\"]\n    G --&gt; H[\"Concatenate T1 ... Tn\"]\n    H --&gt; I[\"Derived Key (DK)\"]\n</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/kdf/pbkdf2/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>S\u1eed d\u1ee5ng salt c\u1ed1 \u0111\u1ecbnh ho\u1eb7c thi\u1ebfu salt.  </li> <li>Iterations qu\u00e1 th\u1ea5p (d\u1ec5 brute-force).  </li> <li>D\u00f9ng PRF y\u1ebfu (MD5/SHA1) thay cho HMAC-SHA256/512.  </li> <li>Reuse salt cho nhi\u1ec1u user/kh\u00f3a.  </li> <li>So s\u00e1nh k\u1ebft qu\u1ea3 kh\u00f4ng constant-time (timing leak).  </li> <li>L\u01b0u tr\u1eef iterations/salt/params kh\u00f4ng r\u00f5 r\u00e0ng.</li> </ul>"},{"location":"algorithms/kdf/pbkdf2/#8-threat-model-t\u1ea5n-c\u00f4ng-ch\u00ednh","title":"8. Threat Model (t\u1ea5n c\u00f4ng ch\u00ednh)","text":"<ul> <li>Attacker c\u00f3 b\u1ea3n sao hash/DK (offline brute-force).  </li> <li>Attacker d\u00f9ng GPU/ASIC \u0111\u1ec3 t\u0103ng t\u1ed1c th\u1eed m\u1eadt kh\u1ea9u.  </li> <li>Server b\u1ecb l\u1ed9 salt/params.  </li> <li>Side-channel/timing attack khi so s\u00e1nh.</li> </ul>"},{"location":"algorithms/kdf/pbkdf2/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>\u01afu ti\u00ean Argon2id khi kh\u1ea3 d\u1ee5ng.  </li> <li>Salt ng\u1eabu nhi\u00ean, duy nh\u1ea5t, &gt;=16 bytes.  </li> <li>Ch\u1ecdn iterations sao cho thao t\u00e1c derivation ~0.5\u20131s tr\u00ean target hardware (NIST khuy\u1ebfn ngh\u1ecb t\u0103ng nhi\u1ec1u).  </li> <li>D\u00f9ng HMAC-SHA256 ho\u1eb7c HMAC-SHA512 l\u00e0m PRF.  </li> <li>L\u01b0u r\u00f5 params (salt, iterations, PRF) c\u00f9ng DK.  </li> <li>So s\u00e1nh constant-time; gi\u1edbi h\u1ea1n t\u1ed1c \u0111\u1ed9/kh\u00f3a t\u00e0i kho\u1ea3n; c\u00e2n nh\u1eafc pepper server-side n\u1ebfu ph\u00f9 h\u1ee3p.</li> </ul>"},{"location":"algorithms/kdf/pbkdf2/#10-test-vectors-t\u1ea1o-b\u1eb1ng-code","title":"10. Test Vectors (t\u1ea1o b\u1eb1ng code)","text":"<p>S\u1eed d\u1ee5ng Python builtin <code>hashlib.pbkdf2_hmac</code> \u0111\u1ec3 sinh v\u00e0 ki\u1ec3m tra vectors reproducible.</p> Python<pre><code>import binascii, hashlib\n\ndef pbkdf2_hex(password, salt, iterations, dklen, algo='sha256'):\n        dk = hashlib.pbkdf2_hmac(algo, password.encode(), salt, iterations, dklen)\n        return binascii.hexlify(dk).decode()\n\n# V\u00ed d\u1ee5\nprint(pbkdf2_hex(\"password\", b\"salt\", 1, 32, 'sha256'))\nprint(pbkdf2_hex(\"password\", b\"salt\", 600000, 32, 'sha256'))\n</code></pre> <p>(Ch\u1ea1y tr\u00ean m\u00f4i tr\u01b0\u1eddng b\u1ea1n tin c\u1eady \u0111\u1ec3 thu test vectors c\u1ee5 th\u1ec3; kh\u00f4ng \u0111\u01b0a values c\u1ee9ng n\u1ebfu kh\u00f4ng x\u00e1c th\u1ef1c.)</p>"},{"location":"algorithms/kdf/pbkdf2/#11-code-v\u00ed-d\u1ee5-ng\u1eafn-python","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn Python)","text":"Python<pre><code>from hashlib import pbkdf2_hmac\ndef derive(password: str, salt: bytes, iterations: int = 600000, dklen: int = 32):\n        return pbkdf2_hmac('sha256', password.encode(), salt, iterations, dklen)\n</code></pre>"},{"location":"algorithms/kdf/pbkdf2/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist B\u1ea3o M\u1eadt","text":"<ul> <li> C\u00f3 th\u1ec3 chuy\u1ec3n sang Argon2id kh\u00f4ng?  </li> <li> Salt ng\u1eabu nhi\u00ean, &gt;=16 bytes cho m\u1ed7i user.  </li> <li> L\u01b0u iterations v\u00e0 PRF c\u00f9ng v\u1edbi DK.  </li> <li> \u0110\u1eb7t iterations sao cho derivation cost ~0.5\u20131s (t\u00f9y m\u00f4i tr\u01b0\u1eddng).  </li> <li> D\u00f9ng HMAC-SHA256/512, kh\u00f4ng d\u00f9ng MD5/SHA1.  </li> <li> So s\u00e1nh constant-time.  </li> <li> H\u1ea1n ch\u1ebf rate v\u00e0 gi\u00e1m s\u00e1t login th\u1eed nhi\u1ec1u l\u1ea7n.  </li> <li> Xem x\u00e9t pepper n\u1ebfu r\u1ee7i ro server leak cao.</li> </ul> <p>T\u00e0i li\u1ec7u tham kh\u1ea3o - RFC 2898 / RFC 8018 (PKCS #5) \u2014 PBKDF2. - OWASP Password Storage Cheat Sheet. - Argon2 paper &amp; documentation. - NIST guidance (authentication/password handling).</p>"},{"location":"algorithms/kdf/scrypt/","title":"Scrypt","text":""},{"location":"algorithms/kdf/scrypt/#0-filevault-context","title":"0. Filevault context","text":"<p>T\u00e0i li\u1ec7u n\u00e0y t\u00f3m t\u1eaft scrypt (RFC 7914) \u0111\u1ec3 s\u1eed d\u1ee5ng trong Filevault: m\u1ee5c \u0111\u00edch, c\u1ea5u tr\u00fac, r\u1ee7i ro b\u1ea3o m\u1eadt, test vectors, v\u00e0 checklist tri\u1ec3n khai an to\u00e0n.</p>"},{"location":"algorithms/kdf/scrypt/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n \u2014 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Scrypt l\u00e0 m\u1ed9t Key Derivation Function (KDF) memory\u2011hard, thi\u1ebft k\u1ebf \u0111\u1ec3 l\u00e0m t\u1ed1n nhi\u1ec1u b\u1ed9 nh\u1edb v\u00e0 chi ph\u00ed ph\u1ea7n c\u1ee9ng khi th\u1ef1c hi\u1ec7n t\u1ea5n c\u00f4ng brute\u2011force (\u0111\u1eb7c bi\u1ec7t b\u1eb1ng ASIC/FPGA). D\u00f9ng \u0111\u1ec3 d\u1eabn xu\u1ea5t kh\u00f3a t\u1eeb m\u1eadt kh\u1ea9u, b\u1ea3o v\u1ec7 kho\u00e1 b\u00ed m\u1eadt, m\u1eadt kh\u1ea9u l\u01b0u tr\u1eef v\u00e0 c\u00e1c tr\u01b0\u1eddng h\u1ee3p ph\u1ea3i ch\u1ed1ng t\u1ea5n c\u00f4ng song song/ASIC.</p>"},{"location":"algorithms/kdf/scrypt/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/kdf/scrypt/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ol> <li>Kh\u1edfi t\u1ea1o: s\u1eed d\u1ee5ng PBKDF2-HMAC-SHA256 v\u1edbi m\u1eadt kh\u1ea9u/salt \u0111\u1ec3 sinh c\u00e1c kh\u1ed1i ban \u0111\u1ea7u.</li> <li>ROMix/V: th\u1ef1c hi\u1ec7n \\(N\\) l\u1ea7n v\u00f2ng \u0111\u1ec3 t\u1ea1o b\u1ea3ng ph\u1ee5 thu\u1ed9c b\u1ed9 nh\u1edb (mixing) d\u1ef1a tr\u00ean Salsa20/8 (tr\u01b0\u1edbc \u0111\u00e2y) ho\u1eb7c c\u00e1c h\u00e0m n\u1ed9i b\u1ed9.</li> <li>Sau khi mix, d\u00f9ng PBKDF2-HMAC-SHA256 \u0111\u1ec3 tr\u00edch xu\u1ea5t kh\u00f3a cu\u1ed1i c\u00f9ng. M\u1ee5c ti\u00eau: bu\u1ed9c k\u1ebb t\u1ea5n c\u00f4ng l\u01b0u gi\u1eef b\u1ea3ng \u0111\u1ed9 l\u1edbn \\(N\\) \u0111\u1ec3 l\u1eb7p l\u1ea1i nhanh.</li> </ol>"},{"location":"algorithms/kdf/scrypt/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>V: m\u1ea3ng \u0111\u1ed9 d\u00e0i \\(N\\) c\u1ee7a blocks k\u00edch th\u01b0\u1edbc \\(128\\cdot r\\) bytes (t\u1ed5ng l\u1edbn nh\u1ea5t l\u00e0 b\u1ed9 nh\u1edb ch\u00ednh y\u1ebfu).</li> <li>Blocks: m\u1ed7i block n\u1ed9i dung 128\u00b7r bytes, thao t\u00e1c b\u1eb1ng XOR, scrypt s\u1eed d\u1ee5ng h\u00e0m Salsa/BlockMix \u0111\u1ec3 tr\u1ed9n.</li> <li>State: buffer t\u1ea1m cho PBKDF2 v\u00e0 BlockMix.</li> </ul>"},{"location":"algorithms/kdf/scrypt/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>Argon2: linh ho\u1ea1t h\u01a1n (\u0111\u1ed9c l\u1eadp th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb), t\u1ed1t h\u01a1n v\u1edbi side\u2011channel, \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf hi\u1ec7n \u0111\u1ea1i h\u01a1n.</li> <li>PBKDF2: CPU\u2011bound, \u00edt ch\u1ed1ng ph\u1ea7n c\u1ee9ng (ASIC) h\u01a1n v\u00ec kh\u00f4ng memory\u2011hard.</li> <li>Bcrypt: gi\u1edbi h\u1ea1n b\u1ed9 nh\u1edb nh\u1ecf h\u01a1n, an to\u00e0n th\u1eddi \u0111i\u1ec3m ra \u0111\u1eddi nh\u01b0ng c\u0169 h\u01a1n scrypt/Argon2.</li> </ul>"},{"location":"algorithms/kdf/scrypt/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (Mermaid)","text":"<pre><code>flowchart LR\n    A[Input: password, salt, N,r,p,dkLen] --&gt; B[PBKDF2-HMAC-SHA256: init]\n    B --&gt; C[Split th\u00e0nh p instance]\n    C --&gt; D[\"For each instance: ROMix (N loops) using BlockMix\"]\n    D --&gt; E[Concat outputs]\n    E --&gt; F[PBKDF2-HMAC-SHA256: final derive dkLen]\n    F --&gt; G[Output: derived key]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/kdf/scrypt/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Ch\u1ecdn \\(N\\) qu\u00e1 nh\u1ecf (kh\u00f4ng \u0111\u1ee7 memory cost).</li> <li>Thi\u1ebfu ki\u1ec3m tra overflow/\u0111i\u1ec1u ki\u1ec7n gi\u1edbi h\u1ea1n (N ph\u1ea3i l\u00e0 power of 2).</li> <li>T\u00e1i s\u1eed d\u1ee5ng salt ho\u1eb7c salt qu\u00e1 ng\u1eafn.</li> <li>C\u1ed1 g\u1eafng ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb b\u1eb1ng c\u00e1ch l\u01b0u tr\u1eef kh\u00f4ng \u0111\u1ea7y \u0111\u1ee7 V (gi\u1ea3m t\u00ednh memory\u2011hard).</li> <li>Kh\u00f4ng gi\u1edbi h\u1ea1n \\(p\\) theo kh\u1ea3 n\u0103ng b\u1ed9 nh\u1edb (d\u1eabn \u0111\u1ebfn OOM).</li> </ul>"},{"location":"algorithms/kdf/scrypt/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u1ed1 g\u1eafng brute\u2011force m\u1eadt kh\u1ea9u b\u1eb1ng ph\u1ea7n c\u1ee9ng chuy\u00ean d\u1ee5ng (ASIC/FPGA/GPU).</li> <li>M\u1ee5c ti\u00eau: gi\u1ea3m throughput t\u1ea5n c\u00f4ng b\u1eb1ng c\u00e1ch t\u0103ng chi ph\u00ed b\u1ed9 nh\u1edb v\u00e0/ho\u1eb7c th\u1eddi gian.</li> <li>Gi\u1ea3 \u0111\u1ecbnh: attacker c\u00f3 salt v\u00e0 tham s\u1ed1 (\\(N,r,p\\)) \u2013 salt kh\u00f4ng ph\u1ea3i b\u00ed m\u1eadt.</li> </ul>"},{"location":"algorithms/kdf/scrypt/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Ch\u1ecdn \\(N\\) l\u1edbn \u0111\u1ee7 khi\u1ebfn ASIC \u0111\u1eaft \u0111\u1ecf; \u0111i\u1ec1u ch\u1ec9nh theo m\u00f4i tr\u01b0\u1eddng (v\u00ed d\u1ee5 server vs embedded).</li> <li>Salt ng\u1eabu nhi\u00ean, \u0111\u1ed9 d\u00e0i &gt;= 16 bytes.</li> <li>Thi\u1ebft k\u1ebf gi\u1edbi h\u1ea1n \\(p\\) theo RAM c\u00f3 s\u1eb5n \u0111\u1ec3 tr\u00e1nh OOM.</li> <li>C\u00e2n nh\u1eafc Argon2 (Argon2id) n\u1ebfu c\u1ea7n kh\u00e1ng side\u2011channel t\u1ed1t h\u01a1n.</li> <li>D\u00f9ng th\u01b0 vi\u1ec7n \u0111\u00e3 \u0111\u01b0\u1ee3c review, tr\u00e1nh tri\u1ec3n khai t\u1eeb \u0111\u1ea7u.</li> </ul>"},{"location":"algorithms/kdf/scrypt/#10-test-vectors-rfc-7914","title":"10. Test Vectors (RFC 7914)","text":"<ul> <li>Vector 1:<ul> <li>password: \"password\"</li> <li>salt: \"NaCl\"</li> <li>N=1024, r=8, p=16, dkLen=64</li> <li>derived (hex):     fdbabe1c9d3472007856e7190d01e9fe7c6ad7cbc8237830e77376634b373162     2eaf30d92e22a3886ff109279d9830dac727afb94a83ee6d8360cbdfa2cc0640</li> </ul> </li> <li>Vector 2:<ul> <li>password: \"pleaseletmein\"</li> <li>salt: \"SodiumChloride\"</li> <li>N=16384, r=8, p=1, dkLen=64</li> <li>derived (hex):     7023bdcb3afd7348461c06cd81fd38ebfda8fbba904f8e3ea9b543f6545da1f2     d5432955613f0fcf62d49705242a9af9</li> </ul> </li> </ul>"},{"location":"algorithms/kdf/scrypt/#11-code-v\u00ed-d\u1ee5-ng\u1eafn","title":"11. Code (v\u00ed d\u1ee5 ng\u1eafn)","text":"<ul> <li>Node.js (crypto.scrypt): JavaScript<pre><code>const { scryptSync } = require('crypto');\nconst dk = scryptSync('password', 'NaCl', 64, { N:1024, r:8, p:16 });\nconsole.log(dk.toString('hex'));\n</code></pre></li> <li>Python (pyscrypt ho\u1eb7c hashlib.scrypt khi c\u00f3): Python<pre><code>import hashlib\ndk = hashlib.scrypt(b'password', salt=b'NaCl', n=1024, r=8, p=16, dklen=64)\nprint(dk.hex())\n</code></pre></li> </ul>"},{"location":"algorithms/kdf/scrypt/#12-checklist-b\u1ea3o-m\u1eadt-nhanh","title":"12. Checklist b\u1ea3o m\u1eadt (nhanh)","text":"<ul> <li> Salt ng\u1eabu nhi\u00ean, \u0111\u1ed9 d\u00e0i &gt;= 16 bytes.</li> <li> N l\u00e0 power of 2 v\u00e0 \u0111\u1ee7 l\u1edbn cho m\u00f4i tr\u01b0\u1eddng.</li> <li> r/p ph\u00f9 h\u1ee3p v\u1edbi b\u1ed9 nh\u1edb/CPU.</li> <li> D\u00f9ng th\u01b0 vi\u1ec7n ch\u00ednh th\u1ed1ng, kh\u00f4ng tri\u1ec3n khai custom crypto primitives.</li> <li> Ki\u1ec3m tra OOM/exception handling.</li> <li> L\u01b0u metadata tham s\u1ed1 (N,r,p,salt) c\u00f9ng v\u1edbi derived key.</li> <li> C\u00e2n nh\u1eafc Argon2 n\u1ebfu c\u1ea7n kh\u00e1ng side\u2011channel t\u1ed1t h\u01a1n.</li> </ul>"},{"location":"algorithms/kdf/scrypt/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 7914 \u2014 scrypt: https://datatracker.ietf.org/doc/html/rfc7914</li> <li>T\u00e0i li\u1ec7u Argon2 (for comparison): https://www.cryptolib.org/argon2</li> <li>B\u00e0i b\u00e1o g\u1ed1c scrypt: Colin Percival (t\u00e0i li\u1ec7u k\u1ef9 thu\u1eadt)</li> </ul>"},{"location":"algorithms/pqc/dilithium/","title":"Dilithium","text":""},{"location":"algorithms/pqc/dilithium/#0-filevault-context","title":"0/ Filevault context","text":"<ul> <li>N\u1ed9i dung: t\u00f3m t\u1eaft, to\u00e1n h\u1ecdc, v\u1eadn h\u00e0nh, tri\u1ec3n khai, ki\u1ec3m th\u1eed, gi\u1ea3m thi\u1ec3u r\u1ee7i ro, tham kh\u1ea3o.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n","title":"1/ Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n","text":"<ul> <li>CRYSTALS\u2011Dilithium l\u00e0 m\u1ed9t ch\u1eef k\u00fd s\u1ed1 h\u1eadu l\u01b0\u1ee3ng t\u1eed (post\u2011quantum digital signature).  </li> <li>Gi\u1ea3i quy\u1ebft: x\u00e1c th\u1ef1c t\u00ednh to\u00e0n v\u1eb9n v\u00e0 ngu\u1ed3n g\u1ed1c d\u1eef li\u1ec7u ch\u1ed1ng l\u1ea1i k\u1ebb t\u1ea5n c\u00f4ng c\u00f3 m\u00e1y t\u00ednh l\u01b0\u1ee3ng t\u1eed.  </li> <li>B\u1ea3o v\u1ec7: t\u00ednh x\u00e1c th\u1ef1c (authenticity), t\u00ednh to\u00e0n v\u1eb9n (integrity), ch\u1ed1ng gi\u1ea3 m\u1ea1o ch\u1eef k\u00fd.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c-markdown-math","title":"2/ To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c (markdown math)","text":""},{"location":"algorithms/pqc/dilithium/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3/ C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":""},{"location":"algorithms/pqc/dilithium/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4/ C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>R\u0103ng bu\u1ed9c: polyn\u00f4m c\u1ee1 \\(n\\) (e.g., \\(n=256\\)), l\u01b0u d\u01b0\u1edbi d\u1ea1ng coeffs modulo \\(q\\).  </li> <li>Vect\u01a1: \\(s_1,s_2,t\\) l\u00e0 vect\u01a1 polyn\u00f4m d\u00e0i \\(l,k\\) t\u00f9y tham s\u1ed1.  </li> <li>Encoding: d\u00f9ng packer bit \u0111\u1ec3 n\u00e9n \\(t\\) v\u00e0 ch\u1eef k\u00fd (ch\u00fa \u00fd n\u00e9n t0/t1, s\u1eed d\u1ee5ng gi\u00fap ti\u1ebft ki\u1ec7m b\u0103ng th\u00f4ng).</li> </ul>"},{"location":"algorithms/pqc/dilithium/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5/ So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi ECDSA/RSA: h\u1eadu l\u01b0\u1ee3ng t\u1eed (kh\u00f4ng d\u1ef1a tr\u00ean r\u1eddi r\u1ea1c logarit hay RSA).  </li> <li>So v\u1edbi SPHINCS+: Dilithium nhanh h\u01a1n, k\u00edch th\u01b0\u1edbc ch\u1eef k\u00fd nh\u1ecf h\u01a1n SPHINCS+ nh\u01b0ng an to\u00e0n d\u1ef1a tr\u00ean lattice.  </li> <li>So v\u1edbi Falcon: Falcon c\u00f3 ch\u1eef k\u00fd nh\u1ecf h\u01a1n \u1edf m\u1ee9c m\u1ed9t s\u1ed1 tham s\u1ed1 nh\u01b0ng Dilithium thi\u00ean v\u1ec1 \u0111\u01a1n gi\u1ea3n v\u00e0 an to\u00e0n theo ch\u1ee9ng minh.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6/ Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart LR\n    KG[KeyGen] --&gt;|A,t| PK[Public Key]\n    KG --&gt;|s1,s2| SK[Private Key]\n    M[Message] --&gt; SIGN[Sign]\n    SK --&gt; SIGN\n    SIGN --&gt; SIG[(z,c)]\n    SIG --&gt; VERIFY[Verify]\n    PK --&gt; VERIFY\n    M --&gt; VERIFY\n    VERIFY --&gt;|accept/reject| OUT[Result]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/pqc/dilithium/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7/ C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>R\u00f2 r\u1ec9 nonce/randomness (y) \u21d2 ph\u1ee5c h\u1ed3i kh\u00f3a b\u00ed m\u1eadt.  </li> <li>Kh\u00f4ng ki\u1ec3m tra gi\u1edbi h\u1ea1n \\(z\\) v\u00e0 v\u00f2ng ph\u1ee7 \u21d2 d\u1eabn \u0111\u1ebfn forge.  </li> <li>Bi\u1ebfn \u0111\u1ed5i s\u1ed1 h\u1ecdc kh\u00f4ng theo modulo chu\u1ea9n (overflow).  </li> <li>L\u01b0u tr\u1eef kh\u00f3a/buffer kh\u00f4ng s\u1ea1ch (no zeroize).  </li> <li>Side\u2011channel: th\u1eddi gian, cache, \u0111o c\u00f4ng su\u1ea5t.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#8-threat-model","title":"8/ Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 kh\u1ea3 n\u0103ng: passive eavesdrop, chosen\u2011message, side\u2011channel (timing, cache, power).  </li> <li>M\u1ee5c ti\u00eau: ph\u1ee5c h\u1ed3i kh\u00f3a ri\u00eang, t\u1ea1o ch\u1eef k\u00fd gi\u1ea3, g\u00e2y t\u1eeb ch\u1ed1i d\u1ecbch v\u1ee5 (resource exhaustion).  </li> <li>Gi\u1ea3 s\u1eed: k\u1ebb t\u1ea5n c\u00f4ng c\u00f3 m\u00e1y t\u00ednh l\u01b0\u1ee3ng t\u1eed c\u1ee7a NISQ/\u0111\u1ea7y \u0111\u1ee7 (Dilithium an to\u00e0n theo gi\u1ea3 thi\u1ebft lattice kh\u00f3 gi\u1ea3i).</li> </ul>"},{"location":"algorithms/pqc/dilithium/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9/ Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>S\u1eed d\u1ee5ng RNG an to\u00e0n, l\u1ea5y y ho\u00e0n to\u00e0n ng\u1eabu nhi\u00ean.  </li> <li>Ki\u1ec3m tra \u0111\u1ea7y \u0111\u1ee7 c\u00e1c r\u00e0ng bu\u1ed9c (norm bounds).  </li> <li>Implement constant\u2011time cho c\u00e1c ph\u00e9p to\u00e1n then ch\u1ed1t (NTT, inner product packing).  </li> <li>Zeroize kho\u00e1 sau s\u1eed d\u1ee5ng, b\u1ea3o v\u1ec7 mem.  </li> <li>K\u1ec3 c\u1ea3 detection v\u00e0 rate\u2011limiting \u0111\u1ec3 ch\u1ed1ng chosen\u2011message abuse.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#10-test-vectors","title":"10/ Test Vectors","text":"<ul> <li>Format: message (hex), public key (hex), signature (hex).  </li> <li>V\u00ed d\u1ee5 m\u1eabu (kh\u00f4ng ph\u1ea3i vector ch\u00ednh th\u1ee9c):<ul> <li>message: 48656c6c6f (ASCII \"Hello\")  </li> <li>pk: 0a1b2c... (hex, placeholder)  </li> <li>sig: ffeedd... (hex, placeholder)  </li> </ul> </li> <li>L\u1ea5y test vectors ch\u00ednh th\u1ee9c t\u1eeb PQClean / NIST submission \u0111\u1ec3 ki\u1ec3m tra t\u01b0\u01a1ng th\u00edch.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#11-code","title":"11/ Code","text":"<ul> <li>C\u00f3 th\u1ec3 tham chi\u1ebfu PQClean impls, liboqs, reference specs. (B\u1ecf qua code \u1edf \u0111\u00e2y.)</li> </ul>"},{"location":"algorithms/pqc/dilithium/#12-checklist-b\u1ea3o-m\u1eadt-t\u1ed1i-thi\u1ec3u","title":"12/ Checklist b\u1ea3o m\u1eadt (t\u1ed1i thi\u1ec3u)","text":"<ul> <li> RNG \u0111\u01b0\u1ee3c audit v\u00e0 seed an to\u00e0n  </li> <li> Ki\u1ec3m tra gi\u1edbi h\u1ea1n z, t0/t1 \u0111\u00fang  </li> <li> M\u1ecdi thao t\u00e1c nh\u1ea1y c\u1ea3m constant\u2011time  </li> <li> Memory zeroized khi k\u1ebft th\u00fac  </li> <li> Test vectors ch\u00ednh th\u1ee9c passed  </li> <li> Fuzz v\u00e0 property tests v\u1edbi PQClean vectors</li> </ul>"},{"location":"algorithms/pqc/dilithium/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13/ H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>K\u00edch th\u01b0\u1edbc kh\u00f3a v\u00e0 ch\u1eef k\u00fd l\u1edbn h\u01a1n ECC truy\u1ec1n th\u1ed1ng.  </li> <li>Tri th\u1ee9c to\u00e1n h\u1ecdc (lattice) ph\u1ee9c t\u1ea1p, sai tri\u1ec3n khai d\u1ec5 g\u00e2y m\u1ea5t an to\u00e0n.  </li> <li>Hi\u1ec7u n\u0103ng ph\u1ee5 thu\u1ed9c m\u1ea1nh v\u00e0o t\u1ed1i \u01b0u NTT v\u00e0 packing.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#14-\u1ee9ng-d\u1ee5ng","title":"14/ \u1ee8ng d\u1ee5ng","text":"<ul> <li>Ch\u1eef k\u00fd c\u01a1 s\u1edf cho PKI h\u1eadu l\u01b0\u1ee3ng t\u1eed, TLS, firmware signing, code signing, secure boot.</li> </ul>"},{"location":"algorithms/pqc/dilithium/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15/ Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>Original paper: CRYSTALS\u2011Dilithium authors (Dang, Ducas, Kiltz, Lepoint, Lyubashevsky, Poettering, Prest, Schwabe).  </li> <li>NIST PQC: https://csrc.nist.gov/projects/post-quantum-cryptography </li> <li>PQClean reference implementations: https://github.com/PQClean/PQClean </li> <li>IETF / RFC drafts and PQ implementations (libs: liboqs, OpenQuantumSafe).</li> </ul> <p>Ghi ch\u00fa: l\u1ea5y test vectors v\u00e0 tham kh\u1ea3o code t\u1eeb c\u00e1c repo ch\u00ednh th\u1ee9c \u0111\u1ec3 tr\u00e1nh sai l\u1ec7ch.</p>"},{"location":"algorithms/pqc/kyber/","title":"Kyber","text":""},{"location":"algorithms/pqc/kyber/#0-filevault-context","title":"0. FileVault context","text":"<ul> <li>M\u1ee5c ti\u00eau: cung c\u1ea5p KEM post\u2011quantum \u0111\u1ec3 hybrid v\u1edbi password\u2011based KDF \u2192 kh\u00f3a AES\u2011256\u2011GCM.</li> <li>Thi\u1ebft k\u1ebf: m\u1eb7c \u0111\u1ecbnh Kyber\u2011768; tu\u1ef3 ch\u1ecdn Kyber\u2011512 / Kyber\u20111024.</li> </ul>"},{"location":"algorithms/pqc/kyber/#1-kh\u00e1i-ni\u1ec7m--thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m \u2014 Thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<ul> <li>Kyber: Key\u2011Encapsulation Mechanism (KEM) d\u1ef1a tr\u00ean Module\u2011LWE.</li> <li>Gi\u1ea3i quy\u1ebft: thi\u1ebft l\u1eadp shared secret b\u00ed m\u1eadt gi\u1eefa hai b\u00ean; kh\u00f4ng m\u00e3 ho\u00e1 d\u1eef li\u1ec7u tr\u1ef1c ti\u1ebfp.</li> <li>B\u1ea3o v\u1ec7: an to\u00e0n tr\u01b0\u1edbc t\u1ea5n c\u00f4ng s\u1eed d\u1ee5ng m\u00e1y t\u00ednh l\u01b0\u1ee3ng t\u1eed (d\u1ef1a tr\u00ean hardness c\u1ee7a LWE/Module\u2011LWE). H\u1eefu \u00edch \u0111\u1ec3 ch\u1ed1ng \"harvest\u2011now, decrypt\u2011later\".</li> </ul>"},{"location":"algorithms/pqc/kyber/#2-to\u00e1n-h\u1ecdc--c\u00f4ng-th\u1ee9c-math-markdown","title":"2. To\u00e1n h\u1ecdc &amp; c\u00f4ng th\u1ee9c (math markdown)","text":"<ul> <li>D\u1ecbch v\u1ee5 n\u1ec1n t\u1ea3ng: LWE, Module\u2011LWE tr\u00ean v\u00f2ng \\(R_q=\\mathbb{Z}_q[X]/(X^n+1)\\).</li> <li>LWE: b\u1ec1n v\u1edbi nhi\u1ec5u \\(\\(b = A\\,s + e \\pmod q\\)\\)     v\u1edbi \\(A\\) public, \\(s\\) secret, \\(e\\) small error.</li> <li>Module\u2011LWE (Kyber): vect\u01a1/polynomial dimension \\(k\\), polynomial degree \\(n\\) (Kyber: \\(n=256\\), \\(q=3329\\)).</li> <li>Encapsulation/Decapsulation c\u01a1 b\u1ea3n:<ul> <li>KeyGen: \\(t = A s + e\\) \u2192 pk = \\((\\rho, t)\\), sk = \\(s\\).</li> <li>Encaps: ch\u1ecdn \\(r\\) t\u1eeb \\(m\\) \u2192 \\(u = A^T r + e_1\\), \\(v = t^T r + e_2 + \\lfloor q/2 \\rceil\\cdot \\text{encode}(m)\\).</li> <li>Decaps: t\u00ednh \\(v - s^T u \\approx \\lfloor q/2\\rceil\\cdot\\text{encode}(m)\\) r\u1ed3i decode \\(m\\).</li> </ul> </li> </ul>"},{"location":"algorithms/pqc/kyber/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft-flow","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft flow)","text":"<ul> <li>KeyGen \u2192 publish pk.</li> <li>Encaps(pk) \u2192 (ct, ss) g\u1eedi ct, gi\u1eef ss.</li> <li>Decaps(sk, ct) \u2192 ss' (FO transform: re\u2011encapsulate verify, tr\u00e1nh adaptive chosen\u2011ciphertext).</li> <li>K\u1ebft h\u1ee3p (FileVault): ss_kyber + ss_password \u2192 HKDF \u2192 AES\u2011256\u2011GCM key.</li> </ul> <p>Mermaid (flow): </p> <pre><code>flowchart LR\n    A[KeyGen] --&gt;|pk| B[Encaps]\n    B --&gt;|ct| C[Decaps]\n    B --&gt;|ss| D[HKDF combine]\n    E[Password KDF] --&gt; D\n    D --&gt; F[AES\u2011256\u2011GCM Encrypt]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/pqc/kyber/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u-sizes","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u (sizes)","text":"<ul> <li>Kyber\u2011512 / 768 / 1024:<ul> <li>Public key \u2248 800 / 1184 / 1568 B</li> <li>Private key \u2248 1632 / 2400 / 3168 B</li> <li>Ciphertext \u2248 768 / 1088 / 1568 B</li> <li>Shared secret = 32 B</li> </ul> </li> <li>N\u1ed9i dung: pk = seed \u03c1 + compressed t (polynomials); ct = compressed u + compressed v.</li> </ul>"},{"location":"algorithms/pqc/kyber/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>NTRU / SABER: c\u0169ng lattice/structured; k\u00edch th\u01b0\u1edbc &amp; hi\u1ec7u n\u0103ng kh\u00e1c.</li> <li>FrodoKEM: LWE unstructured \u2014 k\u00edch th\u01b0\u1edbc l\u1edbn h\u01a1n nh\u01b0ng less structure (different tradeoff).</li> <li>Classic McEliece: public key r\u1ea5t l\u1edbn, proven older hardness.</li> <li>SIKE: \u0111\u00e3 b\u1ecb ph\u00e1 \u2014 kh\u00f4ng d\u00f9ng.</li> <li>L\u1ef1a ch\u1ecdn: Kyber = t\u1ed1t cho hi\u1ec7u n\u0103ng, k\u00edch th\u01b0\u1edbc h\u1ee3p l\u00fd, chu\u1ea9n h\u00f3a NIST.</li> </ul>"},{"location":"algorithms/pqc/kyber/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-chi-ti\u1ebft-ng\u1eafn","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (chi ti\u1ebft ng\u1eafn)","text":"<ul> <li>KeyGen: seed \u03c1 \u2192 expand \u2192 t\u1ea1o A b\u1eb1ng PRNG \u2192 sample s,e \u2192 compute t.</li> <li>Encaps: derive randomness t\u1eeb m \u2192 x\u00e2y d\u1ef1ng u,v \u2192 compress \u2192 output ct, ss = H(m).</li> <li>Decaps: compute v \u2212 s^T u \u2192 decode m \u2192 verify b\u1eb1ng re\u2011encapsulation (FO) \u2192 derive ss.</li> </ul>"},{"location":"algorithms/pqc/kyber/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Sai sampling ph\u00e2n ph\u1ed1i l\u1ed7i (non\u2011constant, non\u2011bounded) \u2192 leak.</li> <li>Kh\u00f4ng validate/kh\u00f4ng \u00e1p d\u1ee5ng FO transform \u2192 adaptive CCA vulnerabilities.</li> <li>Kh\u00f4ng constant\u2011time arithmetic / NTT \u2192 side\u2011channel.</li> <li>N\u00e9n/serialize kh\u00f4ng \u0111\u00fang leading to incompatibility ho\u1eb7c leak.</li> <li>Reuse RNG ho\u1eb7c d\u00f9ng non\u2011cryptographic PRNG.</li> </ul>"},{"location":"algorithms/pqc/kyber/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Attacker: network eavesdrop + chosen\u2011ciphertext + side\u2011channel local attacker + long\u2011term store for harvest\u2011now decrypt\u2011later.</li> <li>Assumptions: attacker kh\u00f4ng c\u00f3 \u0111\u1ee7 QC \u0111\u1ec3 ph\u00e1 Module\u2011LWE ngay; nh\u01b0ng c\u00f3 th\u1ec3 thu th\u1eadp ciphertexts.</li> </ul>"},{"location":"algorithms/pqc/kyber/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>FO transform (or KEM with CCA protection).</li> <li>Constant\u2011time NTT, poly ops, and rejection sampling.</li> <li>Use CSPRNG for all sampling; avoid reusing nonces/seeds.</li> <li>Validate public keys and ciphertext lengths; reject malformed.</li> <li>Combine Kyber with classical AEAD (hybrid) for defense\u2011in\u2011depth.</li> <li>Limit exposure: rotate keys, enforce key usage policies.</li> </ul>"},{"location":"algorithms/pqc/kyber/#10-test-vectors-v\u00ed-d\u1ee5-ng\u1eafn","title":"10. Test Vectors (v\u00ed d\u1ee5 ng\u1eafn)","text":"<ul> <li>K\u00edch th\u01b0\u1edbc ki\u1ec3m tra Kyber\u2011768 (Botan):<ul> <li>pk length = 1184, sk length = 2400, ct length = 1088, ss = 32.</li> </ul> </li> <li>Minimal example (hex placeholders):<ul> <li>pk: 0x... (1184 B)</li> <li>ct: 0x... (1088 B)</li> <li>ss: 0x0123456789abcdef... (32 B)</li> </ul> </li> <li>Ch\u1ea1y t\u00edch h\u1ee3p unit test: KeyGen \u2192 Encaps \u2192 Decaps \u2192 ss match.</li> </ul>"},{"location":"algorithms/pqc/kyber/#11-code-v\u00ed-d\u1ee5-combine-keys--gi\u1eef-g\u1ecdn","title":"11. Code (v\u00ed d\u1ee5 combine keys \u2014 gi\u1eef g\u1ecdn)","text":"C++<pre><code>// Combine Kyber + password key \u2192 final AES key (HKDF-SHA256)\nstd::vector&lt;uint8_t&gt; combine_keys(\n    const std::vector&lt;uint8_t&gt;&amp; kyber_secret,\n    const std::vector&lt;uint8_t&gt;&amp; passwd_key) {\n    std::vector&lt;uint8_t&gt; ikm; ikm.reserve(kyber_secret.size()+passwd_key.size());\n    ikm.insert(ikm.end(), kyber_secret.begin(), kyber_secret.end());\n    ikm.insert(ikm.end(), passwd_key.begin(), passwd_key.end());\n    return hkdf_sha256(ikm, /*info=*/\"FileVault-Kyber-Hybrid-v1\", 32);\n}\n</code></pre> (Ghi ch\u00fa: hkdf_sha256 l\u00e0 wrapper an to\u00e0n; d\u00f9ng secure memory cho secret.)"},{"location":"algorithms/pqc/kyber/#12-checklist-b\u1ea3o-m\u1eadt-tr\u01b0\u1edbc-deploy","title":"12. Checklist b\u1ea3o m\u1eadt (tr\u01b0\u1edbc deploy)","text":"<ul> <li> S\u1eed d\u1ee5ng Kyber implementation ch\u00ednh th\u1ee9c / audited (Botan, PQClean,...).</li> <li> CCA protection (FO) ho\u1eb7c KEM \u0111\u00e3 CCA.</li> <li> Constant\u2011time NTT, rejection sampling.</li> <li> RNG: CSPRNG h\u1ec7 th\u1ed1ng (no deterministic/reused seeds).</li> <li> Validate sizes v\u00e0 formats cho pk/ct/sk.</li> <li> Zeroize secret material sau d\u00f9ng.</li> <li> Logging kh\u00f4ng ch\u1ee9a secret/keys.</li> <li> Key rotation &amp; lifetime policy.</li> <li> Hybrid mode enabled b\u1eb1ng m\u1eb7c \u0111\u1ecbnh.</li> <li> T\u00edch h\u1ee3p test vectors trong CI.</li> </ul> <p>Tham kh\u1ea3o - NIST FIPS 203 \u2014 Module\u2011Lattice\u2011Based KEM Standard: https://csrc.nist.gov/pubs/fips/203 - CRYSTALS\u2011Kyber: https://pq-crystals.org/kyber/ - PQClean / Botan implementations - NIST PQC project: https://csrc.nist.gov/projects/post-quantum-cryptography</p>"},{"location":"algorithms/pqc/pqc/","title":"Pqc","text":""},{"location":"algorithms/pqc/pqc/#0-filevault-context","title":"0/ Filevault context","text":"<ul> <li>V\u1ecb tr\u00ed: /d:/code/filevault/docs/algorithms/pqc/pqc.md</li> <li>M\u1ee5c ti\u00eau: cung c\u1ea5p khu\u00f4n m\u1eabu to\u00e0n di\u1ec7n cho thu\u1eadt to\u00e1n PQC (kh\u00e1i ni\u1ec7m, to\u00e1n h\u1ecdc, ho\u1ea1t \u0111\u1ed9ng, d\u1eef li\u1ec7u, test vectors, checklist b\u1ea3o m\u1eadt, mermaid, ngu\u1ed3n tham kh\u1ea3o).</li> </ul>"},{"location":"algorithms/pqc/pqc/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-\u0111\u00edch--b\u1ea3o-v\u1ec7-g\u00ec","title":"1/ Kh\u00e1i ni\u1ec7m \u2014 m\u1ee5c \u0111\u00edch &amp; b\u1ea3o v\u1ec7 g\u00ec","text":"<ul> <li>PQC: h\u1ecd thu\u1eadt to\u00e1n m\u1eadt m\u00e3 thi\u1ebft k\u1ebf \u0111\u1ec3 an to\u00e0n tr\u01b0\u1edbc adversary c\u00f3 m\u00e1y t\u00ednh l\u01b0\u1ee3ng t\u1eed.</li> <li>Gi\u1ea3i quy\u1ebft: thay th\u1ebf primitives d\u1ef1a tr\u00ean factoring/DLOG (RSA, ECC) b\u1eb1ng primitives d\u1ef1a tr\u00ean LWE, NTRU, lattice, code-based, multivariate, hash-based, isogeny.</li> <li>B\u1ea3o v\u1ec7: t\u00ednh b\u00ed m\u1eadt d\u1eef li\u1ec7u, t\u00ednh to\u00e0n v\u1eb9n/\u00fd th\u1ef1c ch\u1ee7, ch\u1ed1ng ph\u1ee5c h\u1ed3i kh\u00f3a t\u1eeb m\u00e1y l\u01b0\u1ee3ng t\u1eed.</li> </ul>"},{"location":"algorithms/pqc/pqc/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c-math-markdown","title":"2/ To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c (math markdown)","text":""},{"location":"algorithms/pqc/pqc/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-generic-kemsignature","title":"3/ C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (generic KEM/Signature)","text":"<ul> <li>KEM (Key Encapsulation):<ul> <li>KeyGen() \u2192 (pk, sk)</li> <li>Encaps(pk) \u2192 (ct, K)</li> <li>Decaps(sk, ct) \u2192 K'</li> <li>Y\u00eau c\u1ea7u: K == K' v\u1edbi x\u00e1c su\u1ea5t cao.</li> </ul> </li> <li>Signature:<ul> <li>KeyGen() \u2192 (sk, pk)</li> <li>Sign(sk, m) \u2192 \u03c3</li> <li>Verify(pk, m, \u03c3) \u2192 {true,false}</li> </ul> </li> </ul>"},{"location":"algorithms/pqc/pqc/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4/ C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Public key / Private key: ma tr\u1eadn, \u0111a th\u1ee9c, vector ko l\u1edbn; th\u01b0\u1eddng serialize theo \u0111\u1ecbnh d\u1ea1ng little-endian, \u0111\u1ed9 d\u00e0i c\u1ed1 \u0111\u1ecbnh.</li> <li>Ciphertext / Signature: blob nh\u1ecb ph\u00e2n, c\u00f3 c\u1ea5u tr\u00fac field (tag || payload || checksum/seed).</li> <li>Random seeds: entropy source cho sampling noise; gi\u1eef b\u00ed m\u1eadt cho sk ho\u1eb7c public cho determinism.</li> <li>C\u00e1c tham s\u1ed1: (n, q, k, \u03b7, seed_len, hash_len).</li> </ul>"},{"location":"algorithms/pqc/pqc/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5/ So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>Lattice (Kyber/Dilithium/NTRU):<ul> <li>Pros: hi\u1ec7u n\u0103ng t\u1ed1t, k\u00edch th\u01b0\u1edbc moderate.</li> <li>Cons: t\u1ea5n c\u00f4ng c\u1ea5u tr\u00fac, side-channel.</li> </ul> </li> <li>Code-based (McEliece):<ul> <li>Pros: an to\u00e0n t\u1ed1t, long-term.</li> <li>Cons: k\u00edch th\u01b0\u1edbc kh\u00f3a l\u1edbn.</li> </ul> </li> <li>Hash-based (XMSS):<ul> <li>Pros: \u0111\u01a1n gi\u1ea3n, b\u1eb1ng ch\u1ee9ng an to\u00e0n r\u00f5.</li> <li>Cons: stateful ho\u1eb7c phi-stateful v\u1edbi chi ph\u00ed.</li> </ul> </li> <li>Isogeny (SIKE):<ul> <li>Pros: ch\u00eca kho\u00e1 nh\u1ecf.</li> <li>Cons: t\u1ea5n c\u00f4ng g\u1ea7n \u0111\u00e2y l\u00e0m gi\u1ea3m \u0111\u1ed9 an to\u00e0n; nghi\u00ean c\u1ee9u ti\u1ebfp t\u1ee5c.</li> </ul> </li> </ul>"},{"location":"algorithms/pqc/pqc/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6/ Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<ul> <li>High-level KEM flow: <pre><code>flowchart LR\n    A[KeyGen] --&gt;|pk| B[Encaps]\n    B --&gt;|ct, K| C[Transport ct]\n    C --&gt; D[Decaps]\n    D --&gt;|K'| E[Use K]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  </li> </ul>"},{"location":"algorithms/pqc/pqc/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7/ C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>S\u1eed d\u1ee5ng RNG y\u1ebfu/kh\u00f4ng \u0111\u1ee7 entropy \u0111\u1ec3 sinh noise ho\u1eb7c seed.</li> <li>Kh\u00f4ng d\u00f9ng timing-constant/side-channel safe sampling v\u00e0 ki\u1ec3m tra l\u1ed7i.</li> <li>Ki\u1ec3m tra l\u1ed7i sai l\u1ec7ch (fail-open) khi decoding th\u1ea5t b\u1ea1i.</li> <li>Kh\u00f4ng x\u00e1c th\u1ef1c ciphertext tr\u01b0\u1edbc x\u1eed l\u00fd (=&gt; oracle attacks).</li> <li>L\u1ed7i serialization/parsing d\u1eabn t\u1edbi injection ho\u1eb7c truncation.</li> </ul>"},{"location":"algorithms/pqc/pqc/#8-threat-model","title":"8/ Threat Model","text":"<ul> <li>Adversary c\u00f3:<ul> <li>M\u00e1y l\u01b0\u1ee3ng t\u1eed v\u1edbi c\u00e1c c\u1ed5ng l\u01b0\u1ee3ng t\u1eed chu\u1ea9n (Shor kh\u00f4ng ph\u00e1 \u0111\u01b0\u1ee3c lattice/LWE).</li> <li>Kh\u1ea3 n\u0103ng adaptive chosen-ciphertext (CCA) ho\u1eb7c chosen-message.</li> <li>Kh\u1ea3 n\u0103ng side-channel (power, timing, fault).</li> </ul> </li> <li>M\u1ee5c ti\u00eau adversary: ph\u00e1 kh\u00f3a b\u00ed m\u1eadt, nh\u1eadn di\u1ec7n plaintext, forgery.</li> </ul>"},{"location":"algorithms/pqc/pqc/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9/ Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>D\u00f9ng RNG c\u00f3 ch\u1ee9ng nh\u1eadn (CSPRNG / HSM).</li> <li>Th\u1ef1c hi\u1ec7n constant-time v\u00e0 masking cho thao t\u00e1c \u0111a th\u1ee9c/FFT.</li> <li>Harden ch\u1ed1ng fault injection; validate ciphertext tr\u01b0\u1edbc decapsulation.</li> <li>S\u1eed d\u1ee5ng phi\u00ean b\u1ea3n \u0111\u01b0\u1ee3c chuy\u1ec3n th\u1ec3 sang CCA-secure (KEM c\u00f3 CCA transform).</li> <li>Thi\u1ebft k\u1ebf \u0111\u1ecbnh d\u1ea1ng phi\u00ean, key rotation, forward secrecy b\u1eb1ng hybrid v\u1edbi classical crypto.</li> </ul>"},{"location":"algorithms/pqc/pqc/#10-test-vectors-v\u00ed-d\u1ee5-toy","title":"10/ Test Vectors (v\u00ed d\u1ee5 toy)","text":"<ul> <li>Ghi ch\u00fa: \u1edf production d\u00f9ng test vectors ch\u00ednh th\u1ee9c (NIST/standards).</li> <li>Toy KEM (n=2, q=11) v\u00ed d\u1ee5:<ul> <li>params: n=2, q=11</li> <li>KeyGen: s = [3,7], a = [[2,5],[6,4]], e=[1,0] \u2192 b = a\u00b7s+e mod11 = [ (2*3+5*7+1)=? , ...] \u2192 b = [ (6+35+1)=42\u22619, ...]</li> <li>Encaps: choose r,e'..., produce ct = (u= a\u00b7r+e', v = b\u00b7r + e'' + m)</li> <li>Decaps: recover m via round/threshold</li> </ul> </li> <li>Th\u1ef1c t\u1ebf: d\u00f9ng test vectors t\u1eeb NIST PQC finalist archives (Kyber/Dilithium/CRYSTALS,...).</li> </ul>"},{"location":"algorithms/pqc/pqc/#11-code-t\u00f9y-ch\u1ecdn-pseudocode","title":"11/ Code (t\u00f9y ch\u1ecdn, pseudocode)","text":"<ul> <li>Pseudocode KEM (s\u01a1 l\u01b0\u1ee3c): Text Only<pre><code>KeyGen():\n    seed \u2190 RNG(seed_len)\n    a \u2190 Expand(seed)\n    s \u2190 SampleNoise()\n    e \u2190 SampleNoise()\n    pk = (seed, b = a*s + e)\n    sk = s\n    return (pk, sk)\n\nEncaps(pk):\n    seed \u2190 RNG()\n    r \u2190 SampleNoise(seed)\n    u = a*r + e1\n    v = b*r + e2 + Hash(seed||m)\n    K = KDF(v)\n    ct = (u, v)\n    return (ct, K)\n\nDecaps(sk, ct):\n    (u, v) = ct\n    v' = u*sk\n    m = Recover(v - v')\n    K = KDF(v)\n    return K\n</code></pre></li> </ul>"},{"location":"algorithms/pqc/pqc/#12-checklist-b\u1ea3o-m\u1eadt","title":"12/ Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> S\u1eed d\u1ee5ng CSPRNG \u0111\u00e3 ki\u1ec3m ch\u1ee9ng.</li> <li> S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n PQC chu\u1ea9n (NIST finalists/implementations).</li> <li> Ki\u1ec3m tra constant-time cho thao t\u00e1c b\u00ed m\u1eadt.</li> <li> Validate input formats v\u00e0 ciphertext tr\u01b0\u1edbc x\u1eed l\u00fd.</li> <li> Th\u1ef1c hi\u1ec7n test vectors ch\u00ednh th\u1ee9c trong CI.</li> <li> Key rotation &amp; hybrid-mode (classical + PQC) cho compatibility.</li> <li> Logging/telemetry kh\u00f4ng r\u00f2 r\u1ec9 b\u00ed m\u1eadt.</li> <li> Review m\u00e3 ngu\u1ed3n v\u00e0 audit b\u00ean th\u1ee9 ba.</li> </ul>"},{"location":"algorithms/pqc/pqc/#13-ngu\u1ed3n-tham-kh\u1ea3o","title":"13/ Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST Post-Quantum Cryptography: https://csrc.nist.gov/projects/post-quantum-cryptography</li> <li>CRYSTALS-Kyber / CRYSTALS-Dilithium papers &amp; implementations</li> <li>Bernstein, Buchmann, Dahmen \u2014 \"Post-Quantum Cryptography\" (t\u1ed5ng quan)</li> <li>PQClean / Open Quantum Safe projects</li> </ul>"},{"location":"algorithms/signature/ecdsa/","title":"Ecdsa","text":""},{"location":"algorithms/signature/ecdsa/#0-filevault-context","title":"0. FileVault context","text":"<ul> <li>FileVault d\u00f9ng ECDSA \u0111\u1ec3 k\u00fd d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m (x\u00e1c th\u1ef1c ng\u01b0\u1eddi d\u00f9ng, ch\u1eef k\u00fd giao d\u1ecbch). \u01afu ti\u00ean: P\u2011256/P\u2011384, Deterministic ECDSA (RFC 6979), ki\u1ec3m so\u00e1t nonce k.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#1-kh\u00e1i-ni\u1ec7m--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m \u2014 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 g\u00ec","text":"<ul> <li>ECDSA (Elliptic Curve Digital Signature Algorithm) l\u00e0 thu\u1eadt to\u00e1n ch\u1eef k\u00fd s\u1ed1 tr\u00ean \u0111\u01b0\u1eddng cong elliptic.  </li> <li>M\u1ee5c ti\u00eau: x\u00e1c th\u1ef1c ngu\u1ed3n g\u1ed1c v\u00e0 t\u00ednh to\u00e0n v\u1eb9n c\u1ee7a tin nh\u1eafn; b\u1ea3o v\u1ec7 kh\u00f3a ri\u00eang kh\u1ecfi vi\u1ec7c b\u1ecb suy ra th\u00f4ng qua c\u00e1c ch\u1eef k\u00fd.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>\u0110\u01b0\u1eddng cong: \\(\\(y^2 \\equiv x^3 + a x + b \\pmod p.\\)\\) Nh\u00f3m cyclic sinh b\u1edfi \u0111i\u1ec3m \\(G\\) c\u00f3 order \\(n\\). Kh\u00f3a ri\u00eang \\(d\\in\\{1,\\dots,n-1\\}\\), kh\u00f3a c\u00f4ng khai \\(Q=dG\\).  </li> <li>K\u00fd (truy\u1ec1n th\u1ed1ng): ch\u1ecdn \\(k \\xleftarrow{\\$} \\{1,\\dots,n-1\\}\\). \\(R=kG=(R_x,R_y)\\). \\(r \\equiv R_x \\pmod n\\). \\(e=\\mathrm{Hash}(m)\\). \\(s \\equiv k^{-1}(e + d\\,r)\\pmod n\\). Signature \\(=(r,s)\\).  </li> <li>X\u00e1c minh: \\(w \\equiv s^{-1}\\pmod n\\), \\(u_1 \\equiv e\\,w\\pmod n\\), \\(u_2 \\equiv r\\,w\\pmod n\\). T\u00ednh \\((x_1,y_1)=u_1G+u_2Q\\). Ch\u1ea5p nh\u1eadn n\u1ebfu \\(r \\equiv x_1 \\pmod n\\).  </li> <li>Deterministic \\(k\\) (RFC 6979): \\(k=\\mathrm{HMAC\\text{-}DRBG}(\\mathrm{priv},\\mathrm{Hash}(m))\\) thay v\u00ec d\u00f9ng RNG ng\u1eabu nhi\u00ean.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft-b\u01b0\u1edbc","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft b\u01b0\u1edbc)","text":"<ul> <li>K\u00fd:<ol> <li>e = Hash(m) (v\u00ed d\u1ee5 SHA\u2011256 cho P\u2011256).  </li> <li>k = RFC6979(priv, e) ho\u1eb7c RNG m\u1ea1nh.  </li> <li>R = k\u00b7G, r = R.x mod n. N\u1ebfu r = 0 \u2192 ch\u1ecdn k m\u1edbi.  </li> <li>s = k^(\u22121) (e + d\u00b7r) mod n. N\u1ebfu s = 0 \u2192 ch\u1ecdn k m\u1edbi.  </li> <li>Xu\u1ea5t (r,s) (ho\u1eb7c canonicalize s = min(s, n\u2212s)).  </li> </ol> </li> <li>X\u00e1c minh: theo c\u00f4ng th\u1ee9c \u1edf m\u1ee5c 2.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Private key: integer d (padded).  </li> <li>Public key: point Q = (x,y) \u2014 uncompressed (0x04||x||y) ho\u1eb7c compressed (0x02/0x03||x).  </li> <li>Signature: (r,s) \u2014 th\u01b0\u1eddng ASN.1/DER, ho\u1eb7c compact 64\u2011byte (r||s).  </li> <li>Curve params: (p,a,b,G,n,h).</li> </ul>"},{"location":"algorithms/signature/ecdsa/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>RSA: c\u00f9ng m\u1ee5c ti\u00eau nh\u01b0ng ECDSA cung c\u1ea5p k\u00edch th\u01b0\u1edbc kh\u00f3a v\u00e0 ch\u1eef k\u00fd nh\u1ecf h\u01a1n \u1edf c\u00f9ng m\u1ee9c b\u1ea3o m\u1eadt.  </li> <li>EdDSA (Ed25519): thao t\u00e1c nhanh, deterministic by design, ch\u1ed1ng nhi\u1ec1u sai l\u1ea7m ECDSA (khuy\u1ebfn ngh\u1ecb n\u1ebfu m\u00f4i tr\u01b0\u1eddng h\u1ed7 tr\u1ee3).  </li> <li>DSA: ECDSA l\u00e0 phi\u00ean b\u1ea3n elliptic c\u1ee7a DSA.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart LR\n    A[Message m] --&gt; B[\"Hash e = H(m)\"]\n\n    subgraph Signing [Signature Generation]\n        direction LR\n        B --&gt; C[\"k = RFC6979(d, e)\"]\n        C --&gt; D[\"R = k \u00b7 G\"]\n        D --&gt; E[\"r = x(R) mod n\"]\n        E --&gt; F[\"s = k\u207b\u00b9 (e + d\u00b7r) mod n\"]\n        F --&gt; S[\"Signature (r, s)\"]\n    end\n\n    subgraph Verification [Signature Verification]\n        direction LR\n        S --&gt; V1[\"w = s\u207b\u00b9 mod n\"]\n        V1 --&gt; V2[\"u\u2081 = e\u00b7w , u\u2082 = r\u00b7w\"]\n        V2 --&gt; V3[\"X = u\u2081\u00b7G + u\u2082\u00b7Q\"]\n        V3 --&gt; V4[\"Check r = x(X) mod n\"]\n    end\n</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/signature/ecdsa/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>T\u00e1i s\u1eed d\u1ee5ng k (ho\u1eb7c k suy ra t\u1eeb RNG y\u1ebfu) \u2192 r\u00f2 r\u1ec9 private key.  </li> <li>Kh\u00f4ng canonicalize s (m\u1ed9t s\u1ed1 h\u1ec7 y\u00eau c\u1ea7u low\u2011S).  </li> <li>Kh\u00f4ng ki\u1ec3m tra 0 &lt; r,s &lt; n.  </li> <li>Kh\u00f4ng validate public key Q ho\u1eb7c d\u00f9ng curve kh\u00f4ng \u0111\u00e1ng tin.  </li> <li>Tri\u1ec3n khai kh\u00f4ng constant\u2011time \u2192 side\u2011channel (timing, cache, power).  </li> <li>Kh\u00f4ng x\u00f3a k kh\u1ecfi b\u1ed9 nh\u1edb sau s\u1eed d\u1ee5ng.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng: \u0111\u1ecdc \u0111\u01b0\u1ee3c ch\u1eef k\u00fd, c\u00f3 kh\u1ea3 n\u0103ng truy c\u1eadp RNG, side\u2011channel, ho\u1eb7c ti\u1ebfn h\u00e0nh chosen\u2011message.  </li> <li>M\u1ee5c ti\u00eau attacker: suy ra kh\u00f3a ri\u00eang, k\u00fd d\u1eef li\u1ec7u gi\u1ea3, replay/forgery.  </li> <li>Kh\u1ea3 n\u0103ng: passive observation, local code execution, side\u2011channel extraction, network adversary.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>D\u00f9ng RFC6979 \u0111\u1ec3 tr\u00e1nh l\u1ed7i RNG.  </li> <li>S\u1eed d\u1ee5ng curves ti\u00eau chu\u1ea9n (P\u2011256/P\u2011384) ho\u1eb7c Ed25519 n\u1ebfu ph\u00f9 h\u1ee3p.  </li> <li>Tri\u1ec3n khai to\u00e1n h\u1ecdc constant\u2011time, validate \u0111i\u1ec3m, canonicalize signatures (low\u2011S).  </li> <li>S\u1eed d\u1ee5ng HSM/TPM ho\u1eb7c secure enclave cho private key.  </li> <li>X\u00f3a s\u1ea1ch gi\u00e1 tr\u1ecb k, tr\u00e1nh logging kh\u00f3a/nonce.  </li> <li>Ki\u1ec3m th\u1eed v\u1edbi test vectors v\u00e0 fuzzing.</li> </ul>"},{"location":"algorithms/signature/ecdsa/#10-test-vectors-v\u00ed-d\u1ee5-minh-h\u1ecda-kh\u00f4ng-d\u00f9ng-trong-s\u1ea3n-ph\u1ea9m","title":"10. Test Vectors (v\u00ed d\u1ee5 minh h\u1ecda, KH\u00d4NG D\u00d9NG TRONG S\u1ea2N PH\u1ea8M)","text":"<ul> <li>Curve: P\u2011256, Hash=SHA\u2011256 (v\u00ed d\u1ee5 minh h\u1ecda kh\u00f4ng th\u1ef1c t\u1ebf):  <ul> <li>priv d = 0x1c0d... (32B)  </li> <li>pub Q = 0x04||x||y  </li> <li>msg = \"sample\" \u2192 e = SHA256(msg) = 0x...  </li> <li>deterministic k (RFC6979) = 0x...  </li> <li>signature (r,s) = (0x..., 0x...)  </li> </ul> </li> <li>Th\u1ef1c t\u1ebf: ki\u1ec3m tra v\u1edbi vectors trong RFC 6979 Appendix v\u00e0 c\u00e1c test suite (BoringSSL, OpenSSL, Wycheproof).</li> </ul>"},{"location":"algorithms/signature/ecdsa/#11-code-pseudocode-ng\u1eafn","title":"11. Code (pseudocode ng\u1eafn)","text":"<ul> <li>Signing (pseudocode): Text Only<pre><code>e = Hash(m)\nk = RFC6979_generate_k(d, e)\nR = point_mul(k, G)\nr = R.x mod n\ns = inv_mod(k, n) * (e + d*r) mod n\nif r==0 or s==0: retry\nreturn encode_signature(r,s)\n</code></pre></li> <li>Verifying (pseudocode): Text Only<pre><code>e = Hash(m)\nif not (1&lt;=r&lt;n and 1&lt;=s&lt;n): reject\nw = inv_mod(s,n)\nu1 = (e*w) mod n\nu2 = (r*w) mod n\nX = point_add(point_mul(u1,G), point_mul(u2,Q))\naccept if X.x mod n == r\n</code></pre></li> </ul>"},{"location":"algorithms/signature/ecdsa/#12-checklist-b\u1ea3o-m\u1eadt-t\u1ed1i-thi\u1ec3u-tr\u01b0\u1edbc-deployment","title":"12. Checklist b\u1ea3o m\u1eadt (t\u1ed1i thi\u1ec3u tr\u01b0\u1edbc deployment)","text":"<ul> <li> D\u00f9ng curves v\u00e0 primitives \u0111\u01b0\u1ee3c duy\u1ec7t.  </li> <li> S\u1eed d\u1ee5ng RFC6979 ho\u1eb7c RNG m\u1ea1nh.  </li> <li> Validate \u0111i\u1ec3m public key v\u00e0 r,s.  </li> <li> Tri\u1ec3n khai constant\u2011time cho c\u00e1c ph\u00e9p to\u00e1n ch\u00ednh.  </li> <li> Low\u2011S canonicalization (n\u1ebfu c\u1ea7n).  </li> <li> Erase nonce k v\u00e0 t\u00e0i nguy\u00ean t\u1ea1m.  </li> <li> B\u1ea3o v\u1ec7 private key b\u1eb1ng HSM/keystore.  </li> <li> C\u00f3 test vectors, unit tests, fuzz tests, CI.  </li> <li> Ki\u1ec3m tra compatibility encoding (DER vs compact).</li> </ul> <p>Ngu\u1ed3n tham kh\u1ea3o - RFC 6979 \u2014 Deterministic Usage of DSA and ECDSA - SEC 1 (Standards for Efficient Cryptography) \u2014 Elliptic Curve Cryptography - NIST FIPS/Standards, OpenSSL/BoringSSL docs, Project Wycheproof</p> <p>Ghi ch\u00fa: d\u00f9ng vector th\u1ef1c t\u1ebf t\u1eeb RFC v\u00e0 test suite ch\u00ednh th\u1ee9c \u0111\u1ec3 ki\u1ec3m th\u1eed tri\u1ec3n khai.</p>"},{"location":"algorithms/signature/ed25519/","title":"Ed25519","text":""},{"location":"algorithms/signature/ed25519/#0-filevault-context","title":"0. FileVault context","text":"<p>Ed25519 l\u00e0 thu\u1eadt to\u00e1n ch\u1eef k\u00fd \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho FileVault: nhanh, an to\u00e0n, k\u00edch th\u01b0\u1edbc kh\u00f3a nh\u1ecf, ph\u00f9 h\u1ee3p cho x\u00e1c th\u1ef1c b\u1ea3n ghi, metadata signing v\u00e0 boot chain integrity.</p>"},{"location":"algorithms/signature/ed25519/#1-kh\u00e1i-ni\u1ec7m--gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m \u2014 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>Ed25519 cung c\u1ea5p: - Ch\u1eef k\u00fd s\u1ed1 kh\u00f4ng c\u1ea7n RNG khi k\u00fd (deterministic), gi\u1ea3m r\u1ee7i ro do RNG k\u00e9m. - T\u00ednh to\u00e0n v\u1eb9n v\u00e0 x\u00e1c th\u1ef1c ngu\u1ed3n c\u1ee7a d\u1eef li\u1ec7u (m\u00e3 h\u00f3a b\u1ea5t \u0111\u1ed1i x\u1ee9ng cho ch\u1eef k\u00fd). - Kh\u1ea3 n\u0103ng ch\u1ed1ng gi\u1ea3 m\u1ea1o, replay (k\u1ebft h\u1ee3p v\u1edbi nonce/timestamp), v\u00e0 n\u00e9 c\u00e1c t\u1ea5n c\u00f4ng t\u1eeb nh\u00f3m nh\u1ecf n\u1ebfu tri\u1ec3n khai \u0111\u00fang.</p>"},{"location":"algorithms/signature/ed25519/#2-to\u00e1n-h\u1ecdc-v\u1edbi-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc (v\u1edbi c\u00f4ng th\u1ee9c)","text":"<ul> <li>Tr\u01b0\u1eddng: \\(p = 2^{255}-19\\).</li> <li>\u0110\u01b0\u1eddng cong Edwards: \\(-x^{2} + y^{2} = 1 + d x^{2} y^{2}\\) v\u1edbi \\(d = -121665/121666\\).</li> <li>B\u1ed9 sinh (base point) \\(B\\) c\u00f3 c\u1ea5p (order) \\(l\\) v\u1edbi \\(l\\) l\u00e0 s\u1ed1 nguy\u00ean l\u1edbn (kho\u1ea3ng \\(2^{252} + \\dots\\)). Cofactor \\(h = 8\\).</li> <li>To\u00e1n t\u1eed nh\u00e2n v\u00f4 h\u01b0\u1edbng: \\([k]P\\) l\u00e0 nh\u00e2n \u0111i\u1ec3m theo scalar \\(k\\).</li> <li>Bi\u1ec3u di\u1ec5n public key: \u0111i\u1ec3m n\u00e9n b\u1eb1ng ho\u00e0nh \u0111\u1ed9 \\(y\\) (32 bytes) + bit d\u1ea5u c\u1ee7a \\(x\\).</li> </ul>"},{"location":"algorithms/signature/ed25519/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft-thu\u1eadt-to\u00e1n","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft thu\u1eadt to\u00e1n)","text":"<ul> <li>Key generation:<ul> <li>Seed (32 bytes) \u2192 \\(H = \\mathrm{SHA512}(\\mathrm{seed})\\) \u2192 derive scalar \\(a\\) (clamp bits).</li> <li>Public key \\(A = [a]B\\) (n\u00e9n th\u00e0nh 32 bytes).</li> </ul> </li> <li>Signing (v\u1eafn t\u1eaft RFC8032 style):<ul> <li>\\(r = H(\\text{prefix}, M) \\bmod l\\); \\(R = [r]B\\).</li> <li>\\(k = H(R, A, M) \\bmod l\\).</li> <li>\\(S = (r + k\\cdot a) \\bmod l\\).</li> <li>Signature = encode(R) || encode(S) (64 bytes).</li> </ul> </li> <li>Verification:<ul> <li>Ki\u1ec3m tra \\(S &lt; l\\) v\u00e0 canonical encoding.</li> <li>Ch\u1ea5p nh\u1eadn n\u1ebfu \\([S]B = R + H(R,A,M)[A]\\).</li> </ul> </li> </ul>"},{"location":"algorithms/signature/ed25519/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Seed/private seed: 32 bytes (b\u00ed m\u1eadt).</li> <li>Secret scalar (\u0111\u01b0\u1ee3c derive): 32 bytes (clamped).</li> <li>Public key: 32 bytes (compressed).</li> <li>Signature: 64 bytes = 32-byte \\(R\\) || 32-byte \\(S\\).</li> <li>L\u01b0u \u00fd: m\u1ed9t s\u1ed1 th\u01b0 vi\u1ec7n l\u01b0u private key 64 bytes (seed + pub).</li> </ul>"},{"location":"algorithms/signature/ed25519/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi ECDSA:<ul> <li>Ed25519: deterministic, an to\u00e0n kh\u1ecfi l\u1ed7i RNG, nh\u1ecf h\u01a1n, nhanh h\u01a1n.</li> <li>ECDSA: d\u1ec5 m\u1eafc l\u1ed7i nonce, k\u00fd kh\u00f4ng deterministic.</li> </ul> </li> <li>So v\u1edbi RSA: k\u00edch th\u01b0\u1edbc kh\u00f3a/ ch\u1eef k\u00fd nh\u1ecf h\u01a1n, hi\u1ec7u n\u0103ng t\u1ed1t h\u01a1n cho k\u00fd s\u1ed1.</li> <li>So v\u1edbi Ed448: Ed448 cung c\u1ea5p b\u1ea3o m\u1eadt cao h\u01a1n, nh\u01b0ng ch\u1eadm v\u00e0 c\u1ed3ng k\u1ec1nh h\u01a1n.</li> </ul>"},{"location":"algorithms/signature/ed25519/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (Mermaid)","text":"<pre><code>sequenceDiagram\n    participant Signer\n    participant Verifier\n    Signer-&gt;&gt;Signer: Generate seed -&gt; derive a, A=[a]B\n    Signer-&gt;&gt;Signer: Compute r, R=[r]B\n    Signer-&gt;&gt;Verifier: Send (R,S) signature + message\n    Verifier-&gt;&gt;Verifier: Compute k=H(R,A,M)\n    Verifier-&gt;&gt;Verifier: Check [S]B ?= R + k[A]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/signature/ed25519/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng \"clamp\" scalar (l\u00e0m l\u1ed9 bits quan tr\u1ecdng).</li> <li>Kh\u00f4ng ki\u1ec3m tra canonical encoding c\u1ee7a signature ho\u1eb7c \\(S&lt;l\\).</li> <li>Ch\u1ea5p nh\u1eadn public key v\u1edbi small-order ho\u1eb7c \u0111i\u1ec3m v\u00f4 h\u01b0\u1edbng (kh\u00f4ng validate).</li> <li>Kh\u00f4ng x\u1eed l\u00fd cofactor khi c\u1ea7n (v\u00ed d\u1ee5 trong c\u00e1c giao th\u1ee9c chia s\u1ebb kh\u00f3a).</li> <li>Th\u00f4ng tin b\u00ed m\u1eadt b\u1ecb l\u1ed9 do side-channel (timing, cache).</li> <li>S\u1eed d\u1ee5ng RNG k\u00e9m cho seed khi kh\u00f4ng d\u00f9ng seed deterministic.</li> </ul>"},{"location":"algorithms/signature/ed25519/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u1ecdc/ghi tin nh\u1eafn gi\u1eefa client v\u00e0 server (man-in-the-middle).</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u1ed1 g\u1eafng k\u00fd t\u00e0i li\u1ec7u tr\u00e1i ph\u00e9p (chi\u1ebfm kh\u00f3a).</li> <li>R\u00f2 r\u1ec9 mem, side-channel extraction.</li> <li>T\u1ea5n c\u00f4ng small-subgroup ho\u1eb7c l\u1ed7i ki\u1ec3m tra public key.</li> <li>Fault injection (l\u00e0m sai k\u1ebft qu\u1ea3 nh\u00e2n \u0111i\u1ec3m).</li> </ul>"},{"location":"algorithms/signature/ed25519/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n d\u00f9ng th\u01b0 vi\u1ec7n Ed25519 \u0111\u00e3 \u0111\u01b0\u1ee3c audit (libsodium, BoringSSL, OpenSSL recent).</li> <li>Clamp scalar, ki\u1ec3m tra \\(S&lt;l\\), validate public key (kh\u00f4ng ph\u1ea3i \u0111i\u1ec3m v\u00f4 h\u01b0\u1edbng).</li> <li>Thao t\u00e1c to\u00e1n h\u1ecdc constant-time, tr\u00e1nh branching theo b\u00ed m\u1eadt.</li> <li>L\u01b0u tr\u1eef seed trong v\u00f9ng b\u1ea3o m\u1eadt, x\u00f3a b\u1ed9 \u0111\u1ec7m sau d\u00f9ng.</li> <li>S\u1eed d\u1ee5ng deterministic signing (theo RFC8032) \u0111\u1ec3 tr\u00e1nh ph\u1ee5 thu\u1ed9c RNG t\u1ea1i k\u00fd.</li> <li>Th\u00eam x\u00e1c th\u1ef1c ng\u1eef c\u1ea3nh (context, domain separation) khi c\u1ea7n.</li> </ul>"},{"location":"algorithms/signature/ed25519/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Ki\u1ec3m tra v\u1edbi test vectors chu\u1ea9n (RFC 8032). V\u00ed d\u1ee5 ki\u1ec3u d\u1eef li\u1ec7u:<ul> <li>seed (hex): ...</li> <li>public key (hex): ...</li> <li>message (hex): ...</li> <li>signature (hex): ...</li> </ul> </li> <li>Lu\u00f4n ki\u1ec3m tra:<ul> <li>signatures \u0111\u00fang/kh\u00f4ng \u0111\u00fang,</li> <li>public key canonical,</li> <li>t\u1eeb ch\u1ed1i signature c\u00f3 S &gt;= l.</li> </ul> </li> </ul>"},{"location":"algorithms/signature/ed25519/#11-code-t\u00f3m-t\u1eaft--tham-kh\u1ea3o","title":"11. Code (t\u00f3m t\u1eaft / tham kh\u1ea3o)","text":"<ul> <li>Khuy\u1ebfn ngh\u1ecb d\u00f9ng th\u01b0 vi\u1ec7n: libsodium (crypto_sign_ed25519_*), BoringSSL, OpenSSL 1.1+.</li> <li>Pseudocode k\u00fd:<ul> <li>seed = random32()</li> <li>a = clamp(SHA512(seed)[0:32])</li> <li>A = scalar_mult(a, B)</li> <li>r = SHA512(prefix || message) mod l</li> <li>R = scalar_mult(r, B)</li> <li>S = (r + SHA512(R||A||M)*a) mod l</li> <li>return encode(R)||encode(S)</li> </ul> </li> </ul>"},{"location":"algorithms/signature/ed25519/#12-checklist-b\u1ea3o-m\u1eadt-ng\u1eafn","title":"12. Checklist b\u1ea3o m\u1eadt (ng\u1eafn)","text":"<ul> <li> D\u00f9ng lib \u0111\u00e3 audit.</li> <li> Clamp scalar.</li> <li> Ki\u1ec3m tra canonical encoding &amp; S&lt;l.</li> <li> Validate public key (kh\u00f4ng ph\u1ea3i \u0111i\u1ec3m \u0111\u1eb7c bi\u1ec7t).</li> <li> Constant-time implementation.</li> <li> X\u00f3a key/seed kh\u1ecfi b\u1ed9 nh\u1edb sau d\u00f9ng.</li> <li> Test v\u1edbi vectors chu\u1ea9n.</li> <li> Ki\u1ec3m tra cofactor khi giao th\u1ee9c y\u00eau c\u1ea7u.</li> </ul>"},{"location":"algorithms/signature/ed25519/#t\u00e0i-nguy\u00ean--tham-kh\u1ea3o","title":"T\u00e0i nguy\u00ean &amp; tham kh\u1ea3o","text":"<ul> <li>RFC 8032 \u2014 Ed25519 specification.</li> <li>D. J. Bernstein et al., Curve25519/Ed25519 papers.</li> <li>libsodium, BoringSSL, SUPERCOP.</li> </ul>"},{"location":"algorithms/signature/rsa-pss/","title":"Rsa pss","text":""},{"location":"algorithms/signature/rsa-pss/#0-filevault-context","title":"0. FileVault context","text":"<p>FileVault s\u1eed d\u1ee5ng RSA-PSS (theo chu\u1ea9n PKCS#1) \u0111\u1ec3 k\u00fd v\u00e0 x\u00e1c th\u1ef1c file, b\u1ea3o \u0111\u1ea3m t\u00ednh x\u00e1c th\u1ef1c ngu\u1ed3n g\u1ed1c v\u00e0 to\u00e0n v\u1eb9n d\u1eef li\u1ec7u trong h\u1ec7 th\u1ed1ng l\u01b0u tr\u1eef m\u00e3 h\u00f3a.</p>"},{"location":"algorithms/signature/rsa-pss/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<ul> <li>V\u1ea5n \u0111\u1ec1 gi\u1ea3i quy\u1ebft: \u0111\u1ea3m b\u1ea3o r\u1eb1ng m\u1ed9t file/metadata \u0111\u01b0\u1ee3c k\u00fd b\u1edfi ch\u1ee7 s\u1edf h\u1eefu kh\u00f3a ri\u00eang v\u00e0 kh\u00f4ng b\u1ecb thay \u0111\u1ed5i.</li> <li>B\u1ea3o v\u1ec7: x\u00e1c th\u1ef1c ngu\u1ed3n (authenticity) v\u00e0 to\u00e0n v\u1eb9n (integrity). RSA-PSS th\u00eam t\u00ednh ng\u1eabu nhi\u00ean \u0111\u1ec3 ch\u1ed1ng replay v\u00e0 t\u1ea5n c\u00f4ng chuy\u1ec3n \u0111\u1ed5i ch\u1eef k\u00fd.</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Kh\u00f3a: \\((n,e)\\) (public), \\(d\\) (private).</li> <li>Hash: \\(mHash = H(M)\\) (FileVault: SHA-256).</li> <li>Encoding (PSS) cho ra octet string EM c\u00f3 \u0111\u1ed9 d\u00e0i \\(emLen\\).</li> <li>T\u1ea1o ch\u1eef k\u00fd:<ul> <li>Chuy\u1ec3n EM sang s\u1ed1 \\(m = \\text{OS2IP}(EM)\\).</li> <li>\\(S = m^d \\bmod n\\).</li> </ul> </li> <li>Verify:<ul> <li>\\(m' = S^e \\bmod n\\); \\(EM' = \\text{I2OSP}(m', emLen)\\); ki\u1ec3m tra PSS-encoding.</li> </ul> </li> <li>C\u00e1c th\u00e0nh ph\u1ea7n ch\u00ednh PSS:<ul> <li>MGF1: mask generation function d\u1ef1a tr\u00ean hash \\(H\\).</li> <li>Salt: ng\u1eabu nhi\u00ean \u0111\u1ed9 d\u00e0i \\(sLen\\).</li> </ul> </li> </ul>"},{"location":"algorithms/signature/rsa-pss/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ol> <li>Hash file: \\(mHash = H(M)\\).</li> <li>Sinh salt ng\u1eabu nhi\u00ean \\(salt\\) (\u0111\u1ed9 d\u00e0i \\(sLen\\)).</li> <li>T\u1ea1o \\(M' = \\text{0x00}^{8} || mHash || salt\\); \\(H' = H(M')\\).</li> <li>T\u1ea1o DB = PS || 0x01 || salt; maskedDB = DB \\oplus MGF1(H', emLen - hLen -1).</li> <li>EM = maskedDB || H' || 0xbc.</li> <li>Ch\u1eef k\u00fd \\(S = \\text{RSA\\_priv}(EM)\\); g\u1eedi \\(S\\).</li> </ol>"},{"location":"algorithms/signature/rsa-pss/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>EM (encoded message): octet string c\u00f3 c\u1ea5u tr\u00fac [maskedDB || H' || 0xbc].</li> <li>DB ch\u1ee9a PS (padding zeros), 0x01, salt.</li> <li>Salt: ng\u1eabu nhi\u00ean, sLen byte.</li> <li>K\u00edch th\u01b0\u1edbc li\u00ean quan: emLen (bytes), hLen = len(H).</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>RSA-PSS vs PKCS#1 v1.5:<ul> <li>PSS: probabilistic, b\u1ea3o m\u1eadt ch\u1ee9ng minh (provable security).</li> <li>v1.5: deterministic, d\u1ec5 b\u1ecb m\u1ed9t s\u1ed1 t\u1ea5n c\u00f4ng chuy\u1ec3n \u0111\u1ed5i.</li> </ul> </li> <li>PSS vs ECDSA:<ul> <li>ECDSA k\u00edch th\u01b0\u1edbc kh\u00f3a nh\u1ecf h\u01a1n; PSS ph\u00f9 h\u1ee3p khi h\u1ec7 th\u1ed1ng \u0111\u00e3 d\u00f9ng RSA.</li> </ul> </li> </ul>"},{"location":"algorithms/signature/rsa-pss/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>sequenceDiagram\n    participant S as Signer\n    participant V as Verifier\n\n    Note over S: Signature Generation\n    S-&gt;&gt;S: Compute H = Hash(M)\n    S-&gt;&gt;S: Generate salt (RNG)\n    S-&gt;&gt;S: EM = PSS-Encode(H, salt)\n    S-&gt;&gt;V: Signature S = RSA_sign(EM)\n\n    Note over V: Signature Verification\n    V-&gt;&gt;V: EM' = RSA_verify(S)\n    V-&gt;&gt;V: H' = PSS-Decode(EM')\n    V-&gt;&gt;V: Check H' == Hash(M)\n</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/signature/rsa-pss/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng RNG y\u1ebfu \u0111\u1ec3 sinh salt.</li> <li>Salt length = 0 (lo\u1ea1i b\u1ecf t\u00ednh probabilistic).</li> <li>Kh\u00f4ng ki\u1ec3m tra \u0111\u00fang emLen/hLen boundary.</li> <li>D\u00f9ng hash kh\u00f4ng \u0111\u1ee7 m\u1ea1nh ho\u1eb7c kh\u00f4ng \u0111\u1ed3ng nh\u1ea5t trong c\u1ea3 2 b\u00ean.</li> <li>So s\u00e1nh k\u1ebft qu\u1ea3 kh\u00f4ng d\u00f9ng constant-time (th\u1eddi gian r\u00f2 r\u1ec9).</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng: c\u00f3 th\u1ec3 quan s\u00e1t/can thi\u1ec7p m\u1ea1ng; c\u00f3 m\u1ee5c ti\u00eau t\u1ea1o ch\u1eef k\u00fd gi\u1ea3 ho\u1eb7c t\u00e1i s\u1eed d\u1ee5ng/chuy\u1ec3n \u0111\u1ed5i ch\u1eef k\u00fd.</li> <li>M\u1ee5c ti\u00eau t\u1ea5n c\u00f4ng: chi\u1ebfm private key, \u0111\u00e1nh l\u1eeba verifier b\u1eb1ng ch\u1eef k\u00fd h\u1ee3p l\u1ec7.</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>D\u00f9ng RNG m\u1ea1nh (CSPRNG) cho salt.</li> <li>Ch\u1ecdn sLen \u2248 hLen (th\u00f4ng l\u1ec7: 20..32 cho SHA-256).</li> <li>B\u1ea3o v\u1ec7 kh\u00f3a ri\u00eang (HSM, TPM, filesystem encrypted).</li> <li>Ki\u1ec3m tra to\u00e0n v\u1eb9n th\u01b0 vi\u1ec7n crypto v\u00e0 c\u1eadp nh\u1eadt.</li> <li>So s\u00e1nh k\u1ebft qu\u1ea3 b\u1eb1ng constant-time.</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#10-test-vectors-h\u01b0\u1edbng-d\u1eabn","title":"10. Test Vectors (h\u01b0\u1edbng d\u1eabn)","text":"<ul> <li>L\u01b0u \u00fd: PSS probabilistic \u2192 ch\u1eef k\u00fd kh\u00e1c nhau m\u1ed7i l\u1ea7n. D\u00f9ng salt c\u1ed1 \u0111\u1ecbnh \u0111\u1ec3 t\u1ea1o vector ki\u1ec3m th\u1eed deterministic.</li> <li>V\u00ed d\u1ee5 ki\u1ec3m th\u1eed v\u1edbi OpenSSL (SHA-256, sLen=32):<ul> <li>Sinh key:<ul> <li>openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -out key.pem</li> </ul> </li> <li>K\u00fd (deterministic salt kh\u00f4ng tr\u1ef1c ti\u1ebfp h\u1ed7 tr\u1ee3 b\u1eb1ng openssl CLI; d\u00f9ng test harness/lib \u0111\u1ec3 c\u1ed1 \u0111\u1ecbnh salt).</li> </ul> </li> <li>\u0110\u1ec1 xu\u1ea5t: d\u00f9ng th\u01b0 vi\u1ec7n (BoringSSL/openssl lib) trong test mode \u0111\u1ec3 \u00e9p salt c\u1ed1 \u0111\u1ecbnh v\u00e0 ki\u1ec3m tra EM/Signature hex.</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#11-code-tham-kh\u1ea3o-nhanh-b\u1ecf-qua-chi-ti\u1ebft","title":"11. Code (tham kh\u1ea3o nhanh, b\u1ecf qua chi ti\u1ebft)","text":"<ul> <li>S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n chu\u1ea9n (Go crypto/rsa, Python cryptography, Java BouncyCastle) v\u00e0 g\u1ecdi RSA-PSS API thay v\u00ec t\u1ef1 tri\u1ec3n khai PSS.</li> <li>V\u00ed d\u1ee5 ng\u1eafn (Python, \u00fd t\u01b0\u1edfng):<ul> <li>from cryptography.hazmat.primitives.asymmetric import padding</li> <li>signature = private_key.sign(message, padding.PSS(mgf=padding.MGF1(hashes.SHA256()), salt_length=32), hashes.SHA256())</li> </ul> </li> </ul>"},{"location":"algorithms/signature/rsa-pss/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> D\u00f9ng SHA-256 (ho\u1eb7c m\u1ea1nh h\u01a1n).</li> <li> RNG cho salt l\u00e0 CSPRNG.</li> <li> sLen \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh (khuy\u1ebfn ngh\u1ecb \u2248 hLen).</li> <li> Ki\u1ec3m tra emLen/hLen boundaries.</li> <li> S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n chu\u1ea9n, tr\u00e1nh t\u1ef1 tri\u1ec3n khai.</li> <li> B\u1ea3o v\u1ec7 kh\u00f3a ri\u00eang (HSM/TPM/encrypted storage).</li> <li> So s\u00e1nh constant-time khi verify.</li> <li> Ki\u1ec3m th\u1eed v\u1edbi vectors deterministic trong m\u00f4i tr\u01b0\u1eddng CI.</li> </ul>"},{"location":"algorithms/signature/rsa-pss/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>PKCS#1 v2.1 / RFC 3447 (RSA-PSS)</li> <li>RFC 8017 (PKCS#1 updates)</li> <li>NIST FIPS 186-4</li> <li>T\u00e0i li\u1ec7u OpenSSL, cryptography library docs</li> </ul> <p>(\u0110i\u1ec1n th\u00eam code/test vectors c\u1ee5 th\u1ec3 theo y\u00eau c\u1ea7u tri\u1ec3n khai.)</p>"},{"location":"algorithms/stego/steganography/","title":"Steganography (LSB) \u2014 FileVault","text":""},{"location":"algorithms/stego/steganography/#steganography-lsb--filevault","title":"Steganography (LSB) \u2014 FileVault","text":""},{"location":"algorithms/stego/steganography/#0-filevault-context","title":"0. FileVault context","text":"<p>FileVault cung c\u1ea5p t\u00ednh n\u0103ng nh\u00fang d\u1eef li\u1ec7u v\u00e0o \u1ea3nh lossless (BMP/PNG) b\u1eb1ng k\u1ef9 thu\u1eadt LSB k\u00e8m m\u00e3 h\u00f3a AES\u2011GCM tr\u01b0\u1edbc khi nh\u00fang \u0111\u1ec3 b\u1ea3o m\u1eadt v\u00e0 t\u0103ng entropy.</p>"},{"location":"algorithms/stego/steganography/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<ul> <li>M\u1ee5c ti\u00eau: \u1ea9n payload trong cover image sao cho s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a payload kh\u00f3 b\u1ecb ph\u00e1t hi\u1ec7n.</li> <li>Gi\u1ea3i quy\u1ebft: b\u1ea3o m\u1eadt t\u00ednh k\u00edn \u0111\u00e1o (confidentiality of existence) v\u00e0 b\u1ea3o v\u1ec7 n\u1ed9i dung payload (confidentiality + integrity via AE).</li> <li>B\u1ea3o v\u1ec7: m\u00e3 h\u00f3a (AES\u2011GCM) tr\u01b0\u1edbc embedding; tr\u00e1nh n\u00e9n m\u1ea5t d\u1eef li\u1ec7u v\u00e0 thao t\u00e1c \u1ea3nh.</li> </ul>"},{"location":"algorithms/stego/steganography/#2-to\u00e1n-h\u1ecdc--c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc / c\u00f4ng th\u1ee9c","text":"<ul> <li> <p>K\u00fd hi\u1ec7u:</p> <ul> <li>W, H: chi\u1ec1u r\u1ed9ng / chi\u1ec1u cao \u1ea3nh (pixel)</li> <li>C: s\u1ed1 k\u00eanh tr\u00ean m\u1ed7i pixel (th\u01b0\u1eddng 3 cho RGB)</li> <li>b: s\u1ed1 bit LSB d\u00f9ng tr\u00ean m\u1ed7i k\u00eanh (th\u01b0\u1eddng 1)</li> </ul> </li> <li> <p>Dung l\u01b0\u1ee3ng t\u1ed1i \u0111a (bytes):</p> <ul> <li>C\u00f4ng th\u1ee9c: \\(\\,\\text{capacity\\_bytes} = \\left\\lfloor \\dfrac{W\\cdot H\\cdot C\\cdot b}{8} \\right\\rfloor\\,\\)</li> <li>V\u00ed d\u1ee5: v\u1edbi \\(W=1024\\), \\(H=768\\), \\(C=3\\), \\(b=1\\):     $$     \\text{capacity_bytes} = \\left\\lfloor \\dfrac{1024\\cdot 768\\cdot 3\\cdot 1}{8} \\right\\rfloor = 294912     $$</li> </ul> </li> <li> <p>Entropy:</p> <ul> <li>D\u1eef li\u1ec7u nh\u00fang n\u00ean c\u00f3 \u0111\u1ed9 entropy cao (v\u00ed d\u1ee5: output c\u1ee7a AES\u2011GCM) \u0111\u1ec3 tr\u00e1nh c\u00e1c m\u1eabu d\u1ec5 b\u1ecb ph\u00e1t hi\u1ec7n b\u1edfi steganalysis.</li> </ul> </li> </ul>"},{"location":"algorithms/stego/steganography/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ol> <li>M\u00e3 h\u00f3a payload v\u1edbi AES\u2011GCM (key, nonce) \u2192 ciphertext || tag.</li> <li>\u0110\u1ecbnh d\u1ea1ng payload: header (length, nonce, tag) + ciphertext.</li> <li>Duy\u1ec7t pixel \u2192 thay LSB m\u1ed7i k\u00eanh b\u1eb1ng bit payload (bitstream).</li> <li>L\u01b0u \u1ea3nh m\u1edbi (lossless).</li> </ol> <p>Extraction: 1. \u0110\u1ecdc LSB theo th\u1ee9 t\u1ef1 \u0111\u00e3 d\u00f9ng \u2192 bitstream \u2192 bytes. 2. T\u00e1ch header (length, nonce, tag) \u2192 gi\u1ea3i m\u00e3 AES\u2011GCM \u2192 ki\u1ec3m tra tag.</p>"},{"location":"algorithms/stego/steganography/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u-trong-cover","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u (trong cover)","text":"<ul> <li>Byte stream nh\u00fang:<ul> <li>[MAGIC][VERSION][payload_len (4B)][nonce (12B)][ciphertext][tag (16B)]</li> </ul> </li> <li>MAGIC gi\u00fap x\u00e1c \u0111\u1ecbnh presence; VERSION \u0111\u1ec3 t\u01b0\u01a1ng th\u00edch.</li> <li>S\u1eafp x\u1ebfp bit: th\u01b0\u1eddng MSB-first trong m\u1ed7i byte payload khi gh\u00e9p t\u1eeb LSB c\u1ee7a k\u00eanh.</li> </ul>"},{"location":"algorithms/stego/steganography/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>LSB vs Spread Spectrum: LSB cao dung l\u01b0\u1ee3ng nh\u01b0ng fragile; spread spectrum b\u1ec1n h\u01a1n tr\u01b0\u1edbc ch\u1ec9nh s\u1eeda nh\u01b0ng ph\u1ee9c t\u1ea1p h\u01a1n.</li> <li>LSB vs Transform-domain (DCT/DFT): transform-domain b\u1ec1n v\u1edbi n\u00e9n/bi\u1ebfn \u0111\u1ed5i nh\u01b0ng th\u01b0\u1eddng ph\u1ee9c t\u1ea1p v\u00e0 c\u00f3 footprint l\u1edbn h\u01a1n.</li> </ul>"},{"location":"algorithms/stego/steganography/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart LR\n    subgraph Embed [\"Embedding (Sender)\"]\n        direction LR\n        A[Cover image] --&gt; B[Payload]\n        B --&gt; C[\"Encrypt payload\\nAES-GCM\"]\n        C --&gt; D[\"Pack header\\nciphertext + tag\"]\n        D --&gt; E[\"Embed bits into\\npixel LSBs\"]\n        E --&gt; F[Stego image]\n    end\n\n    F --&gt; G[Transmit / Store]\n\n    subgraph Extract [\"Extraction (Receiver)\"]\n        direction LR\n        G --&gt; H[\"Extract LSB\\nbitstream\"]\n        H --&gt; I[\"Unpack header\"]\n        I --&gt; J[\"Decrypt AES-GCM\"]\n        J --&gt; K[\"Verify tag\\nrecover payload\"]\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/stego/steganography/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Kh\u00f4ng m\u00e3 h\u00f3a payload tr\u01b0\u1edbc khi nh\u00fang \u2192 d\u1ec5 ph\u00e1t hi\u1ec7n.</li> <li>S\u1eed d\u1ee5ng c\u1ed1 \u0111\u1ecbnh MAGIC d\u1ec5 b\u1ecb fingerprinting.</li> <li>Kh\u00f4ng ki\u1ec3m tra k\u00edch th\u01b0\u1edbc (overflow) khi nh\u00fang.</li> <li>L\u01b0u file v\u1edbi n\u00e9n lossy (JPEG) sau embedding.</li> <li>S\u1eed d\u1ee5ng nonce l\u1eb7p cho AES\u2011GCM.</li> </ul>"},{"location":"algorithms/stego/steganography/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Attacker: passive observer (statistical detection), active manipulator (resave, resize, recompress), or steganalysis tool (RS analysis, chi-square).</li> <li>Goal: detect presence, extract, ho\u1eb7c ph\u00e1 h\u1ee7y payload.</li> </ul>"},{"location":"algorithms/stego/steganography/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n m\u00e3 h\u00f3a v\u1edbi AE (AES\u2011GCM) v\u00e0 per\u2011message nonce.</li> <li>Randomize embedding positions via PRNG keyed b\u1eb1ng key/seed (keeps deterministic per key).</li> <li>Th\u00eam cover-aware encoding: use pseudo-random pixel order, skip edges/alpha channel.</li> <li>Ki\u1ec3m tra capacity tr\u01b0\u1edbc khi nh\u00fang; abort n\u1ebfu kh\u00f4ng \u0111\u1ee7.</li> <li>T\u00edch h\u1ee3p integrity (tag) v\u00e0 sanity checks.</li> </ul>"},{"location":"algorithms/stego/steganography/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Setup: 2 pixels RGB (6 channels), b=1 \u2192 6 bits capacity.</li> <li>Cover RGB bytes: [0xAA,0x55,0xFF, 0x00,0x12,0x34] (bin: 10101010 01010101 ...)</li> <li>Payload bits to embed (6 bits): 1 0 1 0 1 1</li> <li>LSBs before \u2192 after: map each channel LSB := payload bit</li> <li>Resulting RGB LSBs produce stego bytes where each channel LSB set accordingly. (Use small handcrafted examples during unit tests; validate round-trip: embed \u2192 extract \u2192 decrypt \u2192 match.)</li> </ul>"},{"location":"algorithms/stego/steganography/#11-code-pseudo","title":"11. Code (pseudo)","text":"<ul> <li>Pseudocode embed/extract (sketch): Text Only<pre><code>embed(image, payload, key):\n    c, tag, nonce = AES_GCM_Encrypt(key, payload)\n    stream = pack(MAGIC, LEN(c), nonce, c, tag)\n    idx_seq = PRNG_positions(seed_from_key, image_capacity)\n    for i, bit in enumerate(bits(stream)):\n        pixel_byte = image[ idx_seq[i] ]\n        image[ idx_seq[i] ] = (pixel_byte &amp; ~1) | bit\n    return image\n</code></pre></li> </ul>"},{"location":"algorithms/stego/steganography/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Ki\u1ec3m tra capacity tr\u01b0\u1edbc embed</li> <li> AES\u2011GCM v\u1edbi unique nonce per message</li> <li> PRNG d\u00f9ng key-derived seed cho v\u1ecb tr\u00ed nh\u00fang (not public)</li> <li> Kh\u00f4ng l\u01b0u/\u0111\u1ed5i \u0111\u1ecbnh d\u1ea1ng sang lossy</li> <li> Ki\u1ec3m tra v\u00e0 validate tag khi extract</li> <li> Rotate MAGIC/VERSION \u0111\u1ec3 tr\u00e1nh fingerprinting</li> </ul>"},{"location":"algorithms/stego/steganography/#13-h\u1ea1n-ch\u1ebf--\u1ee9ng-d\u1ee5ng","title":"13. H\u1ea1n ch\u1ebf &amp; \u1ee9ng d\u1ee5ng","text":"<ul> <li>H\u1ea1n ch\u1ebf:<ul> <li>Dung l\u01b0\u1ee3ng th\u1ea5p (\u2248 \u215b file bytes khi b=1)</li> <li>Fragile v\u1edbi n\u00e9n lossy, resize, ch\u1ec9nh s\u1eeda</li> <li>D\u1ec5 ph\u00e1t hi\u1ec7n b\u1edfi steganalysis n\u1ebfu kh\u00f4ng randomize</li> </ul> </li> <li>\u1ee8ng d\u1ee5ng:<ul> <li>Trao \u0111\u1ed5i th\u00f4ng tin k\u00edn \u0111\u00e1o tr\u00ean k\u00eanh c\u00f4ng khai (\u1ea9n trong \u1ea3nh)</li> <li>Watermarking nh\u1eb9 (kh\u00f4ng thay th\u1ebf watermark chuy\u00ean d\u1ee5ng)</li> <li>Ti\u1ec7n cho test/demo, kh\u00f4ng thay th\u1ebf secure covert channels cho threat model cao</li> </ul> </li> </ul>"},{"location":"algorithms/stego/steganography/#ngu\u1ed3n-tham-kh\u1ea3o","title":"Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>Bender, Gruhl, Morimoto, Lu, \u201cTechniques for Data Hiding\u201d, 1996.</li> <li>Anderson &amp; Petitcolas, \u201cOn the Limits of Steganography\u201d, 1998.</li> <li>Cox et al., \u201cDigital Watermarking and Steganography\u201d, 2007.</li> <li>Tutorials/whitepapers v\u1ec1 AES\u2011GCM v\u00e0 steganalysis (RS test, chi-square).</li> </ul> <p>Ghi ch\u00fa: lu\u00f4n ki\u1ec3m tra ph\u00e1p l\u00fd khi s\u1eed d\u1ee5ng steganography tr\u00ean h\u1ec7 th\u1ed1ng th\u1ef1c t\u1ebf.</p>"},{"location":"algorithms/symmetric/ahead/","title":"AEAD (GCM) Algorithms","text":""},{"location":"algorithms/symmetric/ahead/#aead-gcm-algorithms","title":"AEAD (GCM) Algorithms","text":"<p>This folder lists authenticated encryption options in FileVault. Each page follows a 12-part template (concept, math, flow, data structures, comparison, sequence diagram, pitfalls, threat model, mitigations, test vectors, code, checklist).</p>"},{"location":"algorithms/symmetric/ahead/#quick-matrix","title":"Quick matrix","text":"Algorithm Profile hints Key sizes Nonce Tag Notes AES-GCM Default (<code>PROFESSIONAL</code>, <code>ADVANCED</code>) 256 (default), 128/192 96-bit 128-bit Fast with AES-NI; avoid nonce reuse ARIA-GCM KR / RFC 5794 compatibility 128/192/256 96-bit 128-bit Korean standard; no AES-NI acceleration Camellia-GCM JP/EU compliance, AES alternative 128/192/256 96-bit 128-bit Strong AES alternative; good HW support in some SoCs ChaCha20-Poly1305 Mobile/No AES-NI 256 96-bit 128-bit Constant-time ARX; limit 256 GiB per nonce Serpent-GCM <code>PARANOID</code> / archival 128/192/256 (256 default) 96-bit 128-bit High security margin; slower SM4-GCM CN compliance (GB/T 32907) 128 96-bit 128-bit For WAPI/TCM/TPM ecosystems Twofish-GCM AES-avoidance, open design 128/192/256 96-bit 128-bit Key-dependent S-box; slower than AES"},{"location":"algorithms/symmetric/ahead/#usage-reminders","title":"Usage reminders","text":"<ul> <li>Never reuse a nonce with the same key; use CSPRNG or monotonic counters per key.</li> <li>Keep full 128-bit tags; avoid truncation below 96 bits.</li> <li>Always authenticate metadata via AAD (filenames, versions, policy) to prevent context confusion and replay.</li> <li>Use library-provided constant-time implementations; avoid custom cipher or GHASH code.</li> </ul>"},{"location":"algorithms/symmetric/ahead/#related-docs","title":"Related docs","text":"<ul> <li>Concepts: docs/concepts/key_management.md</li> <li>Workflows: docs/workflows/encryption_flow.md, docs/workflows/decryption_flow.md</li> <li>CLI usage: docs/cli/cli.md, docs/cli/demo.md</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/","title":"AES-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/aes-gcm/#aes-gcm-galoiscounter-mode","title":"AES-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/aes-gcm/#1-t\u00f3m-t\u1eaft","title":"1. T\u00f3m t\u1eaft","text":"<p>AES-GCM l\u00e0 m\u1ed9t ch\u1ebf \u0111\u1ed9 m\u00e3 h\u00f3a x\u00e1c th\u1ef1c (Authenticated Encryption with Associated Data - AEAD). N\u00f3 cung c\u1ea5p \u0111\u1ed3ng th\u1eddi c\u1ea3 t\u00ednh b\u1ea3o m\u1eadt (confidentiality), t\u00ednh to\u00e0n v\u1eb9n (integrity) v\u00e0 t\u00ednh x\u00e1c th\u1ef1c (authenticity) cho d\u1eef li\u1ec7u.</p> <p>Trong FileVault, AES-256-GCM l\u00e0 thu\u1eadt to\u00e1n m\u1eb7c \u0111\u1ecbnh v\u00e0 \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb cho m\u1ecdi m\u1ee5c \u0111\u00edch s\u1eed d\u1ee5ng (ch\u1ebf \u0111\u1ed9 <code>PROFESSIONAL</code> v\u00e0 <code>ADVANCED</code>). N\u00f3 kh\u1eafc ph\u1ee5c c\u00e1c \u0111i\u1ec3m y\u1ebfu c\u1ee7a AES-CBC b\u1eb1ng c\u00e1ch t\u00edch h\u1ee3p x\u00e1c th\u1ef1c v\u00e0 c\u00f3 hi\u1ec7u n\u0103ng cao nh\u1edd kh\u1ea3 n\u0103ng t\u00ednh to\u00e1n song song.</p>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#2-thu\u1eadt-to\u00e1n--to\u00e1n-h\u1ecdc","title":"2. Thu\u1eadt to\u00e1n &amp; To\u00e1n h\u1ecdc","text":""},{"location":"algorithms/symmetric/ahead/aes-gcm/#thu\u1eadt-to\u00e1n-chi-ti\u1ebft-aes-ctr--ghash--gmac","title":"Thu\u1eadt to\u00e1n chi ti\u1ebft (AES-CTR + GHASH / GMAC)","text":"<ul> <li> <p>AES-GCM k\u1ebft h\u1ee3p:</p> <ol> <li>AES-CTR \u0111\u1ec3 m\u00e3 h\u00f3a (keystream t\u1eeb AES).</li> <li>GHASH/GMAC \u0111\u1ec3 t\u00ednh gi\u00e1 tr\u1ecb x\u00e1c th\u1ef1c tr\u00ean AAD v\u00e0 ciphertext.</li> </ol> </li> <li> <p>\u0110\u1ecbnh ngh\u0129a c\u01a1 b\u1ea3n:</p> <ul> <li>\\(H = E_K(0^{128})\\) (block AES c\u1ee7a 128-bit s\u1ed1 0).</li> <li>Nonce 96-bit: \\(J_0 = \\text{Nonce} \\parallel 0^{31} \\parallel 1\\). N\u1ebfu Nonce kh\u00f4ng ph\u1ea3i 96-bit th\u00ec \\(J_0 = \\text{GHASH}(H, \\text{Nonce})\\) theo chu\u1ea9n.</li> </ul> </li> <li> <p>CTR (m\u00e3 h\u00f3a):</p> <ul> <li>V\u1edbi \\(J_0\\) \u0111\u00e3 c\u00f3, \u0111\u1ecbnh ngh\u0129a b\u1ed9 \u0111\u1ebfm cho block th\u1ee9 \\(i\\):     $$     \\text{CTR}_i = \\text{inc32}(J_0, i)     $$</li> <li>Keystream block: \\(S_i = E_K(\\text{CTR}_i)\\).</li> <li>M\u00e3 h\u00f3a block plaintext \\(P_i\\):     $$     C_i = P_i \\oplus S_i     $$</li> </ul> </li> <li> <p>GHASH (m\u00e3 h\u00f3a \u0111a th\u1ee9c trong \\(GF(2^{128})\\)):</p> <ul> <li>X\u00e1c \u0111\u1ecbnh c\u00e1c block 128-bit:<ul> <li>Chia AAD th\u00e0nh \\(A_1,\\dots,A_u\\) (padding cu\u1ed1i b\u1eb1ng 0 n\u1ebfu c\u1ea7n).</li> <li>Chia ciphertext th\u00e0nh \\(C_1,\\dots,C_v\\) (padding cu\u1ed1i b\u1eb1ng 0 n\u1ebfu c\u1ea7n).</li> <li>Kh\u1ed1i cu\u1ed1i: \\(L = \\text{len}(A)_{64} \\parallel \\text{len}(C)_{64}\\) (\u0111\u1ed9 d\u00e0i t\u00ednh b\u1eb1ng bit).</li> </ul> </li> <li>T\u1ea1o d\u00e3y kh\u1ed1i:     $$     X = [A_1,\\dots,A_u,\\,C_1,\\dots,C_v,\\,L]     $$</li> <li>Kh\u1edfi t\u1ea1o \\(Y_0 = 0\\). V\u1edbi m\u1ed7i \\(i\\ge1\\):     $$     Y_i = (Y_{i-1} \\oplus X_i)\\cdot H     $$     trong \u0111\u00f3 ph\u00e9p \\(\\cdot\\) l\u00e0 ph\u00e9p nh\u00e2n trong tr\u01b0\u1eddng Galois \\(GF(2^{128})\\) (carry-less polynomial multiplication) v\u00e0 gi\u1ea3m modulo \u0111a th\u1ee9c chu\u1ea9n     $$     R(x)=x<sup>{128}+x</sup>7+x^2+x+1.     $$</li> <li>K\u1ebft qu\u1ea3 GHASH:     $$     \\text{GHASH}(H,A,C)=Y_{u+v+1}.     $$</li> </ul> </li> <li> <p>T\u00ednh Tag (Authentication Tag):</p> <ul> <li>Gi\u00e1 tr\u1ecb x\u00e1c th\u1ef1c trung gian \\(S=\\text{GHASH}(H,A,C)\\).</li> <li>Tag \u0111\u1ea7y \u0111\u1ee7 (128-bit):     $$     T = E_K(J_0) \\oplus S.     $$</li> <li>N\u1ebfu c\u1ea7n tag r\u00fat g\u1ecdn th\u00ec l\u1ea5y \\(t\\) bit cao c\u1ee7a \\(T\\): \\(\\text{Tag}=\\text{MSB}_t(T)\\) (kh\u00f4ng khuy\u1ebfn ngh\u1ecb r\u00fat g\u1ecdn d\u01b0\u1edbi 96 bit).</li> </ul> </li> <li> <p>Ghi ch\u00fa ng\u1eafn:</p> <ul> <li>GMAC l\u00e0 tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a GHASH khi ch\u1ec9 c\u00f3 AAD (ciphertext r\u1ed7ng).</li> <li>An to\u00e0n y\u00eau c\u1ea7u \\(H\\) \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb c\u00f9ng key \\(K\\) d\u00f9ng cho AES; nonce ph\u1ea3i l\u00e0 duy nh\u1ea5t cho m\u1ed7i \\(K\\) (nonce reuse ph\u00e1 v\u1ee1 t\u00ednh b\u1ea3o m\u1eadt).</li> </ul> </li> </ul> <p>Ph\u00e9p nh\u00e2n trong tr\u01b0\u1eddng Galois \\(GF(2^{128})\\) \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u00ednh to\u00e1n tag x\u00e1c th\u1ef1c, cho ph\u00e9p x\u1eed l\u00fd song song v\u00e0 hi\u1ec7u qu\u1ea3 ph\u1ea7n c\u1ee9ng cao.</p>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Key &amp; Nonce: S\u1eed d\u1ee5ng Key (AES) v\u00e0 Nonce (96-bit recommended).</li> <li>Encryption (CTR mode):<ul> <li>T\u1ea1o counter block \\(J_0\\) t\u1eeb Nonce.</li> <li>Increment counter cho m\u1ed7i block ti\u1ebfp theo.</li> <li>M\u00e3 h\u00f3a counter block b\u1eb1ng AES \u0111\u1ec3 t\u1ea1o keystream.</li> <li>XOR keystream v\u1edbi Plaintext \u0111\u1ec3 t\u1ea1o Ciphertext.</li> </ul> </li> <li>Authentication (GHASH):<ul> <li>D\u1eef li\u1ec7u li\u00ean k\u1ebft (AAD - Associated Data) v\u00e0 Ciphertext \u0111\u01b0\u1ee3c \u0111\u01b0a qua h\u00e0m GHASH.</li> <li>K\u1ebft qu\u1ea3 \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a v\u1edbi block \u0111\u1ea7u ti\u00ean c\u1ee7a keystream \u0111\u1ec3 t\u1ea1o Authentication Tag (th\u01b0\u1eddng l\u00e0 16 bytes).</li> </ul> </li> </ol>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key Size: 256 bits (32 bytes) - FileVault default.</li> <li>Nonce (IV): 96 bits (12 bytes). C\u1ef0C K\u1ef2 QUAN TR\u1eccNG: KH\u00d4NG BAO GI\u1edc \u0110\u01af\u1ee2C D\u00d9NG L\u1ea0I (NONCE REUSE IS FATAL).</li> <li>Tag Size: 128 bits (16 bytes).</li> <li>Block Size: 128 bits (16 bytes).</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#5-so-s\u00e1nh-v\u1edbi-aes-cbc","title":"5. So s\u00e1nh v\u1edbi AES-CBC","text":"\u0110\u1eb7c \u0111i\u1ec3m AES-GCM AES-CBC Lo\u1ea1i AEAD (M\u00e3 h\u00f3a + X\u00e1c th\u1ef1c) Ch\u1ec9 m\u00e3 h\u00f3a B\u1ea3o m\u1eadt R\u1ea5t cao (n\u1ebfu Nonce unique) Trung b\u00ecnh (d\u1ec5 b\u1ecb Padding Oracle) Hi\u1ec7u n\u0103ng R\u1ea5t cao (Parallelizable) Th\u1ea5p h\u01a1n (Sequential) Padding Kh\u00f4ng c\u1ea7n (Stream cipher) C\u1ea7n (PKCS#7) R\u1ee7i ro Nonce reuse = L\u1ed9 Key Padding Oracle, Bit-flipping"},{"location":"algorithms/symmetric/ahead/aes-gcm/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant GCM_Engine\n    participant Receiver\n\n    Sender-&gt;&gt;GCM_Engine: Key, Nonce, Plaintext, AAD\n    GCM_Engine-&gt;&gt;GCM_Engine: CTR Encrypt -&gt; Ciphertext\n    GCM_Engine-&gt;&gt;GCM_Engine: GHASH(AAD, Ciphertext) -&gt; Tag\n    GCM_Engine-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;GCM_Engine: Key, Nonce, Ciphertext, Tag, AAD\n    GCM_Engine-&gt;&gt;GCM_Engine: GHASH(AAD, Ciphertext) -&gt; Calculated Tag\n    alt Tag Match\n        GCM_Engine-&gt;&gt;GCM_Engine: CTR Decrypt -&gt; Plaintext\n        GCM_Engine-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        GCM_Engine--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/aes-gcm/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce Reuse (IV Reuse): \u0110\u00e2y l\u00e0 l\u1ed7i nghi\u00eam tr\u1ecdng nh\u1ea5t c\u1ee7a GCM. N\u1ebfu d\u00f9ng c\u00f9ng Key v\u00e0 Nonce cho 2 message kh\u00e1c nhau:<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c XOR c\u1ee7a 2 plaintext.</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 gi\u1ea3 m\u1ea1o th\u00f4ng \u0111i\u1ec7p (forge authentication tag).</li> <li>FileVault Check: Code s\u1eed d\u1ee5ng <code>Botan::AutoSeeded_RNG</code> sinh 12-byte nonce ng\u1eabu nhi\u00ean cho m\u1ed7i l\u1ea7n m\u00e3 h\u00f3a. X\u00e1c su\u1ea5t tr\u00f9ng l\u1eb7p l\u00e0 c\u1ef1c th\u1ea5p (\\(1/2^{96}\\)), an to\u00e0n cho l\u01b0\u1ee3ng file v\u1eeba ph\u1ea3i.</li> </ul> </li> <li>Tag Truncation: C\u1eaft ng\u1eafn tag xu\u1ed1ng d\u01b0\u1edbi 96 bits l\u00e0m gi\u1ea3m \u0111\u1ed9 an to\u00e0n x\u00e1c th\u1ef1c.<ul> <li>FileVault Check: Code d\u00f9ng full 128-bit tag (16 bytes).</li> </ul> </li> <li>B\u1ecf qua AAD: Kh\u00f4ng x\u00e1c th\u1ef1c metadata (nh\u01b0 filename, version) trong AAD cho ph\u00e9p k\u1ebb t\u1ea5n c\u00f4ng tr\u00e1o \u0111\u1ed5i file context.</li> </ol>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Attack Scenarios:<ol> <li>Forgery: Attacker s\u1eeda \u0111\u1ed5i ciphertext tr\u00ean \u0111\u0129a.<ul> <li>Result: Khi gi\u1ea3i m\u00e3, GCM s\u1ebd ph\u00e1t hi\u1ec7n tag kh\u00f4ng kh\u1edbp v\u00e0 t\u1eeb ch\u1ed1i gi\u1ea3i m\u00e3. D\u1eef li\u1ec7u r\u00e1c kh\u00f4ng bao gi\u1edd \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 cho user.</li> </ul> </li> <li>Nonce Reuse: Do bug ho\u1eb7c RNG k\u00e9m.<ul> <li>Result: M\u1ea5t t\u00ednh b\u1ea3o m\u1eadt ho\u00e0n to\u00e0n.</li> </ul> </li> </ol> </li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n d\u00f9ng RNG ch\u1ea5t l\u01b0\u1ee3ng cao (CSPRNG) cho Nonce.</li> <li>N\u1ebfu m\u00e3 h\u00f3a l\u01b0\u1ee3ng d\u1eef li\u1ec7u c\u1ef1c l\u1edbn (&gt; \\(2^{32}\\) files) v\u1edbi c\u00f9ng m\u1ed9t key, c\u00e2n nh\u1eafc xoay v\u00f2ng key (key rotation) ho\u1eb7c d\u00f9ng AES-GCM-SIV (nonce-misuse resistant).</li> <li>X\u00e1c th\u1ef1c c\u1ea3 header file (AAD) \u0111\u1ec3 tr\u00e1nh t\u1ea5n c\u00f4ng replay ho\u1eb7c context confusion.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#10-test-vectors-aes-256-gcm","title":"10. Test Vectors (AES-256-GCM)","text":"<ul> <li>Key: <code>feffe9928665731c6d6a8f9467308308feffe9928665731c6d6a8f9467308308</code></li> <li>Nonce: <code>cafebabefacedbaddecaf888</code> (12 bytes)</li> <li>Plaintext: <code>d9313225f88406e5a55909c5aff5269a86a7a9531534f7da2e4c303d8a318a721c3c0c95956809532fcf0e2449a6b525b16aedf5aa0de657ba637b39</code></li> <li>Ciphertext: <code>42831ec2217774244b7221b784d0d49ce3aa212f2c02a4e035c17e2329aca12e21d514b25466931c7d8f6a5aac84aa051ba30b396a0aac973d58e091</code></li> <li>Tag: <code>5bc94fbc3221a5db94fae95ae7121a47</code></li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#11-v\u00ed-d\u1ee5-code-python","title":"11. V\u00ed d\u1ee5 Code (Python)","text":"Python<pre><code>import os\nfrom cryptography.hazmat.primitives.ciphers.aead import AESGCM\n\ndef encrypt_aes_gcm(key, plaintext, aad=b\"\"):\n    # Key: 32 bytes (256 bits)\n    aesgcm = AESGCM(key)\n    nonce = os.urandom(12) # 96 bits\n\n    # Encrypt returns ciphertext + tag appended\n    ciphertext_with_tag = aesgcm.encrypt(nonce, plaintext, aad)\n\n    return nonce + ciphertext_with_tag\n\ndef decrypt_aes_gcm(key, data, aad=b\"\"):\n    nonce = data[:12]\n    ciphertext_with_tag = data[12:]\n\n    aesgcm = AESGCM(key)\n\n    # Raises InvalidTag if verification fails\n    plaintext = aesgcm.decrypt(nonce, ciphertext_with_tag, aad)\n    return plaintext\n</code></pre>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist B\u1ea3o M\u1eadt","text":"<ul> <li> S\u1eed d\u1ee5ng AES-256-GCM l\u00e0m m\u1eb7c \u0111\u1ecbnh.</li> <li> Nonce ph\u1ea3i l\u00e0 12 bytes (96 bits).</li> <li> Nonce ph\u1ea3i ng\u1eabu nhi\u00ean (ho\u1eb7c counter) v\u00e0 duy nh\u1ea5t cho m\u1ed7i key.</li> <li> Ki\u1ec3m tra Tag tr\u01b0\u1edbc khi x\u1eed l\u00fd b\u1ea5t k\u1ef3 d\u1eef li\u1ec7u plaintext n\u00e0o.</li> <li> \u0110\u01b0a metadata quan tr\u1ecdng (filename, version) v\u00e0o AAD \u0111\u1ec3 b\u1ea3o v\u1ec7 t\u00ednh to\u00e0n v\u1eb9n c\u1ee7a ng\u1eef c\u1ea3nh.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Y\u00eau c\u1ea7u nonce duy nh\u1ea5t cho m\u1ed7i key \u2014 nonce reuse ph\u00e1 v\u1ee1 to\u00e0n b\u1ed9 b\u1ea3o m\u1eadt.</li> <li>Kh\u00f4ng ch\u1ed1ng \u0111\u01b0\u1ee3c nonce-misuse; n\u1ebfu c\u1ea7n kh\u00e1ng l\u1ed7i nonce, c\u00e2n nh\u1eafc AES\u2011GCM\u2011SIV.</li> <li>Tr\u00edch ng\u1eafn Tag (d\u01b0\u1edbi ~96 bit) l\u00e0m gi\u1ea3m m\u1ea1nh an to\u00e0n x\u00e1c th\u1ef1c.</li> <li>Gi\u1edbi h\u1ea1n an to\u00e0n theo khuy\u1ebfn ngh\u1ecb ti\u00eau chu\u1ea9n (gi\u1edbi h\u1ea1n l\u01b0\u1ee3ng d\u1eef li\u1ec7u/kh\u1ed1i m\u00e3 h\u00f3a tr\u00ean m\u1ed9t key) \u2014 tu\u00e2n th\u1ee7 NIST SP 800\u201138D.</li> <li>R\u1ee7i ro tri\u1ec3n khai: side\u2011channel (timing, cache), l\u1ed7i padding/length handling, sai x\u1eed l\u00fd AAD.</li> <li>Kh\u00f4ng th\u00edch h\u1ee3p khi c\u1ea7n x\u00e1c th\u1ef1c tr\u01b0\u1edbc khi bi\u1ebft to\u00e0n b\u1ed9 lu\u1ed3ng d\u1eef li\u1ec7u (streaming v\u1edbi tag tr\u01b0\u1edbc t\u00ednh to\u00e0n v\u1eb9n kh\u00f3 x\u1eed l\u00fd).</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 h\u00f3a giao th\u1ee9c: TLS (AES\u2011GCM cipher suites), IPsec.</li> <li>L\u01b0u tr\u1eef &amp; b\u1ea3o v\u1ec7 file: disk/volume encryption, file containers (FileVault).</li> <li>Giao ti\u1ebfp b\u1ea3o m\u1eadt: VPN, messaging, secure backups.</li> <li>\u1ee8ng d\u1ee5ng nh\u00fang v\u00e0 ph\u1ea7n c\u1ee9ng nh\u1edd hi\u1ec7u n\u0103ng cao v\u00e0 kh\u1ea3 n\u0103ng t\u00ednh to\u00e1n song song.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-gcm/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800\u201138D \u2014 Recommendation for Block Cipher Modes of Operation: GCM and GMAC. https://csrc.nist.gov/publications/detail/sp/800-38d/final</li> <li>McGrew, D. &amp; Viega, J. \u2014 The Galois/Counter Mode (GCM). (g\u1ed1c/paper).  </li> <li>RFC 5116 \u2014 An Interface and Algorithms for Authenticated Encryption. https://tools.ietf.org/html/rfc5116</li> <li>RFC 5288 \u2014 AES GCM Cipher Suites for TLS. https://tools.ietf.org/html/rfc5288</li> <li>RFC 8452 \u2014 AES\u2011GCM\u2011SIV: Nonce\u2011misuse resistant AEAD. https://tools.ietf.org/html/rfc8452</li> <li>Practical implementation guides and crypto libraries' docs (e.g., OpenSSL, Botan, cryptography) \u2014 ki\u1ec3m tra API v\u00e0 khuy\u1ebfn ngh\u1ecb nonce/tag.</li> <li>C\u00e1c b\u00e0i vi\u1ebft v\u1ec1 side\u2011channel v\u00e0 pitfalls (McGrew &amp; Viega, blog/security analyses) \u2014 \u0111\u1ecdc k\u1ef9 tr\u01b0\u1edbc khi tri\u1ec3n khai s\u1ea3n xu\u1ea5t.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/","title":"AES-XTS","text":""},{"location":"algorithms/symmetric/ahead/aes-xts/#aes-xts","title":"AES-XTS","text":""},{"location":"algorithms/symmetric/ahead/aes-xts/#0-ng\u1eef-c\u1ea3nh-filevault","title":"0. Ng\u1eef c\u1ea3nh Filevault","text":"<p>AES-XTS l\u00e0 ch\u1ebf \u0111\u1ed9 m\u00e3 ho\u00e1 block \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf cho m\u00e3 ho\u00e1 \u1ed5 \u0111\u0129a/kh\u1ed1i d\u1eef li\u1ec7u (disk encryption). Th\u00edch h\u1ee3p cho h\u1ec7 th\u1ed1ng l\u01b0u tr\u1eef nh\u01b0 FileVault, LUKS, BitLocker \u2014 n\u01a1i d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c chia th\u00e0nh \"data unit\" (sector/cluster) m\u00e3 ho\u00e1 \u0111\u1ed9c l\u1eadp.</p>"},{"location":"algorithms/symmetric/ahead/aes-xts/#1-kh\u00e1i-ni\u1ec7m","title":"1. Kh\u00e1i ni\u1ec7m","text":"<p>AES-XTS (XEX Tweakable Block Cipher with ciphertext stealing) l\u00e0 ch\u1ebf \u0111\u1ed9 block-tweak d\u00f9ng AES l\u00e0m kh\u1ed1i c\u01a1 s\u1edf \u0111\u1ec3 cung c\u1ea5p t\u00ednh b\u1ea3o m\u1eadt cho kh\u1ed1i d\u1eef li\u1ec7u theo \u0111\u01a1n v\u1ecb. M\u1ee5c ti\u00eau: b\u1ea3o v\u1ec7 t\u00ednh b\u00ed m\u1eadt c\u1ee7a d\u1eef li\u1ec7u tr\u00ean \u1ed5 \u0111\u0129a, cho ph\u00e9p m\u00e3 ho\u00e1 t\u1eebng sector \u0111\u1ed9c l\u1eadp, ng\u0103n vi\u1ec7c t\u00e1i s\u1eed d\u1ee5ng m\u1eabu b\u1eb1ng \"tweak\".</p>"},{"location":"algorithms/symmetric/ahead/aes-xts/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Hai kho\u00e1: \\(K_1\\) (d\u1eef li\u1ec7u), \\(K_2\\) (tweak).</li> <li>Tweak ban \u0111\u1ea7u: \\(T_0 = E_{K_2}(IV)\\), v\u1edbi \\(IV\\) th\u01b0\u1eddng l\u00e0 s\u1ed1 \u0111\u01a1n v\u1ecb d\u1eef li\u1ec7u (data unit number).</li> <li>Tweak cho block th\u1ee9 \\(i\\): \\(T_i = \\alpha^i \\otimes T_0\\) trong \\(GF(2^{128})\\), v\u1edbi \\(\\alpha = 2\\).</li> <li>M\u00e3 ho\u00e1 block:     $$     C_i = E_{K_1}(P_i \\oplus T_i) \\oplus T_i     $$</li> <li>V\u1edbi block kh\u00f4ng \u0111\u1ea7y: d\u00f9ng ciphertext stealing (CTS).</li> </ul> <p>Ph\u00e9p nh\u00e2n \\(\\alpha\\) trong GF(2^{128}) t\u01b0\u01a1ng \u0111\u01b0\u01a1ng: - shift-left 1 bit; n\u1ebfu MSB tr\u01b0\u1edbc shift = 1 th\u00ec XOR v\u1edbi \\(0x87\\).</p>"},{"location":"algorithms/symmetric/ahead/aes-xts/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ul> <li>Nh\u1eadn data unit ID \u2192 t\u00ednh \\(T_0 = E_{K_2}(ID)\\).</li> <li>V\u1edbi m\u1ed7i block i: t\u00ednh \\(T_i\\) t\u1eeb \\(T_{i-1}\\), \u00e1p d\u1ee5ng XOR v\u1edbi plaintext, AES encrypt v\u1edbi \\(K_1\\), XOR l\u1ea1i tweak \u2192 ciphertext.</li> <li>N\u1ebfu cu\u1ed1i data unit c\u00f3 block kh\u00f4ng \u0111\u1ea7y, \u00e1p d\u1ee5ng CTS \u0111\u1ec3 gi\u1eef k\u00edch th\u01b0\u1edbc.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Data unit: sequence of 128\u2011bit blocks (AES block size), cu\u1ed1i c\u00f3 th\u1ec3 partial block.</li> <li>Keys: \\(K_1, K_2\\) (k\u00edch th\u01b0\u1edbc 128/192/256 bits).</li> <li>IV/data unit number: 64- ho\u1eb7c 128\u2011bit (th\u01b0\u1eddng 128\u2011bit little-endian sector number).</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-ch\u1ebf-\u0111\u1ed9-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c ch\u1ebf \u0111\u1ed9 kh\u00e1c","text":"<ul> <li>Vs CBC: XTS cho ph\u00e9p truy c\u1eadp ng\u1eabu nhi\u00ean sector, tr\u00e1nh propagation l\u1ed7i sang sector kh\u00e1c; CBC kh\u00f4ng ph\u00f9 h\u1ee3p cho disk.</li> <li>Vs CTR: CTR cho truy c\u1eadp ng\u1eabu nhi\u00ean nh\u01b0ng c\u1ea7n qu\u1ea3n l\u00fd nonce; CTR c\u0169ng kh\u00f4ng cung c\u1ea5p integrity.</li> <li>Vs AEAD (GCM/ChaCha20-Poly1305): AEAD cung c\u1ea5p t\u00ednh to\u00e0n v\u1eb9n; XTS ch\u1ec9 cung c\u1ea5p t\u00ednh b\u1ea3o m\u1eadt (confidentiality) cho blocks, kh\u00f4ng integrity/authentication.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-flow","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (flow)","text":"<p>Mermaid: </p> <pre><code>flowchart LR\n    A[Start\\nData Unit ID] --&gt; B[\"Compute initial tweak\\nT0 = AES-Enc(K2, ID)\"]\n\n    subgraph FullBlocks [Process full blocks]\n        direction LR\n        B --&gt; C[\"Update tweak\\nTi = GF(2^128) multiply(Ti-1)\"]\n        C --&gt; D[\"Xi = Pi XOR Ti\"]\n        D --&gt; E[\"Yi = AES-Enc(K1, Xi)\"]\n        E --&gt; F[\"Ci = Yi XOR Ti\"]\n    end\n\n    F --&gt; G{Final block\\npartial?}\n    G -- Yes --&gt; H[\"Handle final block\\n(ciphertext stealing)\"]\n    G -- No --&gt; I[Skip]\n    H --&gt; J[Output ciphertext]\n    I --&gt; J\n</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/symmetric/ahead/aes-xts/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>Tweak reuse v\u1edbi c\u00f9ng ID v\u00e0 c\u00f9ng key gi\u1eefa d\u1eef li\u1ec7u kh\u00e1c nhau.</li> <li>Sai th\u1ee9 t\u1ef1 endianness khi t\u1ea1o IV/sector number.</li> <li>Sai ph\u00e9p nh\u00e2n trong GF(2^128) (qu\u00ean XOR 0x87).</li> <li>Kh\u00f4ng x\u1eed l\u00fd \u0111\u00fang ciphertext stealing cho partial block.</li> <li>Tin r\u1eb1ng XTS cung c\u1ea5p integrity (kh\u00f4ng c\u00f3).</li> <li>Kh\u00f3a weak qu\u1ea3n l\u00fd (chia s\u1ebb K1/K2 ho\u1eb7c d\u00f9ng K1=K2).</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 \u0111\u1ecdc/ghi \u0111\u1ebfn \u0111\u0129a nh\u01b0ng kh\u00f4ng bi\u1ebft kh\u00f3a.</li> <li>M\u1ee5c ti\u00eau: ng\u0103n k\u1ebb t\u1ea5n c\u00f4ng bi\u1ebft n\u1ed9i dung d\u1eef li\u1ec7u (confidentiality).</li> <li>Kh\u00f4ng b\u1ea3o v\u1ec7 ch\u1ed1ng thay \u0111\u1ed5i d\u1eef li\u1ec7u (tampering) n\u1ebfu kh\u00f4ng c\u00f3 c\u01a1 ch\u1ebf integrity.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>K\u1ebft h\u1ee3p v\u1edbi MAC/AEAD \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o integrity (v\u00ed d\u1ee5: encrypt-then-MAC ho\u1eb7c d\u00f9ng AEAD).</li> <li>Gi\u1eef K1 v\u00e0 K2 ri\u00eang bi\u1ec7t, qu\u1ea3n l\u00fd kh\u00f3a an to\u00e0n (HSM/KMS).</li> <li>Kh\u00f4ng t\u00e1i s\u1eed d\u1ee5ng data unit ID/tweak.</li> <li>Ki\u1ec3m tra v\u00e0 chu\u1ea9n h\u00f3a endianness.</li> <li>B\u1ea3o v\u1ec7 ch\u1ed1ng side-channel (constant-time AES, tr\u00e1nh table lookups).</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#10-test-vectors","title":"10. Test Vectors","text":"<p>V\u00ed d\u1ee5 m\u1eabu (kh\u00f4ng ph\u1ea3i ti\u00eau chu\u1ea9n \u2014 d\u00f9ng \u0111\u1ec3 ki\u1ec3m tra lu\u1ed3ng): - K1 = 000102030405060708090a0b0c0d0e0f - K2 = 0f0e0d0c0b0a09080706050403020100 - Data unit = 00000000000000000000000000000001 - Plaintext block 0 = 00112233445566778899aabbccddeeff - Ciphertext block 0 = (ki\u1ec3m tra tri\u1ec3n khai b\u1eb1ng vector ti\u00eau chu\u1ea9n NIST/IEEE)</p> <p>\u0110\u1ec3 ki\u1ec3m tra th\u1ef1c t\u1ebf, d\u00f9ng vectors ch\u00ednh th\u1ee9c trong NIST SP 800-38E / IEEE P1619.</p>"},{"location":"algorithms/symmetric/ahead/aes-xts/#11-code-m\u1eabu-ng\u1eafn","title":"11. Code (m\u1eabu ng\u1eafn)","text":"<p>Python (pseudo): </p>Python<pre><code>def xts_mul(t):\n        msb = t[0] &gt;&gt; 7\n        t = ((t &lt;&lt; 1) &amp; ((1&lt;&lt;128)-1))\n        if msb: t ^= 0x87\n        return t\n\ndef xts_encrypt_block(k1,k2,tid,pi,i):\n        if i==0: t = AES(k2,tid)\n        else: t = xts_mul(prev_t)\n        ci = AES(k1, pi ^ t) ^ t\n        prev_t = t\n</code></pre><p></p>"},{"location":"algorithms/symmetric/ahead/aes-xts/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> K1 \u2260 K2; kh\u00f3a \u0111\u01b0\u1ee3c t\u1ea1o an to\u00e0n.</li> <li> Data unit IDs duy nh\u1ea5t / \u0111\u00fang endianness.</li> <li> X\u00e1c th\u1ef1c x\u1eed l\u00fd partial blocks.</li> <li> S\u1eed d\u1ee5ng MAC/AE n\u1ebfu c\u1ea7n integrity.</li> <li> B\u1ea3o v\u1ec7 ch\u1ed1ng side-channel.</li> <li> Ki\u1ec3m th\u1eed v\u1edbi vectors NIST/IEEE.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#13-h\u1ea1n-ch\u1ebf","title":"13. H\u1ea1n ch\u1ebf","text":"<ul> <li>Kh\u00f4ng cung c\u1ea5p integrity/authentication.</li> <li>Kh\u00f4ng ch\u1ed1ng replay n\u1ebfu attacker thay sector.</li> <li>Thi\u1ebft k\u1ebf cho l\u01b0u tr\u1eef block-oriented, kh\u00f4ng t\u1ed1i \u01b0u cho stream nh\u1ecf/kh\u1ed1i d\u1eef li\u1ec7u ng\u1eafn.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 ho\u00e1 \u1ed5 \u0111\u0129a (FileVault, LUKS, BitLocker), thi\u1ebft b\u1ecb l\u01b0u tr\u1eef, h\u1ec7 th\u1ed1ng file m\u00e3 ho\u00e1.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aes-xts/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800-38E \u2014 Recommendation for Block Cipher Modes of Operation: XTS-AES.</li> <li>IEEE P1619 \u2014 Standard for Cryptographic Protection of Data on Block-Oriented Storage Devices.</li> <li>C\u00e1c th\u01b0 vi\u1ec7n th\u1ef1c hi\u1ec7n: OpenSSL, libgcrypt, Linux kernel dm-crypt.</li> </ul> <p>Th\u00eam: ki\u1ec3m tra vectors ch\u00ednh th\u1ee9c trong NIST/IEEE khi tri\u1ec3n khai.</p>"},{"location":"algorithms/symmetric/ahead/aria-gcm/","title":"ARIA-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/aria-gcm/#aria-gcm-galoiscounter-mode","title":"ARIA-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/aria-gcm/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<p>ARIA-GCM k\u1ebft h\u1ee3p block cipher ARIA (chu\u1ea9n qu\u1ed1c gia H\u00e0n Qu\u1ed1c KS X 1213, m\u00f4 t\u1ea3 trong RFC 5794) v\u1edbi ch\u1ebf \u0111\u1ed9 AEAD Galois/Counter Mode. M\u1ee5c ti\u00eau: b\u1ea3o v\u1ec7 \u0111\u1ed3ng th\u1eddi t\u00ednh b\u1ea3o m\u1eadt, to\u00e0n v\u1eb9n v\u00e0 x\u00e1c th\u1ef1c c\u1ee7a d\u1eef li\u1ec7u; tr\u00e1nh padding oracle nh\u01b0 CBC v\u00e0 gi\u1ea3m nguy c\u01a1 l\u1ed7i t\u00edch h\u1ee3p MAC r\u1eddi.</p>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":""},{"location":"algorithms/symmetric/ahead/aria-gcm/#2-to\u00e1n-h\u1ecdc--thu\u1eadt-to\u00e1n-chi-ti\u1ebft-math-syntax","title":"2. To\u00e1n h\u1ecdc &amp; Thu\u1eadt to\u00e1n (chi ti\u1ebft, math syntax)","text":"<p>\u0110\u1eb7t k\u00fd hi\u1ec7u: - C\u00e1c block l\u00e0 128-bit, k\u00fd hi\u1ec7u b\u1eb1ng ch\u1eef hoa: \\(A_i, C_i, X_i,\\dots\\) - \\(|\\cdot|\\) l\u00e0 \u0111\u1ed9 d\u00e0i b\u1eb1ng bit. Bi\u1ec3u di\u1ec5n \u0111\u1ed9 d\u00e0i c\u1ee7a A v\u00e0 C l\u00e0 hai s\u1ed1 64-bit: \\(\\mathrm{len}_A= \\mathrm{int64}(|A|),\\ \\mathrm{len}_C=\\mathrm{int64}(|C|)\\). - Ph\u00e9p nh\u00e2n trong tr\u01b0\u1eddng h\u1eefu h\u1ea1n \\(GF(2^{128})\\) s\u1eed d\u1ee5ng nh\u00e2n carry-less v\u00e0 r\u00fat g\u1ecdn theo \u0111a th\u1ee9c b\u1ea5t kh\u1ea3 quy \\(\\(P(x)=x^{128}+x^7+x^2+x+1.\\)\\)     K\u00fd hi\u1ec7u nh\u00e2n l\u00e0 \\(\\otimes\\) (ngh\u0129a l\u00e0 carry-less mul r\u1ed3i mod \\(P(x)\\)).</p> <p>1) Kh\u1edfi t\u1ea1o - T\u00ednh \\(H = E_K(0^{128})\\) (block cipher ARIA tr\u00ean block s\u1ed1 0). - N\u1ebfu |IV| = 96 th\u00ec \\(\\(J_0 = IV \\,\\|\\, 0^{31} \\,\\|\\, 1.\\)\\)     (t\u1ee9c: IV (96-bit) n\u1ed1i v\u1edbi 31 bit 0 v\u00e0 m\u1ed9t bit 1.)     Ng\u01b0\u1ee3c l\u1ea1i (n\u1ebfu \\(|IV|\\neq 96\\)) th\u00ec \\(\\(J_0 = \\mathrm{GHASH}(H,\\ \\emptyset,\\ IV)\\)\\)     theo quy t\u1eafc GHASH (xem d\u01b0\u1edbi).</p> <p>2) GHASH \u2014 h\u00e0m x\u00e1c th\u1ef1c - Chia A (AAD) th\u00e0nh \\(u\\) block 128-bit: \\(A_1,\\dots,A_u\\) (cu\u1ed1i c\u00f9ng padded b\u1eb1ng 0 n\u1ebfu c\u1ea7n). - Chia ciphertext C th\u00e0nh \\(v\\) block 128-bit: \\(C_1,\\dots,C_v\\) (cu\u1ed1i c\u00f9ng padded b\u1eb1ng 0 n\u1ebfu c\u1ea7n). - \u0110\u1ecbnh ngh\u0129a chu\u1ed7i tr\u1ea1ng th\u00e1i:     \\begin{align*}     X_0 &amp;= 0^{128},\\     X_i &amp;= (X_{i-1}\\oplus A_i)\\otimes H,\\quad i=1..u,\\     X_{u+j} &amp;= (X_{u+j-1}\\oplus C_j)\\otimes H,\\quad j=1..v,\\     X_{u+v+1} &amp;= \\bigl(X_{u+v}\\oplus (\\mathrm{len}_A | \\mathrm{len}_C)\\bigr)\\otimes H.     \\end{align*} - K\u1ebft qu\u1ea3: \\(\\(\\mathrm{GHASH}(H,A,C) = X_{u+v+1}.\\)\\)     (\u1ede \u0111\u00e2y \\(\\mathrm{len}_A\\|\\mathrm{len}_C\\) l\u00e0 hai s\u1ed1 64-bit n\u1ed1i th\u00e0nh 128-bit, theo chu\u1ea9n GCM.)</p> <p>3) CTR encryption/decryption - \u0110\u1ebfm b\u1ed9 counter: cho \\(i=1..v\\), \\(\\(\\mathrm{CTR}_i = \\mathrm{inc32}(J_0,i)\\)\\)     (t\u0103ng ph\u1ea7n 32-bit cu\u1ed1i modulo \\(2^{32}\\)). - Keystream block: \\(\\(S_i = E_K(\\mathrm{CTR}_i).\\)\\) - M\u00e3 h\u00f3a: \\(\\(C_i = P_i \\oplus S_i.\\)\\) - Gi\u1ea3i m\u00e3 t\u01b0\u01a1ng t\u1ef1: \\(\\(P_i = C_i \\oplus S_i.\\)\\)</p> <p>4) Tag (authentication tag) - T\u00ednh: \\(\\(S = \\mathrm{GHASH}(H,A,C).\\)\\) - Tag (128-bit m\u1eb7c \u0111\u1ecbnh; c\u00f3 th\u1ec3 r\u00fat g\u1ecdn xu\u1ed1ng \\(t\\) bit): \\(\\(T = E_K(J_0)\\oplus S.\\)\\) - So s\u00e1nh tag ph\u1ea3i th\u1ef1c hi\u1ec7n constant-time; ch\u1ec9 tr\u1ea3 plaintext khi tag kh\u1edbp.</p> <p>5) Ghi ch\u00fa t\u00ednh to\u00e1n - Ph\u00e9p nh\u00e2n \\(\\otimes\\) th\u1ef1c hi\u1ec7n b\u1eb1ng CLMUL (carry-less) + gi\u1ea3m theo \\(P(x)\\). - GHASH l\u00e0 tuy\u1ebfn t\u00ednh theo \\(H\\) v\u00e0 c\u00e1c block; v\u00ec th\u1ebf reuse c\u1ee7a \\(J_0\\)/nonce ho\u1eb7c l\u1ed9 \\(H\\) ph\u00e1 v\u1ee1 b\u1ea3o m\u1eadt. - C\u00e1c tham s\u1ed1 k\u00edch th\u01b0\u1edbc: block 128-bit, tag 128-bit (m\u1eb7c \u0111\u1ecbnh), nonce khuy\u1ebfn ngh\u1ecb 96-bit.</p> <p>T\u00f3m t\u1eaft thu\u1eadt to\u00e1n (pseudo): $$ \\begin{aligned} H &amp;= E_K(0^{128})\\ J_0 &amp;= \\begin{cases} IV|0^{31}|1 &amp; \\text{n\u1ebfu }|IV|=96,\\[4pt] \\mathrm{GHASH}(H,\\varnothing,IV) &amp; \\text{kh\u00e1c} \\end{cases}\\ \\text{for } i=1,\\dots,v:\\quad &amp;S_i = E_K(\\mathrm{inc32}(J_0,i)),\\quad C_i = P_i\\oplus S_i\\ S &amp;= \\mathrm{GHASH}(H,A,C)\\ T &amp;= E_K(J_0)\\oplus S \\end{aligned} $$</p> <p>(Tr\u1ea3 v\u1ec1 \\((IV,\\,C,\\,T)\\); khi gi\u1ea3i m\u00e3, t\u00e1i t\u00ednh \\(T\\) v\u00e0 so s\u00e1nh constant-time.)</p>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Sinh nonce 12 byte b\u1eb1ng CSPRNG; t\u1ea1o \\(J_0\\) v\u00e0 counter t\u0103ng d\u1ea7n.</li> <li>ARIA-CTR t\u1ea1o keystream; XOR v\u1edbi plaintext \u0111\u1ec3 ra ciphertext.</li> <li>GHASH(AAD, ciphertext) t\u1ea1o gi\u00e1 tr\u1ecb x\u00e1c th\u1ef1c; k\u1ebft h\u1ee3p v\u1edbi block keystream \u0111\u1ea7u \u0111\u1ec3 sinh tag 16 byte.</li> <li>Gi\u1ea3i m\u00e3: t\u00ednh tag, so s\u00e1nh h\u1eb1ng th\u1eddi gian; ch\u1ec9 gi\u1ea3i m\u00e3 khi kh\u1edbp.</li> </ol>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key Size: 128/192/256 bit (FileVault m\u1eb7c \u0111\u1ecbnh 256).</li> <li>Nonce (IV): 96 bit (12 byte), duy nh\u1ea5t per-key.</li> <li>Tag Size: 128 bit (16 byte).</li> <li>Block Size: 128 bit.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#5-so-s\u00e1nh-v\u1edbi-aes-gcm","title":"5. So s\u00e1nh v\u1edbi AES-GCM","text":"\u0110\u1eb7c \u0111i\u1ec3m ARIA-GCM AES-GCM Chu\u1ea9n KS X 1213, RFC 5794 FIPS 197, NIST SP 800-38D Hi\u1ec7u n\u0103ng HW (AES-NI) Ch\u1eadm h\u01a1n do thi\u1ebfu AES-NI R\u1ea5t nhanh T\u01b0\u01a1ng th\u00edch khu v\u1ef1c \u01afu ti\u00ean h\u1ec7 th\u1ed1ng H\u00e0n Qu\u1ed1c Ph\u1ed5 bi\u1ebfn to\u00e0n c\u1ea7u"},{"location":"algorithms/symmetric/ahead/aria-gcm/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant ARIA_GCM\n    participant Receiver\n\n    Sender-&gt;&gt;ARIA_GCM: Key, Nonce, Plaintext, AAD\n    ARIA_GCM-&gt;&gt;ARIA_GCM: CTR Encrypt -&gt; Ciphertext\n    ARIA_GCM-&gt;&gt;ARIA_GCM: GHASH(AAD, Ciphertext) -&gt; Tag\n    ARIA_GCM-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;ARIA_GCM: Key, Nonce, Ciphertext, Tag, AAD\n    ARIA_GCM-&gt;&gt;ARIA_GCM: GHASH(AAD, Ciphertext) -&gt; Calculated Tag\n    alt Tag Match\n        ARIA_GCM-&gt;&gt;ARIA_GCM: CTR Decrypt -&gt; Plaintext\n        ARIA_GCM-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        ARIA_GCM--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/aria-gcm/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce reuse: d\u00f9ng l\u1ea1i nonce v\u1edbi c\u00f9ng key l\u00e0m l\u1ed9 XOR plaintext v\u00e0 cho ph\u00e9p gi\u1ea3 m\u1ea1o tag.</li> <li>Kh\u00f4ng ki\u1ec3m tra tag h\u1eb1ng th\u1eddi gian: so s\u00e1nh byte-by-byte r\u00f2 r\u1ec9 timing.</li> <li>Kh\u00f4ng x\u00e1c th\u1ef1c header: b\u1ecf AAD khi\u1ebfn k\u1ebb t\u1ea5n c\u00f4ng tr\u00e1o \u0111\u1ed5i metadata (version, filename).</li> <li>Sai \u0111\u1ed9 d\u00e0i nonce: d\u00f9ng nonce != 96 bit khi\u1ebfn GHASH t\u00ednh \\(J_0\\) kh\u00e1c chu\u1ea9n.</li> </ol>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Forgery/bit-flip tr\u00ean l\u01b0u tr\u1eef: attacker s\u1eeda ciphertext; tag s\u1ebd kh\u00f4ng kh\u1edbp v\u00e0 gi\u1ea3i m\u00e3 b\u1ecb t\u1eeb ch\u1ed1i.</li> <li>Nonce collision: do RNG k\u00e9m ho\u1eb7c tri\u1ec3n khai counter sai; m\u1ea5t b\u1ea3o m\u1eadt m\u1eadt m\u00e3.</li> <li>Side-channel: c\u1ea7n tri\u1ec3n khai constant-time, tr\u00e1nh r\u00f2 r\u1ec9 S-box truy c\u1eadp b\u1ed9 nh\u1edb.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>D\u00f9ng CSPRNG m\u1ea1nh cho nonce ho\u1eb7c counter monotonic per-key; l\u01b0u tr\u1ea1ng th\u00e1i \u0111\u1ec3 kh\u00f4ng l\u1eb7p.</li> <li>Ki\u1ec3m tra tag tr\u01b0\u1edbc khi xu\u1ea5t plaintext; so s\u00e1nh h\u1eb1ng th\u1eddi gian.</li> <li>\u0110\u01b0a metadata quan tr\u1ecdng v\u00e0o AAD; k\u00fd th\u00eam n\u1ebfu c\u1ea7n ch\u1ed1ng replay.</li> <li>Xoay v\u00f2ng key n\u1ebfu s\u1ed1 b\u1ea3n tin l\u1edbn (&gt;\\(2^{32}\\)) ho\u1eb7c khi nghi ng\u1edd r\u00f2 r\u1ec9 nonce.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>B\u1ed9 vector ch\u00ednh th\u1ee9c: RFC 5794 (ARIA modes, c\u00f3 ARIA-GCM) v\u00e0 b\u1ed9 th\u1eed KS X 1213/KISA (public test set).</li> <li>G\u1ee3i \u00fd ki\u1ec3m th\u1eed th\u1ef1c t\u1ebf: d\u00f9ng Botan <code>aead</code> CLI ho\u1eb7c OpenSSL (n\u1ebfu build c\u00f3 ARIA) \u0111\u1ec3 sinh vector ri\u00eang; l\u01b0u l\u1ea1i (key, nonce, AAD, ciphertext, tag) v\u00e0o regression tests c\u1ee7a FileVault.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#11-v\u00ed-d\u1ee5-code-c-v\u1edbi-botan","title":"11. V\u00ed d\u1ee5 code (C++ v\u1edbi Botan)","text":"C++<pre><code>#include &lt;botan/aead.h&gt;\n#include &lt;botan/auto_rng.h&gt;\n\nstd::vector&lt;uint8_t&gt; encrypt_aria_gcm(const std::vector&lt;uint8_t&gt;&amp; key,\n                                      const std::vector&lt;uint8_t&gt;&amp; pt,\n                                      const std::vector&lt;uint8_t&gt;&amp; aad) {\n    Botan::AutoSeeded_RNG rng;\n    auto aead = Botan::AEAD_Mode::create(\"ARIA-256/GCM\", Botan::ENCRYPTION);\n    aead-&gt;set_key(key);\n    std::vector&lt;uint8_t&gt; nonce(12);\n    rng.randomize(nonce.data(), nonce.size());\n    aead-&gt;start(nonce);\n    aead-&gt;set_associated_data(aad);\n    std::vector&lt;uint8_t&gt; buf = pt;\n    aead-&gt;finish(buf);\n    buf.insert(buf.begin(), nonce.begin(), nonce.end());\n    return buf;\n}\n</code></pre>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Nonce 96-bit, duy nh\u1ea5t per-key, sinh t\u1eeb CSPRNG/counter.</li> <li> Ki\u1ec3m tra tag h\u1eb1ng th\u1eddi gian tr\u01b0\u1edbc khi d\u00f9ng plaintext.</li> <li> \u0110\u01b0a metadata (filename, version, policy) v\u00e0o AAD.</li> <li> Ch\u1ecdn key 256-bit cho h\u1ed3 s\u01a1 <code>PROFESSIONAL/ADVANCED</code>.</li> <li> Xoay key n\u1ebfu nguy c\u01a1 v\u01b0\u1ee3t gi\u1edbi h\u1ea1n b\u1ea3n tin ho\u1eb7c nghi ng\u1edd nonce reuse.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Nonce reuse: t\u00e1i s\u1eed d\u1ee5ng nonce v\u1edbi c\u00f9ng key ph\u00e1 hu\u1ef7 t\u00ednh b\u1ea3o m\u1eadt (m\u1ea5t b\u00ed m\u1eadt v\u00e0 cho ph\u00e9p gi\u1ea3 m\u1ea1o).</li> <li>Tag truncation: r\u00fat g\u1ecdn tag gi\u1ea3m \u0111\u1ed9 m\u1ea1nh ch\u1ed1ng gi\u1ea3 m\u1ea1o; kh\u00f4ng r\u00fat qu\u00e1 m\u1ee9c (th\u01b0\u1eddng \u226596 bit n\u1ebfu ph\u1ea3i).</li> <li>Gi\u1edbi h\u1ea1n d\u1eef li\u1ec7u tr\u00ean m\u1ed9t key: tr\u00e1nh l\u00e0m tr\u00e0n counter/ti\u00eau th\u1ee5 qu\u00e1 nhi\u1ec1u block tr\u00ean c\u00f9ng key (kh\u00f4ng d\u00f9ng v\u00f4 h\u1ea1n \u2014 tr\u00e1nh g\u1ea7n gi\u1edbi h\u1ea1n counter 32-bit).</li> <li>Hi\u1ec7u n\u0103ng ph\u1ee5 thu\u1ed9c HW: kh\u00f4ng c\u00f3 AES-NI/CLMUL s\u1ebd ch\u1eadm h\u01a1n AES-GCM tr\u00ean ph\u1ea7n c\u1ee9ng c\u00f3 h\u1ed7 tr\u1ee3.</li> <li>K\u00eanh b\u00ean (side-channels) v\u00e0 so s\u00e1nh tag: c\u1ea7n tri\u1ec3n khai constant-time; sai s\u00f3t d\u1ec5 r\u00f2 r\u1ec9.</li> <li>T\u01b0\u01a1ng th\u00edch/tu\u00e2n th\u1ee7: ARIA \u0111\u01b0\u1ee3c chu\u1ea9n ho\u00e1 \u1edf H\u00e0n Qu\u1ed1c \u2014 c\u00f3 th\u1ec3 kh\u00f4ng ph\u1ed5 bi\u1ebfn ho\u1eb7c kh\u00f4ng \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 r\u1ed9ng \u1edf m\u1ed9t s\u1ed1 n\u1ec1n t\u1ea3ng.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 ho\u00e1 \u1ed5/volume, kho\u00e1 d\u1eef li\u1ec7u, backup b\u1ea3o m\u1eadt (FileVault-style) trong m\u00f4i tr\u01b0\u1eddng \u01b0u ti\u00ean ARIA.</li> <li>Giao th\u1ee9c b\u1ea3o m\u1eadt n\u1ed9i b\u1ed9 ho\u1eb7c khu v\u1ef1c (VPN, secure storage, messaging) n\u01a1i c\u1ea7n AEAD.</li> <li>\u1ee8ng d\u1ee5ng tu\u00e2n th\u1ee7 chu\u1ea9n H\u00e0n Qu\u1ed1c/KISA ho\u1eb7c y\u00eau c\u1ea7u thu\u1eadt to\u00e1n ngo\u00e0i AES \u0111\u1ec3 \u0111a d\u1ea1ng ho\u00e1 thu\u1eadt to\u00e1n.</li> </ul>"},{"location":"algorithms/symmetric/ahead/aria-gcm/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 5794 \u2014 The ARIA Block Cipher (KISA / IETF).  </li> <li>KISA KS X 1213 \u2014 ARIA specification (Korean Industrial Standard).  </li> <li>NIST SP 800-38D \u2014 Recommendation for Block Cipher Modes of Operation: GCM.  </li> <li>McGrew &amp; Viega \u2014 \u201cThe Galois/Counter Mode of Operation (GCM)\u201d (original analysis/paper).  </li> <li>RFC 5116 \u2014 An Interface and Algorithms for Authenticated Encryption (AEAD).  </li> <li>C\u00e1c nghi\u00ean c\u1ee9u v\u1ec1 l\u1ea1m d\u1ee5ng nonce v\u00e0 ph\u00e2n t\u00edch an to\u00e0n GCM (nonce-misuse papers / implementation guidance).</li> <li>Tri th\u1ee9c tri\u1ec3n khai: th\u01b0 vi\u1ec7n nh\u01b0 Botan/OpenSSL (khi build c\u00f3 ARIA) \u0111\u1ec3 test vector v\u00e0 ki\u1ec3m th\u1eed.  </li> <li>T\u00e0i li\u1ec7u n\u1ed9i b\u1ed9 FileVault: l\u01b0u vector test (key, nonce, AAD, ciphertext, tag) v\u00e0 policy nonce/key rotation.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/","title":"Camellia-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/camellia-gcm/#camellia-gcm-galoiscounter-mode","title":"Camellia-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/camellia-gcm/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<p>Camellia-GCM k\u1ebft h\u1ee3p block cipher Camellia (ISO/IEC 18033-3, RFC 6367 cho IPsec) v\u1edbi ch\u1ebf \u0111\u1ed9 AEAD GCM. M\u1ee5c ti\u00eau: cung c\u1ea5p m\u1ed9t l\u1ef1a ch\u1ecdn chu\u1ea9n c\u00f4ng nghi\u1ec7p ngo\u00e0i AES, gi\u1eef t\u00ednh b\u1ea3o m\u1eadt/x\u00e1c th\u1ef1c v\u00e0 gi\u1ea3m ph\u1ee5 thu\u1ed9c v\u00e0o AES-NI.</p>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Camellia: m\u1ea1ng Feistel (18 v\u00f2ng cho key 128-bit; 24 v\u00f2ng cho 192/256-bit) v\u1edbi c\u00e1c ph\u00e9p tuy\u1ebfn t\u00ednh P-function v\u00e0 F-function d\u00f9ng 4 S-boxes.</li> <li>GCM: CTR + GHASH trong \\(GF(2^{128})\\); tag 128 bit \u0111\u01b0\u1ee3c t\u00ednh nh\u01b0 \\(\\text{Tag}=E_K(J_0)\\oplus \\text{GHASH}(AAD, C)\\).</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p: t\u01b0\u01a1ng t\u1ef1 AES-GCM, kh\u00e1c bi\u1ec7t ch\u1ee7 y\u1ebfu n\u1eb1m \u1edf primitive block cipher.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Nonce 96-bit sinh ng\u1eabu nhi\u00ean; t\u1ea1o counter \\(J_0\\).</li> <li>Camellia-CTR t\u1ea1o keystream, XOR v\u1edbi plaintext \u2192 ciphertext.</li> <li>GHASH(AAD, ciphertext) t\u1ea1o gi\u00e1 tr\u1ecb x\u00e1c th\u1ef1c; k\u1ebft h\u1ee3p block keystream \u0111\u1ea7u \u0111\u1ec3 ra tag.</li> <li>Gi\u1ea3i m\u00e3: t\u00ednh tag, so s\u00e1nh h\u1eb1ng th\u1eddi gian; ch\u1ec9 tr\u1ea3 plaintext khi kh\u1edbp.</li> </ol>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key Size: 128/192/256 bit (FileVault h\u1ed7 tr\u1ee3 \u0111\u1ea7y \u0111\u1ee7).</li> <li>Nonce: 96 bit (12 byte), duy nh\u1ea5t per-key.</li> <li>Tag: 128 bit (16 byte).</li> <li>Block Size: 128 bit.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#5-so-s\u00e1nh-v\u1edbi-aes-gcm","title":"5. So s\u00e1nh v\u1edbi AES-GCM","text":"\u0110\u1eb7c \u0111i\u1ec3m Camellia-GCM AES-GCM Hi\u1ec7u n\u0103ng HW (AES-NI) Ch\u1eadm h\u01a1n (kh\u00f4ng c\u00f3 AES-NI) R\u1ea5t nhanh Hi\u1ec7u n\u0103ng SW thu\u1ea7n S\u00e1t AES, \u0111\u00f4i khi t\u1ed1t h\u01a1n tr\u00ean ki\u1ebfn tr\u00fac kh\u00f4ng c\u00f3 AES-NI T\u1ed1t, nh\u01b0ng ph\u1ee5 thu\u1ed9c AES-NI \u0111\u1ec3 t\u1ed1i \u01b0u Chu\u1ea9n khu v\u1ef1c \u0110\u01b0\u1ee3c CRYPTREC/NESSIE khuy\u1ebfn ngh\u1ecb, ph\u1ed5 bi\u1ebfn t\u1ea1i JP/EU Chu\u1ea9n to\u00e0n c\u1ea7u (FIPS/NIST)"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant Camellia_GCM\n    participant Receiver\n\n    Sender-&gt;&gt;Camellia_GCM: Key, Nonce, Plaintext, AAD\n    Camellia_GCM-&gt;&gt;Camellia_GCM: CTR Encrypt -&gt; Ciphertext\n    Camellia_GCM-&gt;&gt;Camellia_GCM: GHASH(AAD, Ciphertext) -&gt; Tag\n    Camellia_GCM-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;Camellia_GCM: Key, Nonce, Ciphertext, Tag, AAD\n    Camellia_GCM-&gt;&gt;Camellia_GCM: GHASH(AAD, Ciphertext) -&gt; Calculated Tag\n    alt Tag Match\n        Camellia_GCM-&gt;&gt;Camellia_GCM: CTR Decrypt -&gt; Plaintext\n        Camellia_GCM-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        Camellia_GCM--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce reuse: t\u00e1i s\u1eed d\u1ee5ng nonce v\u1edbi c\u00f9ng key \u2192 r\u00f2 r\u1ec9 keystream, cho ph\u00e9p gi\u1ea3 m\u1ea1o.</li> <li>Sai \u0111\u1ed9 d\u00e0i nonce/tag: nonce \u2260 96 bit ho\u1eb7c c\u1eaft tag &lt; 96 bit l\u00e0m gi\u1ea3m an to\u00e0n.</li> <li>Kh\u00f4ng x\u00e1c th\u1ef1c AAD: b\u1ecf metadata (version, filename) kh\u1ecfi AAD l\u00e0m t\u0103ng r\u1ee7i ro tr\u00e1o \u0111\u1ed5i ng\u1eef c\u1ea3nh.</li> <li>Kh\u00f4ng ki\u1ec3m tra tag h\u1eb1ng th\u1eddi gian: so s\u00e1nh kh\u00f4ng constant-time g\u00e2y side-channel.</li> </ol>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Modification at rest: attacker s\u1eeda ciphertext; tag mismatch l\u00e0m gi\u1ea3i m\u00e3 th\u1ea5t b\u1ea1i.</li> <li>Nonce collision: RNG k\u00e9m ho\u1eb7c counter tr\u00e0n; m\u1ea5t b\u1ea3o m\u1eadt m\u1eadt m\u00e3.</li> <li>Side-channel: Camellia c\u1ea7n tri\u1ec3n khai constant-time \u1edf S-box v\u00e0 ho\u00e1n v\u1ecb.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>CSPRNG sinh nonce ho\u1eb7c counter monotonic; log/ki\u1ec3m so\u00e1t \u0111\u1ec3 tr\u00e1nh tr\u00f9ng.</li> <li>Duy tr\u00ec tag 128 bit; c\u1ea5m truncate &lt; 96 bit.</li> <li>\u0110\u01b0a header quan tr\u1ecdng v\u00e0o AAD; ch\u1ed1ng replay b\u1eb1ng version/timestamp trong AAD.</li> <li>Tri\u1ec3n khai constant-time, tr\u00e1nh b\u1ea3ng S-box cache-leak.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Ngu\u1ed3n ch\u00ednh th\u1ee9c: RFC 6367 (Camellia Counter Modes) v\u00e0 NIST CAVP Camellia-GCM (public). C\u00e1c vector bao g\u1ed3m \u0111\u1ee7 key 128/192/256, AAD c\u00f3/kh\u00f4ng, nhi\u1ec1u \u0111\u1ed9 d\u00e0i plaintext.</li> <li>G\u1ee3i \u00fd n\u1ed9i b\u1ed9: sinh vector b\u1eb1ng OpenSSL (build h\u1ed7 tr\u1ee3 Camellia-GCM) v\u00e0 th\u00eam v\u00e0o b\u1ed9 regression c\u1ee7a FileVault.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#11-v\u00ed-d\u1ee5-code-openssl-cli","title":"11. V\u00ed d\u1ee5 code (OpenSSL CLI)","text":"Bash<pre><code>openssl enc -camellia-256-gcm -K &lt;hexkey&gt; -iv &lt;hexnonce&gt; -in plaintext.bin \\\n  -aad &lt;hexaad&gt; -out ciphertext.bin -nopad -p\n# Tag s\u1ebd \u0111\u01b0\u1ee3c in trong stdout (\"tag = ...\")\n</code></pre>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Nonce 96-bit duy nh\u1ea5t cho m\u1ed7i key.</li> <li> Tag 128-bit, so s\u00e1nh h\u1eb1ng th\u1eddi gian tr\u01b0\u1edbc khi d\u00f9ng plaintext.</li> <li> Bao g\u1ed3m metadata quan tr\u1ecdng trong AAD.</li> <li> D\u00f9ng key 256-bit cho h\u1ed3 s\u01a1 an to\u00e0n cao; xoay key n\u1ebfu s\u1ed1 b\u1ea3n tin l\u1edbn.</li> <li> Ki\u1ec3m th\u1eed l\u1ea1i b\u1eb1ng vector chu\u1ea9n (RFC 6367/NIST CAVP) sau m\u1ed7i thay \u0111\u1ed5i m\u00e3 h\u00f3a.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>\u00cdt h\u1ed7 tr\u1ee3 HW t\u0103ng t\u1ed1c (kh\u00f4ng c\u00f3 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng AES-NI) \u2192 hi\u1ec7u n\u0103ng th\u1ea5p tr\u00ean CPU c\u00f3 AES-NI.  </li> <li>Ph\u1ed5 bi\u1ebfn/tu\u00e2n chu\u1ea9n k\u00e9m h\u01a1n AES (kh\u00f4ng ph\u1ea3i chu\u1ea9n FIPS/NIST ph\u1ed5 bi\u1ebfn) \u2192 kh\u1ea3 n\u0103ng t\u01b0\u01a1ng th\u00edch v\u1edbi m\u1ed9t s\u1ed1 h\u1ec7 sinh th\u00e1i h\u1ea1n ch\u1ebf.  </li> <li>R\u1ee7i ro GCM chung: reuse nonce ho\u1eb7c truncate tag \u1ea3nh h\u01b0\u1edfng nghi\u00eam tr\u1ecdng \u0111\u1ebfn an to\u00e0n.  </li> <li>C\u00f4ng c\u1ee5, th\u01b0 vi\u1ec7n, v\u00e0 audit \u00edt h\u01a1n so v\u1edbi AES \u2192 kh\u1ea3 n\u0103ng ph\u00e1t hi\u1ec7n l\u1ed7i tri\u1ec3n khai/ch\u1ed7 h\u1ed5ng ch\u1eadm.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>IPsec / VPN (RFC 6367 tham kh\u1ea3o tri\u1ec3n khai counter modes c\u1ee7a Camellia).  </li> <li>TLS/SSL v\u00e0 OpenSSL khi c\u1ea7n l\u1ef1a ch\u1ecdn ngo\u00e0i AES (t\u00f9y build).  </li> <li>M\u00e3 h\u00f3a file (FileVault), container, v\u00e0 l\u01b0u tr\u1eef t\u1ea1i n\u01a1i mu\u1ed1n gi\u1ea3m ph\u1ee5 thu\u1ed9c v\u00e0o AES.  </li> <li>Thi\u1ebft b\u1ecb nh\u00fang ho\u1eb7c m\u00f4i tr\u01b0\u1eddng tu\u00e2n th\u1ee7 ti\u00eau chu\u1ea9n khu v\u1ef1c (JP/EU) n\u01a1i Camellia \u0111\u01b0\u1ee3c khuy\u1ebfn ngh\u1ecb.</li> </ul>"},{"location":"algorithms/symmetric/ahead/camellia-gcm/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 6367 \u2014 Camellia Counter Modes: https://datatracker.ietf.org/doc/html/rfc6367 </li> <li>ISO/IEC 18033-3 \u2014 Encryption algorithms (Camellia): https://www.iso.org/standard/36529.html </li> <li>CRYPTREC / NESSIE reports (\u0111\u00e1nh gi\u00e1 Camellia): CRYPTREC site v\u00e0 c\u00e1c b\u00e1o c\u00e1o NESSIE  </li> <li>OpenSSL enc (Camellia-GCM) docs: https://www.openssl.org/docs/man1.1.1/man1/enc.html </li> <li>NIST CAVP / Cryptographic Algorithm Validation Program: https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/","title":"ChaCha20-Poly1305","text":""},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#chacha20-poly1305","title":"ChaCha20-Poly1305","text":""},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<p>ChaCha20-Poly1305 l\u00e0 AEAD hi\u1ec7n \u0111\u1ea1i k\u1ebft h\u1ee3p stream cipher ChaCha20 v\u1edbi MAC Poly1305. M\u1ee5c ti\u00eau: hi\u1ec7u n\u0103ng cao tr\u00ean CPU kh\u00f4ng c\u00f3 AES-NI, \u0111\u1ed3ng th\u1eddi kh\u00e1ng side-channel t\u1ef1 nhi\u00ean nh\u1edd ph\u00e9p to\u00e1n ARX (Add-Rotate-Xor).</p>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>ChaCha20: state 512 bit; 20 round quarter-rounds d\u1ef1a tr\u00ean ph\u00e9p c\u1ed9ng modulo \\(2^{32}\\), xoay v\u00f2ng, XOR.</li> <li>Poly1305: MAC m\u1ed9t l\u1ea7n, t\u00ednh mod s\u1ed1 nguy\u00ean t\u1ed1 \\(2^{130}-5\\), kh\u00f3a m\u1ed9t l\u1ea7n l\u1ea5y t\u1eeb block keystream \u0111\u1ea7u ti\u00ean (counter=0).</li> <li>Tag = Poly1305(AAD || ciphertext || lengths) v\u1edbi kh\u00f3a \\(r||s\\) sinh t\u1eeb ChaCha20 block0.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Nonce 96-bit (IETF) + counter 32-bit (b\u1eaft \u0111\u1ea7u t\u1eeb 1 cho d\u1eef li\u1ec7u, 0 cho MAC key).</li> <li>Block0 \u2192 kh\u00f3a Poly1305.</li> <li>Block1..n \u2192 keystream XOR plaintext \u2192 ciphertext.</li> <li>Poly1305(AAD, ciphertext, length fields) \u2192 tag 16 byte.</li> <li>Gi\u1ea3i m\u00e3: t\u00ednh l\u1ea1i tag, so s\u00e1nh h\u1eb1ng th\u1eddi gian; ch\u1ec9 gi\u1ea3i m\u00e3 khi kh\u1edbp.</li> </ol>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: 256 bit.</li> <li>Nonce: 96 bit (12 byte) IETF; gi\u1edbi h\u1ea1n 32-bit counter \u2192 t\u1ed1i \u0111a 256 GiB m\u1ed7i nonce.</li> <li>Tag: 128 bit (16 byte).</li> <li>Block: 512 bit state; output keystream 64 byte/block.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#5-so-s\u00e1nh-v\u1edbi-aes-gcm","title":"5. So s\u00e1nh v\u1edbi AES-GCM","text":"\u0110\u1eb7c \u0111i\u1ec3m ChaCha20-Poly1305 AES-GCM Hi\u1ec7u n\u0103ng kh\u00f4ng AES-NI R\u1ea5t nhanh Ch\u1eadm h\u01a1n, d\u1ec5 d\u00ednh cache timing Hi\u1ec7u n\u0103ng v\u1edbi AES-NI Th\u01b0\u1eddng ch\u1eadm h\u01a1n R\u1ea5t nhanh Side-channel ARX constant-time t\u1ef1 nhi\u00ean C\u1ea7n tr\u00e1nh lookup S-box/ghash timing Nonce reuse Th\u1ea3m h\u1ecda (l\u1ed9 keystream, gi\u1ea3 m\u1ea1o) Th\u1ea3m h\u1ecda"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant ChaCha20_Poly1305\n    participant Receiver\n\n    Sender-&gt;&gt;ChaCha20_Poly1305: Key, Nonce, Plaintext, AAD\n    ChaCha20_Poly1305-&gt;&gt;ChaCha20_Poly1305: Block0 -&gt; Poly1305 one-time key\n    ChaCha20_Poly1305-&gt;&gt;ChaCha20_Poly1305: Keystream (block1..n) XOR Plaintext -&gt; Ciphertext\n    ChaCha20_Poly1305-&gt;&gt;ChaCha20_Poly1305: Poly1305(AAD, Ciphertext) -&gt; Tag\n    ChaCha20_Poly1305-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;ChaCha20_Poly1305: Key, Nonce, Ciphertext, Tag, AAD\n    ChaCha20_Poly1305-&gt;&gt;ChaCha20_Poly1305: Recompute Tag (constant time compare)\n    alt Tag Match\n        ChaCha20_Poly1305-&gt;&gt;ChaCha20_Poly1305: Keystream XOR Ciphertext -&gt; Plaintext\n        ChaCha20_Poly1305-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        ChaCha20_Poly1305--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce reuse: l\u1eb7p nonce v\u1edbi c\u00f9ng key \u2192 l\u1ed9 keystream, gi\u1ea3 m\u1ea1o ciphertext.</li> <li>Qu\u00ean t\u0103ng counter: counter 32-bit tr\u00e0n sau 256 GiB; ti\u1ebfp t\u1ee5c m\u00e3 h\u00f3a s\u1ebd t\u00e1i s\u1eed d\u1ee5ng keystream.</li> <li>Sai th\u1ee9 t\u1ef1 build Poly1305 input: thi\u1ebfu tr\u01b0\u1eddng \u0111\u1ed9 d\u00e0i 64-bit little-endian cho AAD/ciphertext.</li> <li>T\u1ef1 vi\u1ebft ARX non-constant-time: d\u00f9ng rotate/b\u1ed5 sung kh\u00f4ng chu\u1ea9n d\u1eabn \u0111\u1ebfn r\u00f2 r\u1ec9.</li> </ol>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Tamper at rest: s\u1eeda ciphertext \u2192 tag sai \u2192 gi\u1ea3i m\u00e3 t\u1eeb ch\u1ed1i.</li> <li>Timing/cache attacks: ChaCha20/Poly1305 g\u1ea7n constant-time m\u1eb7c \u0111\u1ecbnh; v\u1eabn c\u1ea7n tr\u00e1nh t\u1ed1i \u01b0u h\u00f3a sai.</li> <li>Nonce collision: RNG k\u00e9m ho\u1eb7c counter reset.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Nonce 96-bit ng\u1eabu nhi\u00ean ho\u1eb7c counter-based (per-key monotonic).</li> <li>Gi\u1edbi h\u1ea1n 256 GiB m\u1ed7i nonce; t\u1ea1o nonce m\u1edbi n\u1ebfu v\u01b0\u1ee3t.</li> <li>Ki\u1ec3m tra tag h\u1eb1ng th\u1eddi gian; kh\u00f4ng tr\u1ea3 v\u1ec1 plaintext tr\u01b0\u1edbc khi x\u00e1c th\u1ef1c.</li> <li>Gi\u1eef AAD bao g\u1ed3m metadata; th\u00eam ch\u1ed1ng replay b\u1eb1ng version/timestamp.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>RFC 8439 cung c\u1ea5p b\u1ed9 \u0111\u1ea7y \u0111\u1ee7. Vector th\u1ef1c t\u1ebf (t\u1ef1 sinh v\u1edbi <code>cryptography</code>):<ul> <li>Key: <code>000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f</code></li> <li>Nonce: <code>4a00000000000000b0b00000</code></li> <li>AAD: <code>f0f1f2f3f4f5f6f7</code></li> <li>Plaintext (ASCII): <code>FileVault ChaCha20-Poly1305 test</code></li> <li>Ciphertext: <code>04f85a7de8fb17be8f5f9150d7e16daf773b09a9dc16c8dc0a9ea6f0edb4ce86</code></li> <li>Tag: <code>13fd8540caaf8a6d240c72c4652a4cd7</code></li> </ul> </li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#11-v\u00ed-d\u1ee5-code-python","title":"11. V\u00ed d\u1ee5 code (Python)","text":"Python<pre><code>import os\nfrom cryptography.hazmat.primitives.ciphers.aead import ChaCha20Poly1305\n\ndef encrypt(key: bytes, plaintext: bytes, aad: bytes = b\"\") -&gt; bytes:\n    nonce = os.urandom(12)\n    c = ChaCha20Poly1305(key)\n    return nonce + c.encrypt(nonce, plaintext, aad)  # ciphertext || tag\n\ndef decrypt(key: bytes, data: bytes, aad: bytes = b\"\") -&gt; bytes:\n    nonce, body = data[:12], data[12:]\n    c = ChaCha20Poly1305(key)\n    return c.decrypt(nonce, body, aad)\n</code></pre>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Nonce 96-bit duy nh\u1ea5t per-key; reset counter sau 256 GiB/nonce.</li> <li> Tag 128-bit, so s\u00e1nh h\u1eb1ng th\u1eddi gian tr\u01b0\u1edbc khi tr\u1ea3 plaintext.</li> <li> Bao g\u1ed3m metadata v\u00e0o AAD; c\u00e2n nh\u1eafc ch\u1ed1ng replay.</li> <li> S\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n chu\u1ea9n (Botan/OpenSSL/libsodium); kh\u00f4ng t\u1ef1 vi\u1ebft ChaCha loop.</li> <li> Fuzz + ki\u1ec3m tra b\u1eb1ng vector RFC 8439 sau m\u1ed7i thay \u0111\u1ed5i.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Nonce reuse l\u00e0 th\u1ea3m h\u1ecda \u2014 l\u1ed9 keystream v\u00e0 cho ph\u00e9p gi\u1ea3 m\u1ea1o; ph\u1ea3i \u0111\u1ea3m b\u1ea3o nonce duy nh\u1ea5t per-key.  </li> <li>Gi\u1edbi h\u1ea1n counter 32-bit (IETF nonce) \u2192 t\u1ed1i \u0111a ~256 GiB d\u1eef li\u1ec7u tr\u00ean m\u1ed9t nonce.  </li> <li>So v\u1edbi AES-GCM tr\u00ean CPU c\u00f3 AES-NI, ChaCha20-Poly1305 c\u00f3 th\u1ec3 ch\u1eadm h\u01a1n.  </li> <li>Tri\u1ec3n khai sai (non-constant-time, sai th\u1ee9 t\u1ef1 build input Poly1305) ph\u00e1 h\u1ee7y t\u00ednh an to\u00e0n.  </li> <li>Kh\u00f4ng ph\u1ea3i l\u1ef1a ch\u1ecdn cho c\u00e1c k\u1ecbch b\u1ea3n c\u1ea7n t\u00ednh n\u0103ng public-key AEAD \u2014 ch\u1ec9 l\u00e0 c\u01a1 ch\u1ebf \u0111\u1ed1i x\u1ee9ng.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>Giao th\u1ee9c m\u1ea1ng/TLS (s\u1eed d\u1ee5ng trong TLS 1.3, th\u01b0\u1eddng cho thi\u1ebft b\u1ecb kh\u00f4ng c\u00f3 AES-NI).  </li> <li>VPN v\u00e0 tunneling (v\u00ed d\u1ee5 WireGuard s\u1eed d\u1ee5ng ChaCha20/Poly1305).  </li> <li>Th\u01b0 vi\u1ec7n criptography cho \u1ee9ng d\u1ee5ng mobile/IoT n\u01a1i AES-NI kh\u00f4ng ph\u1ed5 bi\u1ebfn.  </li> <li>M\u00e3 ho\u00e1 l\u01b0u tr\u1eef/backup, messaging end-to-end, v\u00e0 b\u1ea5t c\u1ee9 n\u01a1i n\u00e0o c\u1ea7n AEAD nhanh tr\u00ean CPU thu\u1ea7n.  </li> <li>Th\u01b0 vi\u1ec7n cung c\u1ea5p variant l\u1edbn h\u01a1n nonces (XChaCha20-Poly1305) cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p nonce d\u00e0i/ng\u1eabu nhi\u00ean.</li> </ul>"},{"location":"algorithms/symmetric/ahead/chacha20-poly1305/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>RFC 8439 \u2014 \"ChaCha20 and Poly1305 for IETF Protocols\" (IETF).  </li> <li>RFC 8446 \u2014 \"TLS 1.3\" (m\u00e3 h\u00f3a AEAD \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3, bao g\u1ed3m ChaCha20-Poly1305).  </li> <li>D. J. Bernstein \u2014 c\u00e1c b\u00e0i v\u1ec1 ChaCha/Poly1305 (ChaCha, Poly1305-AES).  </li> <li>libsodium / NaCl \u2014 th\u01b0 vi\u1ec7n tham kh\u1ea3o cho ChaCha20-Poly1305 v\u00e0 XChaCha20-Poly1305.  </li> <li>OpenSSL / BoringSSL docs \u2014 tri\u1ec3n khai v\u00e0 API.  </li> <li>cryptography (Python), Go crypto/x/crypto/chacha20poly1305, Rust crates (ring, chacha20poly1305) \u2014 v\u00ed d\u1ee5 m\u00e3 ngu\u1ed3n v\u00e0 test vectors.  </li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/","title":"Serpent-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/serpent-gcm/#serpent-gcm-galoiscounter-mode","title":"Serpent-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/serpent-gcm/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<p>Serpent-GCM k\u1ebft h\u1ee3p block cipher Serpent (\u1ee9ng vi\u00ean chung k\u1ebft AES, thi\u1ebft k\u1ebf b\u1ea3o th\u1ee7 32 v\u00f2ng) v\u1edbi AEAD GCM. M\u1ee5c ti\u00eau: \u01b0u ti\u00ean bi\u00ean \u0111\u1ed9 an to\u00e0n d\u00e0i h\u1ea1n; d\u00f9ng cho h\u1ed3 s\u01a1 <code>PARANOID</code> c\u1ee7a FileVault.</p>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Serpent: m\u1ea1ng SP v\u1edbi 8 S-box 4x4, 32 v\u00f2ng; bit-slice \u0111\u1ec3 ch\u1ea1y nhanh v\u00e0 constant-time tr\u00ean CPU 32/64 bit.</li> <li>GCM: CTR + GHASH tr\u00ean \\(GF(2^{128})\\); tag = \\(E_K(J_0) \\oplus \\text{GHASH}(AAD, C)\\).</li> <li>Bi\u00ean \u0111\u1ed9 an to\u00e0n: 32 v\u00f2ng &gt; s\u1ed1 v\u00f2ng t\u1ed1i thi\u1ec3u, nh\u1eb1m ch\u1ed1ng c\u00e1c k\u1ef9 thu\u1eadt ph\u00e2n t\u00edch trong t\u01b0\u01a1ng lai.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Sinh nonce 96-bit; t\u1ea1o counter \\(J_0\\).</li> <li>Serpent-CTR t\u1ea1o keystream; XOR v\u1edbi plaintext \u2192 ciphertext.</li> <li>GHASH(AAD, ciphertext) \u2192 tag 16 byte; gi\u1ea3i m\u00e3 ch\u1ec9 khi tag kh\u1edbp (so s\u00e1nh h\u1eb1ng th\u1eddi gian).</li> </ol>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: 256 bit m\u1eb7c \u0111\u1ecbnh (h\u1ed7 tr\u1ee3 128/192/256).</li> <li>Nonce: 96 bit (12 byte) duy nh\u1ea5t per-key.</li> <li>Tag: 128 bit (16 byte).</li> <li>Block: 128 bit.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#5-so-s\u00e1nh-v\u1edbi-aes-gcm","title":"5. So s\u00e1nh v\u1edbi AES-GCM","text":"\u0110\u1eb7c \u0111i\u1ec3m Serpent-GCM AES-GCM An to\u00e0n d\u00e0i h\u1ea1n Margin r\u1ea5t cao (32 v\u00f2ng) Cao nh\u01b0ng margin th\u1ea5p h\u01a1n Hi\u1ec7u n\u0103ng SW Ch\u1eadm h\u01a1n ~2-3x Nhanh (\u0111\u1eb7c bi\u1ec7t v\u1edbi AES-NI) \u1ee8ng d\u1ee5ng Archival, d\u1eef li\u1ec7u c\u1ef1c nh\u1ea1y c\u1ea3m \u0110a d\u1ee5ng, m\u1eb7c \u0111\u1ecbnh"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant Serpent_GCM\n    participant Receiver\n\n    Sender-&gt;&gt;Serpent_GCM: Key, Nonce, Plaintext, AAD\n    Serpent_GCM-&gt;&gt;Serpent_GCM: CTR Encrypt -&gt; Ciphertext\n    Serpent_GCM-&gt;&gt;Serpent_GCM: GHASH(AAD, Ciphertext) -&gt; Tag\n    Serpent_GCM-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;Serpent_GCM: Key, Nonce, Ciphertext, Tag, AAD\n    Serpent_GCM-&gt;&gt;Serpent_GCM: GHASH(AAD, Ciphertext) -&gt; Calculated Tag\n    alt Tag Match\n        Serpent_GCM-&gt;&gt;Serpent_GCM: CTR Decrypt -&gt; Plaintext\n        Serpent_GCM-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        Serpent_GCM--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce reuse: t\u00e1i s\u1eed d\u1ee5ng nonce v\u1edbi c\u00f9ng key ph\u00e1 v\u1ee1 b\u1ea3o m\u1eadt.</li> <li>Bit-slice kh\u00f4ng constant-time: t\u1ed1i \u01b0u SIMD sai g\u00e2y r\u00f2 r\u1ec9.</li> <li>Gi\u1ea3m s\u1ed1 v\u00f2ng: c\u1eaft v\u00f2ng \u0111\u1ec3 t\u0103ng t\u1ed1c l\u00e0m gi\u1ea3m bi\u00ean \u0111\u1ed9 an to\u00e0n.</li> <li>Tag truncation: c\u1eaft tag &lt; 96 bit l\u00e0m y\u1ebfu x\u00e1c th\u1ef1c.</li> </ol>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Forgery/tamper: s\u1eeda ciphertext \u2192 tag sai \u2192 t\u1eeb ch\u1ed1i gi\u1ea3i m\u00e3.</li> <li>Side-channel: tr\u00e1nh b\u1ea3ng S-box ph\u1ee5 thu\u1ed9c d\u1eef li\u1ec7u; \u01b0u ti\u00ean bit-slice constant-time.</li> <li>Nonce collision: RNG/counter l\u1ed7i.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Nonce 96-bit duy nh\u1ea5t per-key; d\u00f9ng counter monotonic ho\u1eb7c CSPRNG + ki\u1ec3m va ch\u1ea1m.</li> <li>Gi\u1eef tag 128 bit; so s\u00e1nh h\u1eb1ng th\u1eddi gian.</li> <li>Kh\u00f4ng thay \u0111\u1ed5i s\u1ed1 v\u00f2ng; d\u00f9ng th\u01b0 vi\u1ec7n chu\u1ea9n (Botan/OpenSSL n\u1ebfu c\u00f3 Serpent) v\u1edbi bit-slice constant-time.</li> <li>\u0110\u01b0a metadata v\u00e0o AAD; th\u00eam ch\u1ed1ng replay b\u1eb1ng version/timestamp.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>Kh\u00f4ng c\u00f3 b\u1ed9 FIPS; d\u00f9ng vector t\u1eeb Crypto++/Botan test suite ho\u1eb7c t\u1ef1 sinh b\u1eb1ng Botan <code>aead --cipher Serpent/GCM</code> v\u1edbi (key, nonce, aad, pt) c\u1ed1 \u0111\u1ecbnh v\u00e0 ghi l\u1ea1i (ct, tag).</li> <li>L\u01b0u vector n\u1ed9i b\u1ed9 v\u00e0o tests c\u1ee7a FileVault \u0111\u1ec3 tr\u00e1nh h\u1ed3i quy.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#11-v\u00ed-d\u1ee5-code-c-v\u1edbi-botan","title":"11. V\u00ed d\u1ee5 code (C++ v\u1edbi Botan)","text":"C++<pre><code>auto aead = Botan::AEAD_Mode::create(\"Serpent/GCM\", Botan::ENCRYPTION);\naead-&gt;set_key(key);\naead-&gt;start(nonce);\naead-&gt;set_associated_data(aad);\nauto buf = plaintext;\naead-&gt;finish(buf); // buf = ciphertext || tag\n</code></pre>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Nonce 96-bit duy nh\u1ea5t; log/counter \u0111\u1ec3 ch\u1ed1ng tr\u00f9ng.</li> <li> Tag 128-bit; so s\u00e1nh h\u1eb1ng th\u1eddi gian.</li> <li> Kh\u00f4ng gi\u1ea3m s\u1ed1 v\u00f2ng, kh\u00f4ng d\u00f9ng S-box b\u1ea3ng ph\u1ee5 thu\u1ed9c d\u1eef li\u1ec7u.</li> <li> Bao g\u1ed3m metadata v\u00e0o AAD; c\u00e2n nh\u1eafc ch\u1ed1ng replay.</li> <li> Ki\u1ec3m th\u1eed b\u1eb1ng vector n\u1ed9i b\u1ed9 sau m\u1ecdi t\u1ed1i \u01b0u h\u00f3a.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Hi\u1ec7u n\u0103ng: th\u01b0\u1eddng ch\u1eadm h\u01a1n AES-GCM (\u0111\u1eb7c bi\u1ec7t tr\u00ean CPU c\u00f3 AES-NI) \u2014 chi ph\u00ed CPU cao h\u01a1n do bit-slicing/32 v\u00f2ng.</li> <li>H\u1ed7 tr\u1ee3 h\u1ea1n ch\u1ebf: \u00edt ph\u1ea7n c\u1ee9ng t\u0103ng t\u1ed1c v\u00e0 th\u01b0 vi\u1ec7n ph\u1ed5 bi\u1ebfn so v\u1edbi AES; c\u00f3 th\u1ec3 g\u00e2y kh\u00f3 kh\u0103n khi t\u00edch h\u1ee3p.</li> <li>Chu\u1ea9n h\u00f3a: Serpent kh\u00f4ng ph\u1ea3i l\u00e0 AES/FIPS; interoperability v\u1edbi h\u1ec7 th\u1ed1ng y\u00eau c\u1ea7u chu\u1ea9n FIPS/AES c\u00f3 th\u1ec3 b\u1ecb h\u1ea1n ch\u1ebf.</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p tri\u1ec3n khai: \u0111\u1ea3m b\u1ea3o bit-slice constant-time v\u00e0 GHASH an to\u00e0n t\u1ed1n c\u00f4ng h\u01a1n.</li> <li>R\u1ee7i ro v\u1eadn h\u00e0nh: v\u1eabn ph\u1ee5 thu\u1ed9c nghi\u00eam ng\u1eb7t v\u00e0o t\u00ednh duy nh\u1ea5t c\u1ee7a nonce v\u00e0 k\u00edch th\u01b0\u1edbc tag; nonce reuse ho\u1eb7c tag truncation ph\u00e1 v\u1ee1 b\u1ea3o m\u1eadt.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>L\u01b0u tr\u1eef l\u01b0u tr\u1eef d\u00e0i h\u1ea1n / h\u1ed3 s\u01a1 c\u1ef1c k\u1ef3 nh\u1ea1y c\u1ea3m (archival with paranoid security profile).</li> <li>M\u00f4i tr\u01b0\u1eddng ph\u1ea7n m\u1ec1m-only n\u01a1i hi\u1ec7u n\u0103ng kh\u00f4ng l\u00e0 \u01b0u ti\u00ean ch\u00ednh nh\u01b0ng c\u1ea7n bi\u00ean \u0111\u1ed9 an to\u00e0n cao.</li> <li>H\u1ec7 th\u1ed1ng y\u00eau c\u1ea7u cipher thay th\u1ebf c\u00f3 margin b\u1ea3o m\u1eadt l\u1edbn h\u01a1n AES cho d\u1ef1 ph\u00f2ng t\u01b0\u01a1ng lai.</li> <li>Nghi\u00ean c\u1ee9u m\u1eadt m\u00e3 v\u00e0 th\u1eed nghi\u1ec7m thu\u1eadt to\u00e1n thay th\u1ebf.</li> </ul>"},{"location":"algorithms/symmetric/ahead/serpent-gcm/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>Serpent \u2014 Anderson, Biham, Knudsen (\u0111\u1ec1 xu\u1ea5t Serpent): https://www.cl.cam.ac.uk/~rja14/serpent.html </li> <li>The Galois/Counter Mode (GCM) \u2014 McGrew &amp; Viega (2004): https://cse.ucsd.edu/~dan/papers/gcm-spec.pdf </li> <li>NIST SP 800-38D \u2014 Recommendation for GCM (GHASH and AEAD details): https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf </li> <li>Botan (AEAD / Serpent usage, test vectors): https://botan.randombit.net/manual/ </li> <li>Crypto++ library and test suite (vectors &amp; implementations): https://www.cryptopp.com/</li> <li>Th\u1ef1c h\u00e0nh an to\u00e0n AEAD: kh\u00f4ng t\u00e1i s\u1eed d\u1ee5ng nonce, gi\u1eef tag \u0111\u1ea7y \u0111\u1ee7, so s\u00e1nh h\u1eb1ng th\u1eddi gian (t\u00e0i li\u1ec7u NIST/Botan/Crypto++).</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/","title":"SM4-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/sm4-gcm/#sm4-gcm-galoiscounter-mode","title":"SM4-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/sm4-gcm/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<p>SM4-GCM k\u1ebft h\u1ee3p block cipher SM4 (GB/T 32907-2016, b\u1eaft bu\u1ed9c trong WAPI) v\u1edbi AEAD GCM. M\u1ee5c ti\u00eau: \u0111\u00e1p \u1ee9ng y\u00eau c\u1ea7u tu\u00e2n th\u1ee7 chu\u1ea9n Trung Qu\u1ed1c, \u0111\u1ed3ng th\u1eddi th\u00eam x\u00e1c th\u1ef1c v\u00e0 song song h\u00f3a thay v\u00ec d\u00f9ng CBC/ECB.</p>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>SM4: 32 v\u00f2ng unbalanced Feistel; m\u1ed7i v\u00f2ng d\u00f9ng S-box 8x8 v\u00e0 tuy\u1ebfn t\u00ednh L() tr\u00ean \\(GF(2^{32})\\).</li> <li>GCM: CTR + GHASH tr\u00ean \\(GF(2^{128})\\); tag = \\(E_K(J_0) \\oplus \\text{GHASH}(AAD, C)\\).</li> <li>Key duy nh\u1ea5t 128 bit; d\u1ec5 tri\u1ec3n khai ph\u1ea7n c\u1ee9ng v\u00e0 ph\u1ea7n m\u1ec1m nh\u1eb9.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>Nonce 96-bit sinh ng\u1eabu nhi\u00ean; t\u1ea1o counter \\(J_0\\).</li> <li>SM4-CTR t\u1ea1o keystream; XOR plaintext \u2192 ciphertext.</li> <li>GHASH(AAD, ciphertext) \u2192 tag 16 byte; gi\u1ea3i m\u00e3 ch\u1ec9 khi tag kh\u1edbp.</li> </ol>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: 128 bit (c\u1ed1 \u0111\u1ecbnh).</li> <li>Nonce: 96 bit (12 byte) duy nh\u1ea5t per-key.</li> <li>Tag: 128 bit (16 byte).</li> <li>Block: 128 bit.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#5-so-s\u00e1nh-v\u1edbi-aes-gcm","title":"5. So s\u00e1nh v\u1edbi AES-GCM","text":"\u0110\u1eb7c \u0111i\u1ec3m SM4-GCM AES-GCM Chu\u1ea9n GB/T 32907 (CN), WAPI FIPS 197, to\u00e0n c\u1ea7u Hi\u1ec7u n\u0103ng HW n\u1ed9i \u0111\u1ecba T\u1ed1t (chip TPM/TCM h\u1ed7 tr\u1ee3) R\u1ea5t t\u1ed1t v\u1edbi AES-NI \u0110\u1ed9 d\u00e0i key 128 bit c\u1ed1 \u0111\u1ecbnh 128/192/256"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant SM4_GCM\n    participant Receiver\n\n    Sender-&gt;&gt;SM4_GCM: Key, Nonce, Plaintext, AAD\n    SM4_GCM-&gt;&gt;SM4_GCM: CTR Encrypt -&gt; Ciphertext\n    SM4_GCM-&gt;&gt;SM4_GCM: GHASH(AAD, Ciphertext) -&gt; Tag\n    SM4_GCM-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;SM4_GCM: Key, Nonce, Ciphertext, Tag, AAD\n    SM4_GCM-&gt;&gt;SM4_GCM: GHASH(AAD, Ciphertext) -&gt; Calculated Tag\n    alt Tag Match\n        SM4_GCM-&gt;&gt;SM4_GCM: CTR Decrypt -&gt; Plaintext\n        SM4_GCM-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        SM4_GCM--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce reuse: d\u00f9ng l\u1ea1i nonce v\u1edbi c\u00f9ng key \u2192 r\u00f2 r\u1ec9 keystream v\u00e0 gi\u1ea3 m\u1ea1o.</li> <li>Kh\u00f4ng ki\u1ec3m tag tr\u01b0\u1edbc gi\u1ea3i m\u00e3: d\u1ec5 b\u1ecb t\u1ea5n c\u00f4ng bit-flip tr\u1ea3 v\u1ec1 r\u00e1c.</li> <li>Sai padding \u0111\u1ed9 d\u00e0i trong GHASH: qu\u00ean th\u00eam tr\u01b0\u1eddng length 64-bit cho AAD/ciphertext.</li> <li>D\u00f9ng CBC/ECB thay v\u00ec GCM: m\u1ea5t x\u00e1c th\u1ef1c, d\u1ec5 t\u1ea5n c\u00f4ng ho\u00e1n v\u1ecb block.</li> </ol>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Tamper tr\u00ean \u0111\u0129a: s\u1eeda ciphertext \u2192 tag sai \u2192 gi\u1ea3i m\u00e3 b\u1ecb t\u1eeb ch\u1ed1i.</li> <li>Nonce collision: RNG k\u00e9m ho\u1eb7c counter l\u1ed7i.</li> <li>Side-channel: tri\u1ec3n khai b\u1ea3ng S-box ph\u1ea3i constant-time (tr\u00e1nh cache timing).</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Nonce 96-bit duy nh\u1ea5t; l\u01b0u counter ho\u1eb7c d\u00f9ng CSPRNG ch\u1ea5t l\u01b0\u1ee3ng cao.</li> <li>Ki\u1ec3m tra tag h\u1eb1ng th\u1eddi gian tr\u01b0\u1edbc khi x\u1eed l\u00fd plaintext.</li> <li>\u0110\u01b0a metadata (filename, version, policy) v\u00e0o AAD; c\u00e2n nh\u1eafc ch\u1ed1ng replay.</li> <li>N\u1ebfu m\u00e3 h\u00f3a kh\u1ed1i l\u01b0\u1ee3ng l\u1edbn, c\u00e2n nh\u1eafc xoay key \u0111\u1ec3 gi\u1ea3m r\u1ee7i ro nonce collision.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>B\u1ed9 vector c\u00f4ng khai: GM/T 0002-2012 test set, RFC 8998 Appendix A (SM4 suite), v\u00e0 NIST CAVP (SM4-GCM) n\u1ebfu c\u00f3.</li> <li>Khuy\u1ebfn ngh\u1ecb t\u1ef1 sinh vector b\u1eb1ng OpenSSL (b\u1ea3n c\u00f3 SM4) ho\u1eb7c Botan v\u00e0 l\u01b0u v\u00e0o tests c\u1ee7a FileVault.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#11-v\u00ed-d\u1ee5-code-openssl-cli","title":"11. V\u00ed d\u1ee5 code (OpenSSL CLI)","text":"Bash<pre><code>openssl enc -sm4-gcm -K &lt;hexkey&gt; -iv &lt;hexnonce&gt; -in plaintext.bin -aad &lt;hexaad&gt; -out ciphertext.bin -nopad -p\n# Tag in ra m\u00e0n h\u00ecnh (tag = ...)\n</code></pre>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Nonce 96-bit duy nh\u1ea5t; kh\u00f4ng reuse.</li> <li> Tag 128-bit; so s\u00e1nh h\u1eb1ng th\u1eddi gian.</li> <li> Metadata v\u00e0o AAD; ch\u1ed1ng replay n\u1ebfu c\u1ea7n.</li> <li> D\u00f9ng th\u01b0 vi\u1ec7n \u0111\u01b0\u1ee3c ki\u1ec3m to\u00e1n (OpenSSL/Botan) thay v\u00ec t\u1ef1 c\u00e0i \u0111\u1eb7t.</li> <li> Ki\u1ec3m th\u1eed b\u1eb1ng vector GM/T ho\u1eb7c n\u1ed9i b\u1ed9 sau m\u1ed7i thay \u0111\u1ed5i.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Kh\u00f3a c\u1ed1 \u0111\u1ecbnh 128-bit \u2014 kh\u00f4ng c\u00f3 t\u00f9y ch\u1ecdn \u0111\u1ed9 d\u00e0i l\u1edbn h\u01a1n nh\u01b0 AES; kh\u00f4ng t\u1ef1 \u0111\u1ed9ng cung c\u1ea5p forward secrecy (ph\u1ea3i k\u1ebft h\u1ee3p v\u1edbi KDF/EPHEMERAL keys).</li> <li>R\u1ee7i ro n\u1ebfu reuse nonce ho\u1eb7c c\u1eaft tag (truncated tag) \u2192 m\u1ea5t b\u1ea3o m\u1eadt/kh\u1ea3 n\u0103ng b\u1ecb t\u1ea5n c\u00f4ng gi\u1ea3 m\u1ea1o.</li> <li>Gi\u1edbi h\u1ea1n th\u1ef1c t\u1ebf v\u1ec1 l\u01b0\u1ee3ng d\u1eef li\u1ec7u x\u1eed l\u00fd tr\u00ean m\u1ed9t c\u1eb7p key/nonce (xem NIST SP 800-38D); v\u01b0\u1ee3t ng\u01b0\u1ee1ng gi\u1ea3m an to\u00e0n.</li> <li>V\u1ea5n \u0111\u1ec1 hi\u1ec7n th\u1ef1c: side-channel (S-box, table lookups), l\u1ed7i l\u1eadp tr\u00ecnh GHASH (padding/length) ho\u1eb7c so s\u00e1nh tag kh\u00f4ng h\u1eb1ng th\u1eddi gian.</li> <li>H\u1ed7 tr\u1ee3 ph\u1ea7n c\u1ee9ng/driver c\u00f3 th\u1ec3 kh\u00e1c nhau theo n\u1ec1n t\u1ea3ng\u2014t\u1ea1i m\u1ed9t s\u1ed1 m\u00f4i tr\u01b0\u1eddng ngo\u00e0i Trung Qu\u1ed1c, SM4 HW acceleration \u00edt ph\u1ed5 bi\u1ebfn.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 h\u00f3a file/volume v\u00e0 l\u01b0u tr\u1eef b\u1ea3o m\u1eadt (FileVault, secure backups).</li> <li>Giao th\u1ee9c m\u1ea1ng: TLS/DTLS/IPsec/SSH extensions khi c\u1ea7n chu\u1ea9n SM4 cho m\u00f4i tr\u01b0\u1eddng CN ho\u1eb7c t\u01b0\u01a1ng th\u00edch WAPI.</li> <li>M\u00e3 h\u00f3a endpoint/firmware, messaging v\u00e0 containers trong h\u1ec7 sinh th\u00e1i y\u00eau c\u1ea7u chu\u1ea9n Trung Qu\u1ed1c.</li> <li>T\u00edch h\u1ee3p TPM/TCM v\u00e0 thi\u1ebft b\u1ecb nh\u00fang c\u00f3 h\u1ed7 tr\u1ee3 SM4 \u0111\u1ec3 t\u0103ng hi\u1ec7u n\u0103ng ph\u1ea7n c\u1ee9ng.</li> </ul>"},{"location":"algorithms/symmetric/ahead/sm4-gcm/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>GB/T 32907-2016 \u2014 SM4 standard (Trung Qu\u1ed1c).  </li> <li>GM/T 0002-2012 \u2014 b\u1ed9 test vectors SM4.  </li> <li>NIST SP 800-38D \u2014 Galois/Counter Mode (GCM) specification.  </li> <li>RFC 8998 \u2014 SM4 suite (tham kh\u1ea3o tri\u1ec3n khai/profiles).  </li> <li>NIST CAVP \u2014 ki\u1ec3m th\u1eed v\u00e0 test vectors cho thu\u1eadt to\u00e1n kh\u1ed1i/AEAD.  </li> <li>OpenSSL, Botan documentation \u2014 v\u00ed d\u1ee5 CLI/API cho SM4-GCM.  </li> <li>T\u00e0i li\u1ec7u n\u1ed9i b\u1ed9/whitepapers v\u1ec1 WAPI v\u00e0 tri\u1ec3n khai SM4 tr\u00ean TPM/TCM.</li> </ul> <p>(Add ho\u1eb7c tham chi\u1ebfu ch\u00ednh x\u00e1c c\u00e1c link/t\u00e0i li\u1ec7u n\u1ed9i b\u1ed9 theo ch\u00ednh s\u00e1ch d\u1ef1 \u00e1n.)</p>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/","title":"Twofish-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/twofish-gcm/#twofish-gcm-galoiscounter-mode","title":"Twofish-GCM (Galois/Counter Mode)","text":""},{"location":"algorithms/symmetric/ahead/twofish-gcm/#1-kh\u00e1i-ni\u1ec7m--m\u1ee5c-ti\u00eau","title":"1. Kh\u00e1i ni\u1ec7m &amp; m\u1ee5c ti\u00eau","text":"<p>Twofish-GCM gh\u00e9p block cipher Twofish (\u1ee9ng vi\u00ean chung k\u1ebft AES c\u1ee7a Schneier et al.) v\u1edbi AEAD GCM. M\u1ee5c ti\u00eau: cung c\u1ea5p l\u1ef1a ch\u1ecdn ngo\u00e0i AES, v\u1edbi S-box ph\u1ee5 thu\u1ed9c kh\u00f3a v\u00e0 thi\u1ebft k\u1ebf m\u1edf.</p>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Twofish: 16 v\u00f2ng Feistel; S-box ph\u1ee5 thu\u1ed9c kh\u00f3a; h\u00e0m \\(h()\\) d\u1ef1a tr\u00ean MDS matrix v\u00e0 Reed-Solomon code; whitening keys cho c\u1ea3 tr\u01b0\u1edbc v\u00e0 sau v\u00f2ng.</li> <li>GCM: CTR + GHASH tr\u00ean \\(GF(2^{128})\\); tag = \\(E_K(J_0) \\oplus \\text{GHASH}(AAD, C)\\).</li> <li>Key sizes: 128/192/256 bit; FileVault \u01b0u ti\u00ean 256.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ol> <li>L\u1eadp l\u1ecbch kh\u00f3a Twofish \u0111\u1ec3 sinh subkeys + S-box ph\u1ee5 thu\u1ed9c kh\u00f3a.</li> <li>Twofish-CTR t\u1ea1o keystream; XOR plaintext \u2192 ciphertext.</li> <li>GHASH(AAD, ciphertext) \u2192 tag 16 byte; gi\u1ea3i m\u00e3 ch\u1ec9 khi tag kh\u1edbp h\u1eb1ng th\u1eddi gian.</li> </ol>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: 128/192/256 bit.</li> <li>Nonce: 96 bit (12 byte) duy nh\u1ea5t per-key.</li> <li>Tag: 128 bit (16 byte).</li> <li>Block: 128 bit.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#5-so-s\u00e1nh-v\u1edbi-aes-gcm","title":"5. So s\u00e1nh v\u1edbi AES-GCM","text":"\u0110\u1eb7c \u0111i\u1ec3m Twofish-GCM AES-GCM B\u1ea3o m\u1eadt S-box ph\u1ee5 thu\u1ed9c kh\u00f3a, margin t\u1ed1t An to\u00e0n, c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n Hi\u1ec7u n\u0103ng Ch\u1eadm h\u01a1n (kh\u00f4ng c\u00f3 AES-NI) R\u1ea5t nhanh (AES-NI) Key schedule N\u1eb7ng h\u01a1n (t\u00ednh S-box) Nh\u1eb9 h\u01a1n"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#6-lu\u1ed3ng-d\u1eef-li\u1ec7u-sequence-diagram","title":"6. Lu\u1ed3ng d\u1eef li\u1ec7u (Sequence Diagram)","text":"<pre><code>sequenceDiagram\n    participant Sender\n    participant Twofish_GCM\n    participant Receiver\n\n    Sender-&gt;&gt;Twofish_GCM: Key, Nonce, Plaintext, AAD\n    Twofish_GCM-&gt;&gt;Twofish_GCM: CTR Encrypt -&gt; Ciphertext\n    Twofish_GCM-&gt;&gt;Twofish_GCM: GHASH(AAD, Ciphertext) -&gt; Tag\n    Twofish_GCM-&gt;&gt;Receiver: Nonce + Ciphertext + Tag\n\n    Note right of Receiver: Decryption\n    Receiver-&gt;&gt;Twofish_GCM: Key, Nonce, Ciphertext, Tag, AAD\n    Twofish_GCM-&gt;&gt;Twofish_GCM: GHASH(AAD, Ciphertext) -&gt; Calculated Tag\n    alt Tag Match\n        Twofish_GCM-&gt;&gt;Twofish_GCM: CTR Decrypt -&gt; Plaintext\n        Twofish_GCM-&gt;&gt;Receiver: Plaintext\n    else Tag Mismatch\n        Twofish_GCM--&gt;&gt;Receiver: ERROR (Auth Failed)\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#7-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. Sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ol> <li>Nonce reuse: t\u00e1i s\u1eed d\u1ee5ng nonce v\u1edbi c\u00f9ng key ph\u00e1 v\u1ee1 b\u1ea3o m\u1eadt.</li> <li>Kh\u00f4ng cache subkeys/S-box: t\u00ednh l\u1ea1i cho t\u1eebng file nh\u1ecf l\u00e0m gi\u1ea3m hi\u1ec7u n\u0103ng.</li> <li>Tag truncation &lt; 96 bit: gi\u1ea3m an to\u00e0n x\u00e1c th\u1ef1c.</li> <li>Key schedule t\u1ef1 vi\u1ebft: d\u1ec5 sai trong b\u01b0\u1edbc Reed-Solomon/MDS; n\u00ean d\u00f9ng th\u01b0 vi\u1ec7n.</li> </ol>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Tamper/forgery: s\u1eeda ciphertext \u2192 tag sai \u2192 t\u1eeb ch\u1ed1i gi\u1ea3i m\u00e3.</li> <li>Side-channel: tri\u1ec3n khai Twofish c\u00f3 b\u1ea3ng S-box; c\u1ea7n constant-time \u0111\u1ec3 tr\u00e1nh cache timing.</li> <li>Nonce collision: RNG/counter l\u1ed7i.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Nonce 96-bit duy nh\u1ea5t; d\u00f9ng counter monotonic ho\u1eb7c CSPRNG m\u1ea1nh.</li> <li>Duy tr\u00ec tag 128 bit; so s\u00e1nh h\u1eb1ng th\u1eddi gian.</li> <li>D\u00f9ng th\u01b0 vi\u1ec7n \u0111\u00e3 ki\u1ec3m to\u00e1n (Botan/OpenSSL n\u1ebfu build c\u00f3 Twofish) thay v\u00ec t\u1ef1 tri\u1ec3n khai.</li> <li>Bao g\u1ed3m metadata (filename, version) trong AAD; ch\u1ed1ng replay b\u1eb1ng version/timestamp.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>NESSIE/Twofish test set v\u00e0 b\u1ed9 vector c\u1ed9ng \u0111\u1ed3ng (Botan/Crypto++); kh\u00f4ng c\u00f3 b\u1ed9 FIPS ch\u00ednh th\u1ee9c.</li> <li>Khuy\u1ebfn ngh\u1ecb t\u1ef1 sinh vector (key/nonce/aad/pt \u2192 ct/tag) v\u00e0 th\u00eam v\u00e0o tests FileVault cho h\u1ed3i quy.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#11-v\u00ed-d\u1ee5-code-c-v\u1edbi-botan","title":"11. V\u00ed d\u1ee5 code (C++ v\u1edbi Botan)","text":"C++<pre><code>auto aead = Botan::AEAD_Mode::create(\"Twofish/GCM\", Botan::ENCRYPTION);\naead-&gt;set_key(key);\naead-&gt;start(nonce);\naead-&gt;set_associated_data(aad);\nauto buf = plaintext;\naead-&gt;finish(buf); // buf = ciphertext || tag\n</code></pre>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Nonce 96-bit duy nh\u1ea5t per-key.</li> <li> Tag 128-bit, so s\u00e1nh h\u1eb1ng th\u1eddi gian.</li> <li> D\u00f9ng key 256-bit cho m\u1ee9c b\u1ea3o m\u1eadt cao; xoay key n\u1ebfu c\u1ea7n.</li> <li> \u0110\u01b0a metadata v\u00e0o AAD; ch\u1ed1ng replay.</li> <li> Ki\u1ec3m th\u1eed b\u1eb1ng vector NESSIE/Botan ho\u1eb7c n\u1ed9i b\u1ed9 sau m\u1ed7i thay \u0111\u1ed5i.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Hi\u1ec7u n\u0103ng k\u00e9m so v\u1edbi AES-GCM tr\u00ean ph\u1ea7n c\u1ee9ng c\u00f3 AES-NI; kh\u00f4ng c\u00f3 gia t\u1ed1c ph\u1ed5 bi\u1ebfn.</li> <li>H\u1ed7 tr\u1ee3 th\u01b0 vi\u1ec7n/protocol h\u1ea1n ch\u1ebf \u2014 c\u00f3 th\u1ec3 g\u1eb7p v\u1ea5n \u0111\u1ec1 t\u01b0\u01a1ng th\u00edch.</li> <li>R\u1ee7i ro tri\u1ec3n khai: nonce reuse, kh\u00f4ng th\u1ef1c hi\u1ec7n constant-time cho S-box/table g\u00e2y side-channel.</li> <li>GCM c\u00f3 gi\u1edbi h\u1ea1n an to\u00e0n v\u1ec1 s\u1ed1 block/kh\u00f3a v\u00e0 y\u00eau c\u1ea7u qu\u1ea3n l\u00fd nonce ch\u00ednh x\u00e1c.</li> <li>\u00cdt b\u1ed9 vector chu\u1ea9n v\u00e0 \u0111\u00e1nh gi\u00e1 c\u1ed9ng \u0111\u1ed3ng so v\u1edbi AES.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 h\u00f3a \u1ed5 \u0111\u0129a v\u00e0 FileVault nh\u01b0 l\u1ef1a ch\u1ecdn thay th\u1ebf AES.</li> <li>L\u01b0u tr\u1eef/c\u00e1c h\u1ec7 th\u1ed1ng sao l\u01b0u c\u1ea7n AEAD v\u1edbi cipher ngo\u00e0i AES.</li> <li>M\u00f4i tr\u01b0\u1eddng y\u00eau c\u1ea7u \u0111a d\u1ea1ng thu\u1eadt to\u00e1n (crypto agility) ho\u1eb7c tr\u00e1nh AES v\u00ec ch\u00ednh s\u00e1ch.</li> <li>\u1ee8ng d\u1ee5ng ph\u1ea7n m\u1ec1m/embedded n\u01a1i kh\u00f4ng c\u00f3 AES hardware support nh\u01b0ng ch\u1ea5p nh\u1eadn chi ph\u00ed CPU.</li> </ul>"},{"location":"algorithms/symmetric/ahead/twofish-gcm/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>Schneier, et al. \u2014 The Twofish Encryption Algorithm (1998).</li> <li>McGrew &amp; Viega \u2014 The Galois/Counter Mode of Operation (GCM), 2004.</li> <li>NIST SP 800-38D \u2014 Recommendation for Block Cipher Modes of Operation: GCM.</li> <li>RFC 5116 \u2014 An Interface and Algorithms for Authenticated Encryption.</li> <li>NESSIE test vectors; Botan and Crypto++ documentation (Twofish implementations).</li> <li>Tham kh\u1ea3o tri\u1ec3n khai \u0111\u00e3 \u0111\u01b0\u1ee3c ki\u1ec3m to\u00e1n khi \u00e1p d\u1ee5ng (v\u00ed d\u1ee5: Botan, OpenSSL n\u1ebfu h\u1ed7 tr\u1ee3).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/","title":"AES-CBC \u2014 T\u00e0i li\u1ec7u (FileVault context)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#aes-cbc--t\u00e0i-li\u1ec7u-filevault-context","title":"AES-CBC \u2014 T\u00e0i li\u1ec7u (FileVault context)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#0-filevault-context","title":"0. FileVault context","text":"<p>AES-CBC \u0111\u01b0\u1ee3c FileVault d\u00f9ng \u0111\u1ec3 m\u00e3 h\u00f3a d\u1eef li\u1ec7u tr\u00ean \u0111\u0129a; h\u1ed7 tr\u1ee3 kh\u00f3a 128/192/256 bit v\u00e0 padding PKCS#7. Trong codebase, AES-CBC \u0111\u01b0\u1ee3c x\u1ebfp m\u1ee9c b\u1ea3o m\u1eadt MEDIUM/WEAK; khuy\u1ebfn ngh\u1ecb d\u00f9ng AEAD (AES-GCM / ChaCha20-Poly1305) cho c\u00e1c ch\u1ebf \u0111\u1ed9 STRONG/PARANOID.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#1-kh\u00e1i-ni\u1ec7m--thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m \u2014 Thu\u1eadt to\u00e1n, gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>AES-CBC l\u00e0 m\u1ed9t mode of operation cho AES (m\u00e3 h\u00f3a kh\u1ed1i) nh\u1eb1m b\u1ea3o m\u1eadt t\u00ednh b\u1ea3o m\u1eadt (confidentiality) c\u1ee7a d\u1eef li\u1ec7u l\u1edbn h\u01a1n m\u1ed9t block. CBC b\u1ea3o v\u1ec7 n\u1ed9i dung kh\u1ecfi \u0111\u1ecdc tr\u1ef1c ti\u1ebfp song kh\u00f4ng cung c\u1ea5p t\u00ednh to\u00e0n v\u1eb9n ho\u1eb7c x\u00e1c th\u1ef1c \u2014 do \u0111\u00f3 c\u1ea7n k\u1ebft h\u1ee3p th\u00eam MAC/AEAD \u0111\u1ec3 ng\u0103n s\u1eeda \u0111\u1ed5i.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<p>CBC v\u1eadn h\u00e0nh tr\u00ean c\u00e1c block \\(P_i\\) (plaintext) v\u00e0 \\(C_i\\) (ciphertext) v\u1edbi IV \\(C_0\\): - M\u00e3 h\u00f3a: \\(C_i = E_K(P_i \\oplus C_{i-1})\\) - Gi\u1ea3i m\u00e3: \\(P_i = D_K(C_i) \\oplus C_{i-1}\\) - \\(C_0 = IV\\) (IV ph\u1ea3i ng\u1eabu nhi\u00ean v\u00e0 \u0111\u1ed9c nh\u1ea5t cho m\u1ed7i m\u00e3 h\u00f3a)</p> <p>(Ch\u00fa \u00fd: AES block size c\u1ed1 \u0111\u1ecbnh = 128 bit)</p>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft-b\u01b0\u1edbc","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft b\u01b0\u1edbc)","text":"<ol> <li>M\u1edf r\u1ed9ng kh\u00f3a (Key Expansion).</li> <li>Sinh IV ng\u1eabu nhi\u00ean 16 bytes n\u1ebfu ch\u01b0a c\u00f3.</li> <li>Pad plaintext theo PKCS#7 t\u1edbi b\u1ed9i s\u1ed1 16 bytes.</li> <li>V\u1edbi m\u1ed7i block:<ul> <li>XOR \\(P_i\\) v\u1edbi \\(C_{i-1}\\) (ho\u1eb7c IV cho \\(i=1\\)).</li> <li>\u00c1p d\u1ee5ng AES encrypt v\u1edbi kh\u00f3a \\(K\\) \u0111\u1ec3 ra \\(C_i\\).</li> </ul> </li> <li>K\u1ebft qu\u1ea3 th\u01b0\u1eddng \u0111\u01b0\u1ee3c l\u01b0u d\u01b0\u1edbi d\u1ea1ng: \\(IV \\parallel C_1 \\parallel \\dots \\parallel C_n\\).</li> </ol>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Block size: 128 bits (16 bytes).  </li> <li>Key size: 128 / 192 / 256 bits (FileVault khuy\u1ebfn ngh\u1ecb 256-bit).  </li> <li>IV (nonce): 16 bytes, ph\u1ea3i ng\u1eabu nhi\u00ean v\u00e0 kh\u00f4ng t\u00e1i s\u1eed d\u1ee5ng.  </li> <li>Padding: PKCS#7 (gi\u00e1 tr\u1ecb byte b\u1eb1ng s\u1ed1 byte padding).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-mode-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c mode kh\u00e1c","text":"<ul> <li>AES-ECB: \u0111\u01a1n gi\u1ea3n, nh\u01b0ng kh\u00f4ng an to\u00e0n (l\u1ed9 m\u1eabu).  </li> <li>AES-CTR: parallelizable, nh\u01b0ng kh\u00f4ng c\u00f3 x\u00e1c th\u1ef1c; c\u1ea7n nonce duy nh\u1ea5t.  </li> <li>AES-GCM: AEAD (x\u00e1c th\u1ef1c + m\u00e3 h\u00f3a), parallelizable; \u01b0u ti\u00ean d\u00f9ng cho b\u1ea3o m\u1eadt cao. T\u00f3m t\u1eaft: CBC cung c\u1ea5p confidentiality nh\u01b0ng kh\u00f4ng integrity \u2014 k\u00e9m h\u01a1n AEAD.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-sequence-diagram","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (sequence diagram)","text":"<pre><code>sequenceDiagram\n     participant App\n     participant FV_Encryptor as Encryptor\n     participant Storage\n     participant FV_Decryptor as Decryptor\n\n     App-&gt;&gt;FV_Encryptor: plaintext + key\n     FV_Encryptor-&gt;&gt;FV_Encryptor: generate IV (16B)\n     FV_Encryptor-&gt;&gt;FV_Encryptor: pad plaintext (PKCS#7)\n     loop per block\n        FV_Encryptor-&gt;&gt;FV_Encryptor: XOR with prev cipher / IV\n        FV_Encryptor-&gt;&gt;FV_Encryptor: AES encrypt\n     end\n     FV_Encryptor-&gt;&gt;Storage: IV || ciphertext\n     Note right of Storage: attacker may read/modify ciphertext\n     Storage-&gt;&gt;FV_Decryptor: IV || ciphertext\n     FV_Decryptor-&gt;&gt;FV_Decryptor: AES decrypt, XOR, unpad\n     alt valid + integrity checked\n        FV_Decryptor-&gt;&gt;App: plaintext\n     else tampered / invalid\n        FV_Decryptor-&gt;&gt;App: error\n     end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng IV t\u0129nh ho\u1eb7c d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c \u2192 l\u1ed9 m\u1eabu, CPA.  </li> <li>Kh\u00f4ng d\u00f9ng MAC / x\u00e1c th\u1ef1c \u2192 bit-flipping attack.  </li> <li>X\u1eed l\u00fd l\u1ed7i padding kh\u00e1c bi\u1ec7t (padding oracle).  </li> <li>T\u00e1i s\u1eed d\u1ee5ng key/IV cho nhi\u1ec1u m\u1ee5c ti\u00eau.  </li> <li>Kh\u00f4ng x\u00f3a key kh\u1ecfi b\u1ed9 nh\u1edb sau d\u00f9ng.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>Asset: n\u1ed9i dung file ng\u01b0\u1eddi d\u00f9ng.  </li> <li>Attacker: c\u00f3 th\u1ec3 \u0111\u1ecdc v\u00e0 s\u1eeda file ciphertext (local attacker ho\u1eb7c attacker v\u1edbi write access).  </li> <li>Vect\u01a1 t\u1ea5n c\u00f4ng ch\u00ednh: bit-flipping, padding oracle, replay (IV reuse).  </li> <li>M\u1ee9c nguy c\u01a1: padding oracle \u2014 Critical; bit-flipping \u2014 High.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>\u01afu ti\u00ean: chuy\u1ec3n sang AEAD (AES-GCM / ChaCha20-Poly1305).  </li> <li>N\u1ebfu b\u1eaft bu\u1ed9c d\u00f9ng CBC:</li> <li>S\u1eed d\u1ee5ng Encrypt-then-MAC (HMAC-SHA256) v\u1edbi MAC ki\u1ec3m tra tr\u01b0\u1edbc khi gi\u1ea3i m\u00e3.  </li> <li>IV = CSPRNG 16 bytes, kh\u00f4ng l\u1eb7p l\u1ea1i.  </li> <li>Key management: d\u00f9ng KDF/CSPRNG; chia key cho AES v\u00e0 HMAC.  </li> <li>X\u1eed l\u00fd l\u1ed7i th\u1ed1ng nh\u1ea5t (constant-time responses).  </li> <li>X\u00f3a key ra kh\u1ecfi RAM (secure zeroization).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#10-test-vectors-hex","title":"10. Test Vectors (hex)","text":"<p>Vector minh h\u1ecda (tr\u00edch, 1 block): - AES-128-CBC   - Key: 2b7e151628aed2a6abf7158809cf4f3c   - IV: 000102030405060708090a0b0c0d0e0f   - Plaintext: 6bc1bee22e409f96e93d7e117393172a   - Ciphertext: 7649abac8119b246cee98e9b12e9197d - AES-256-CBC   - Key: 603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4   - IV: 000102030405060708090a0b0c0d0e0f   - Plaintext: 6bc1bee22e409f96e93d7e117393172a   - Ciphertext: f58c4c04d6e5f1ba779eabfb5f7bfbd6</p>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#11-v\u00ed-d\u1ee5-code-python-ng\u1eafn","title":"11. V\u00ed d\u1ee5 code (Python, ng\u1eafn)","text":"Python<pre><code># minimal AES-CBC encrypt/decrypt (no MAC) \u2014 d\u00f9ng cryptography\nimport os\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\nfrom cryptography.hazmat.primitives import padding\n\ndef encrypt_aes_cbc(key, plaintext):\n     iv = os.urandom(16)\n     padder = padding.PKCS7(128).padder()\n     pt = padder.update(plaintext) + padder.finalize()\n     cipher = Cipher(algorithms.AES(key), modes.CBC(iv))\n     ct = cipher.encryptor().update(pt) + cipher.encryptor().finalize()\n     return iv + ct\n\ndef decrypt_aes_cbc(key, data):\n     iv, ct = data[:16], data[16:]\n     cipher = Cipher(algorithms.AES(key), modes.CBC(iv))\n     pt_padded = cipher.decryptor().update(ct) + cipher.decryptor().finalize()\n     unpadder = padding.PKCS7(128).unpadder()\n     return unpadder.update(pt_padded) + unpadder.finalize()\n</code></pre> (L\u01b0u \u00fd: lu\u00f4n k\u00e8m HMAC ho\u1eb7c d\u00f9ng AEAD trong th\u1ef1c t\u1ebf.)"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Key t\u1eeb CSPRNG / KDF, kh\u00f4ng hardcode.  </li> <li> IV ng\u1eabu nhi\u00ean 16 bytes m\u1ed7i l\u1ea7n, kh\u00f4ng t\u00e1i s\u1eed d\u1ee5ng.  </li> <li> D\u00f9ng Encrypt-then-MAC ho\u1eb7c AEAD.  </li> <li> Ki\u1ec3m tra MAC tr\u01b0\u1edbc gi\u1ea3i m\u00e3.  </li> <li> Tr\u1ea3 l\u1ed7i \u0111\u1ed3ng nh\u1ea5t (constant-time).  </li> <li> Zeroize key sau d\u00f9ng.  </li> <li> Logging h\u1ea1n ch\u1ebf, kh\u00f4ng l\u1ed9 th\u00f4ng tin padding/error n\u1ed9i b\u1ed9.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Kh\u00f4ng cung c\u1ea5p integrity/authentication.  </li> <li>D\u1ec5 b\u1ecb padding oracle n\u1ebfu x\u1eed l\u00fd l\u1ed7i k\u00e9m.  </li> <li>Gi\u1ea3i m\u00e3 kh\u00f3 parallelize (hi\u1ec7u n\u0103ng th\u1ea5p so v\u1edbi CTR/GCM).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>L\u01b0u tr\u1eef m\u00e3 h\u00f3a file/volume (khi k\u1ebft h\u1ee3p MAC).  </li> <li>H\u1ec7 th\u1ed1ng t\u01b0\u01a1ng th\u00edch c\u0169; kh\u00f4ng d\u00f9ng cho giao ti\u1ebfp m\u1ea1ng m\u1edbi n\u1ebfu AEAD kh\u1ea3 d\u1ee5ng.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cbc/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800-38A (modes of operation)  </li> <li>RFC 3602 / RFC 5649 (AES-CBC usage and padding topics)  </li> <li>Vaudenay, S. \u2014 Padding oracle attack papers and analyses  </li> <li>Cryptography libraries docs: Botan, OpenSSL, cryptography.io</li> </ul> <p>\u2014 End of document.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/","title":"AES\u2011CFB (Cipher Feedback Mode)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#aescfb-cipher-feedback-mode","title":"AES\u2011CFB (Cipher Feedback Mode)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#0-filevault-context","title":"0/ Filevault context","text":"<p>T\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 AES\u2011CFB \u0111\u1ec3 \u0111\u01b0a v\u00e0o Filevault: m\u1ee5c ti\u00eau gi\u1ea3i th\u00edch kh\u00e1i ni\u1ec7m, to\u00e1n h\u1ecdc, tri\u1ec3n khai, r\u1ee7i ro v\u00e0 bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u cho m\u00e3 h\u00f3a lu\u1ed3ng/kh\u1ed1i b\u00e1n lu\u1ed3ng trong h\u1ec7 th\u1ed1ng l\u01b0u tr\u1eef/tuy\u1ebfn truy\u1ec1n.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#1-kh\u00e1i-ni\u1ec7m--thu\u1eadt-to\u00e1n-v\u1ea5n-\u0111\u1ec1-gi\u1ea3i-quy\u1ebft-b\u1ea3o-v\u1ec7-g\u00ec","title":"1/ Kh\u00e1i ni\u1ec7m \u2014 Thu\u1eadt to\u00e1n, v\u1ea5n \u0111\u1ec1 gi\u1ea3i quy\u1ebft, b\u1ea3o v\u1ec7 g\u00ec","text":"<ul> <li>AES\u2011CFB bi\u1ebfn block cipher th\u00e0nh stream cipher t\u1ef1 \u0111\u1ed3ng b\u1ed9 (self\u2011synchronizing).  </li> <li>Gi\u1ea3i quy\u1ebft: m\u00e3 h\u00f3a d\u1eef li\u1ec7u theo t\u1eebng ph\u1ea7n (stream/segment) tr\u00ean k\u00eanh c\u00f3 th\u1ec3 m\u1ea5t byte/g\u00f3i.  </li> <li>B\u1ea3o v\u1ec7: t\u00ednh b\u00ed m\u1eadt (confidentiality) c\u1ee7a d\u1eef li\u1ec7u; kh\u00f4ng cung c\u1ea5p t\u00ednh to\u00e0n v\u1eb9n/kh\u00f4ng th\u1ec3 ch\u1ed1i b\u1ecf.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2/ To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>Notation: \\(E_K(\\cdot)\\) l\u00e0 AES v\u1edbi key \\(K\\).  </li> <li>M\u00e3 h\u00f3a (CFB\u2011s v\u1edbi block size \\(n\\) bit, th\u01b0\u1eddng \\(n=128\\)): \\(C_i = P_i \\oplus E_K(C_{i-1})\\) v\u1edbi \\(C_0 = IV\\).  </li> <li>Gi\u1ea3i m\u00e3: \\(P_i = C_i \\oplus E_K(C_{i-1})\\).  </li> <li>Khi s\u1eed d\u1ee5ng ph\u1ea7n segment nh\u1ecf h\u01a1n block (CFB\u20118, CFB\u20111), ch\u1ec9 l\u1ea5y \\(s\\) bit t\u1eeb \\(E_K(\\cdot)\\) m\u1ed7i l\u1ea7n.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-\u00fd-ch\u00ednh","title":"3/ C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (\u00fd ch\u00ednh)","text":"<ul> <li>Kh\u1edfi t\u1ea1o: ch\u1ecdn IV d\u00e0i b\u1eb1ng k\u00edch th\u01b0\u1edbc block; IV n\u00ean ng\u1eabu nhi\u00ean/kh\u00f4ng l\u1eb7p.  </li> <li>M\u1ed7i b\u01b0\u1edbc: l\u1ea5y kh\u1ed1i tr\u01b0\u1edbc (ban \u0111\u1ea7u IV), m\u00e3 h\u00f3a b\u1eb1ng AES, XOR k\u1ebft qu\u1ea3 v\u1edbi plaintext segment \u2192 ciphertext segment.  </li> <li>K\u1ebft qu\u1ea3 ciphertext d\u00f9ng l\u00e0m input cho b\u01b0\u1edbc ti\u1ebfp theo (feedback).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4/ C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>K\u00edch th\u01b0\u1edbc block AES = 128 bit; key size = 128/192/256 bit.  </li> <li>IV: 128 bit (khuy\u1ebfn ngh\u1ecb).  </li> <li>Segment size \\(s\\): 128 (CFB\u2011128), 8 (CFB\u20118), 1 (CFB\u20111) bits.  </li> <li>Internal state: register ch\u1ee9a kh\u1ed1i feedback hi\u1ec7n t\u1ea1i.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-ch\u1ebf-\u0111\u1ed9-kh\u00e1c","title":"5/ So s\u00e1nh v\u1edbi c\u00e1c ch\u1ebf \u0111\u1ed9 kh\u00e1c","text":"<ul> <li>CBC: x\u1eed l\u00fd block, kh\u00f4ng t\u1ef1 \u0111\u1ed3ng b\u1ed9; c\u1ea7n padding; kh\u00f4ng cho x\u1eed l\u00fd byte\u2011stream tr\u1ef1c ti\u1ebfp.  </li> <li>CTR: c\u00f3 th\u1ec3 song song, cho truy c\u1eadp ng\u1eabu nhi\u00ean, nh\u01b0ng c\u1ea7n counter/nonce; CFB kh\u00f4ng song song v\u00e0 t\u1ef1 \u0111\u1ed3ng b\u1ed9.  </li> <li>OFB: t\u1ea1o keystream \u0111\u1ed9c l\u1eadp, kh\u00f4ng l\u00e2y lan l\u1ed7i; CFB l\u00e2y lan l\u1ed7i cho 1\u20112 block ti\u1ebfp theo khi c\u00f3 l\u1ed7i ciphertext.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6/ Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart LR\n    IV[IV = C0] --&gt; E{E_K(C_{i-1})}\n    P[Plaintext Pi] --&gt; XOR[XOR]\n    E --&gt; XOR\n    XOR --&gt; C[Ciphertext Ci]\n    C --&gt; Feedback[feed Ci as C_{i-1}]\n    Feedback --&gt; E</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7/ C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>T\u00e1i s\u1eed d\u1ee5ng IV v\u1edbi c\u00f9ng key.  </li> <li>D\u00f9ng IV kh\u00f4ng \u0111\u1ee7 ng\u1eabu nhi\u00ean ho\u1eb7c d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c.  </li> <li>Kh\u00f4ng x\u00e1c th\u1ef1c d\u1eef li\u1ec7u (kh\u00f4ng c\u00f3 MAC/AEAD).  </li> <li>Nh\u1ea7m segment_size gi\u1eefa c\u00e1c h\u1ec7 th\u00e0nh (CFB\u20118 vs CFB\u2011128).  </li> <li>S\u1eed d\u1ee5ng ch\u1ebf \u0111\u1ed9 CFB cho tr\u01b0\u1eddng h\u1ee3p c\u1ea7n truy c\u1eadp ng\u1eabu nhi\u00ean/parallel.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#8-threat-model","title":"8/ Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 quan s\u00e1t/gi\u1ea3 m\u1ea1o ciphertext tr\u00ean k\u00eanh; kh\u00f4ng c\u00f3 quy\u1ec1n bi\u1ebft key.  </li> <li>M\u1ee5c ti\u00eau: ng\u0103n \u0111\u1ecdc plaintext, nh\u01b0ng integrity/anti\u2011tamper kh\u00f4ng \u0111\u1ea3m b\u1ea3o b\u1edfi CFB \u0111\u01a1n thu\u1ea7n.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9/ Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n d\u00f9ng IV duy nh\u1ea5t v\u00e0 kh\u00f4ng l\u1eb7p; IV t\u1ed1t nh\u1ea5t l\u00e0 ng\u1eabu nhi\u00ean.  </li> <li>K\u1ebft h\u1ee3p x\u00e1c th\u1ef1c: HMAC ho\u1eb7c chuy\u1ec3n sang AEAD (AES\u2011GCM, AES\u2011CCM).  </li> <li>Ki\u1ec3m so\u00e1t segment_size v\u00e0 t\u01b0\u01a1ng th\u00edch gi\u1eefa c\u00e1c b\u00ean.  </li> <li>B\u1ea3o v\u1ec7 key v\u00e0 quy tr\u00ecnh sinh IV.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#10-test-vectors--ki\u1ec3m-tra","title":"10/ Test Vectors / Ki\u1ec3m tra","text":"<ul> <li>\u0110\u1ec1 ngh\u1ecb d\u00f9ng b\u1ed9 vector NIST SP 800\u201138A (CFB samples) cho ki\u1ec3m th\u1eed ch\u00ednh x\u00e1c.  </li> <li>C\u00e1ch t\u1ea1o nhanh v\u1edbi OpenSSL (CFB128):     openssl enc -aes-128-cfb -in plain.bin -out cipher.bin -K  -iv  -nopad -nosalt  </li> <li>Ki\u1ec3m tra c\u00e1c tr\u01b0\u1eddng h\u1ee3p: t\u1ea5t c\u1ea3\u2011zero plaintext, kh\u00e1c \u0111\u1ed9 d\u00e0i block, c\u00e1c segment_size kh\u00e1c nhau.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#11-code-v\u00ed-d\u1ee5-ng\u1eafn-python--pycryptodome","title":"11/ Code (v\u00ed d\u1ee5 ng\u1eafn, Python + PyCryptodome)","text":"Python<pre><code>from Crypto.Cipher import AES\nkey = bytes.fromhex(\"00112233445566778899aabbccddeeff\")\niv  = bytes.fromhex(\"000102030405060708090a0b0c0d0e0f\")\ncipher = AES.new(key, AES.MODE_CFB, iv=iv, segment_size=128)\nct = cipher.encrypt(b\"Secret message here\")\n# decrypt: new cipher with same key+iv\ndec = AES.new(key, AES.MODE_CFB, iv=iv, segment_size=128)\npt = dec.decrypt(ct)\n</code></pre>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#12-checklist-b\u1ea3o-m\u1eadt-t\u00f3m-t\u1eaft","title":"12/ Checklist b\u1ea3o m\u1eadt (t\u00f3m t\u1eaft)","text":"<ul> <li> IV ng\u1eabu nhi\u00ean/kh\u00f4ng l\u1eb7p.  </li> <li> Key ph\u00e2n ph\u1ed1i/b\u1ea3o qu\u1ea3n an to\u00e0n.  </li> <li> D\u00f9ng MAC ho\u1eb7c AEAD \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o integrity.  </li> <li> \u0110o\u1ea1n m\u00e3 d\u00f9ng segment_size \u0111\u00fang.  </li> <li> Ki\u1ec3m th\u1eed b\u1eb1ng vector chu\u1ea9n.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13/ H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Kh\u00f4ng cung c\u1ea5p integrity; d\u1ec5 b\u1ecb bit\u2011flipping n\u1ebfu kh\u00f4ng x\u00e1c th\u1ef1c.  </li> <li>Kh\u00f4ng ph\u00f9 h\u1ee3p cho truy c\u1eadp ng\u1eabu nhi\u00ean v\u00e0 kh\u00f4ng song song h\u00f3a t\u1ed1t.  </li> <li>L\u00e2y lan l\u1ed7i: l\u1ed7i m\u1ed9t bit trong ciphertext ph\u00e1 v\u1ee1 block hi\u1ec7n t\u1ea1i v\u00e0 sau \u0111\u00f3.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#14-\u1ee9ng-d\u1ee5ng","title":"14/ \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 h\u00f3a lu\u1ed3ng d\u1eef li\u1ec7u/terminal sessions, k\u00eanh c\u00f3 th\u1ec3 m\u1ea5t byte/g\u00f3i, h\u1ec7 th\u1ed1ng legacy c\u1ea7n self\u2011synchronization.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-cfb/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15/ Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800\u201138A (m\u00f4 t\u1ea3 ch\u1ebf \u0111\u1ed9 v\u1eadn h\u00e0nh AES, g\u1ed3m CFB).  </li> <li>PyCryptodome / OpenSSL docs (h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng ch\u1ebf \u0111\u1ed9 CFB).  </li> <li>T\u00e0i li\u1ec7u t\u1ed5ng quan v\u1ec1 ch\u1ebf \u0111\u1ed9 v\u1eadn h\u00e0nh block cipher (b\u00e0i vi\u1ebft, s\u00e1ch gi\u00e1o khoa).</li> </ul> <p>Ghi ch\u00fa: \u01b0u ti\u00ean th\u00eam x\u00e1c th\u1ef1c (MAC/AEAD) tr\u01b0\u1edbc khi d\u00f9ng AES\u2011CFB trong m\u00f4i tr\u01b0\u1eddng s\u1ea3n xu\u1ea5t.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/","title":"AES-CTR (Counter Mode)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#aes-ctr-counter-mode","title":"AES-CTR (Counter Mode)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#0-filevault-context","title":"0. Filevault context","text":"<ul> <li>V\u1ecb tr\u00ed: /algorithms/symmetric/non-ahead/aes-ctr.md  </li> <li>M\u1ee5c ti\u00eau: m\u00f4 t\u1ea3 AES-CTR cho t\u00e0i li\u1ec7u Filevault (block-level/stream-like encryption, random access).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#1-kh\u00e1i-ni\u1ec7m--thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m \u2014 Thu\u1eadt to\u00e1n gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<ul> <li>AES-CTR bi\u1ebfn AES (block cipher) th\u00e0nh stream cipher b\u1eb1ng c\u00e1ch m\u00e3 h\u00f3a c\u00e1c counter \u0111\u1ec3 sinh keystream.  </li> <li>Gi\u1ea3i quy\u1ebft: m\u00e3 h\u00f3a d\u1eef li\u1ec7u k\u00edch th\u01b0\u1edbc b\u1ea5t k\u1ef3, cho ph\u00e9p random-access v\u00e0 song song h\u00f3a.  </li> <li>B\u1ea3o v\u1ec7: t\u00ednh b\u00ed m\u1eadt (confidentiality) c\u1ee7a plaintext n\u1ebfu Nonce/Key \u0111\u00fang; kh\u00f4ng cung c\u1ea5p integrity/authentication.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>\u0110\u1ecbnh ngh\u0129a k\u00fd hi\u1ec7u:<ul> <li>K: kh\u00f3a AES; P_i, C_i: plaintext/ciphertext block i (128-bit); N: nonce; ctr_i: gi\u00e1 tr\u1ecb counter cho block i; n_ctr: s\u1ed1 bit d\u00e0nh cho counter.</li> <li>K\u1ebft h\u1ee3p nonce/counter th\u00e0nh kh\u1ed1i \u0111\u1ea7u v\u00e0o AES l\u00e0 IV_i = N || ctr_i (\u0111\u1ed9 d\u00e0i 128 bit).</li> </ul> </li> <li>C\u00f4ng th\u1ee9c (hi\u1ec3n th\u1ecb): \\(\\(\\text{IV}_i = N \\,\\|\\, \\text{ctr}_i,\\qquad \\text{ctr}_i = (\\text{ctr}_0 + i)\\bmod 2^{n_{ctr}}\\)\\) \\(\\(S_i = E_K(\\text{IV}_i)\\)\\) \\(\\(C_i = P_i \\oplus S_i\\)\\) \\(\\(P_i = C_i \\oplus S_i\\)\\)</li> <li>R\u00e0ng bu\u1ed9c quan tr\u1ecdng:<ul> <li>\\(N\\) ph\u1ea3i l\u00e0 unique per key; \\(n_{ctr}\\) \u0111\u1ee7 l\u1edbn \u0111\u1ec3 tr\u00e1nh tr\u00e0n.  </li> <li>Quy \u0111\u1ecbnh r\u00f5 endianness v\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a tr\u01b0\u1eddng \\(\\text{ctr}_i\\) khi n\u1ed1i (\\(\\|\\)).</li> </ul> </li> <li>Thu\u1eadt to\u00e1n (pseudocode, block size = 128 bit): Python<pre><code># inputs: K, N, ctr0, plaintext P (bytes)\n# parameters: n_ctr (bits), block_size = 16\ndef aes_ctr_encrypt(K, N, ctr0, P):\n        C = b''\n        for i in range(0, ceil(len(P)/block_size)):\n                ctr_i = (ctr0 + i) % (1 &lt;&lt; n_ctr)\n                IV = concat_nonce_and_counter(N, ctr_i, n_ctr, endian='big')  # specify endian\n                S = AES_encrypt_block(K, IV)\n                Pblock = get_block(P, i, block_size)  # pad or handle partial block as defined\n                C += xor_bytes(Pblock, S)[: len(Pblock)]\n        return C\n</code></pre></li> <li>Ghi ch\u00fa: d\u00f9ng th\u01b0 vi\u1ec7n CTR mode c\u1ee7a crypto provider khi c\u00f3 s\u1eb5n \u0111\u1ec3 tr\u00e1nh l\u1ed7i \u0111\u1ecbnh d\u1ea1ng counter.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng-t\u00f3m-t\u1eaft","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng (t\u00f3m t\u1eaft)","text":"<ul> <li>Ch\u1ecdn Nonce N (unique per key), kh\u1edfi t\u1ea1o counter (th\u01b0\u1eddng t\u1eeb 0).  </li> <li>V\u1edbi m\u1ed7i block i: sinh keystream b\u1eb1ng AES encrypt c\u1ee7a (N || ctr_i), XOR v\u1edbi block plaintext.  </li> <li>T\u0103ng counter cho block ti\u1ebfp theo.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: 128 / 192 / 256 bit.  </li> <li>Nonce/IV: th\u01b0\u1eddng 64\u2013128 bit (must be unique per key).  </li> <li>Counter: ph\u1ea7n t\u0103ng d\u1ea7n (doanh s\u1ed1 bit cho ph\u00e9p increment).  </li> <li>Block: 128-bit (AES block size).  </li> <li>L\u01b0u tr\u1eef metadata: nonce per-file/segment, initial counter, block index.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>CTR vs CBC: CTR cho random access v\u00e0 parallel, CBC kh\u00f4ng cho random access v\u00e0 c\u1ea7n IV ng\u1eabu nhi\u00ean.  </li> <li>CTR vs GCM: GCM cung c\u1ea5p c\u1ea3 confidentiality + integrity (AEAD); CTR c\u1ea7n k\u1ebft h\u1ee3p MAC/HMAC \u0111\u1ec3 c\u00f3 integrity.  </li> <li>CTR vs OFB/CFB: CTR \u0111\u01a1n gi\u1ea3n h\u01a1n, parallelizable; OFB/CFB c\u00f3 kh\u00e1c bi\u1ec7t v\u1ec1 l\u1ed7i-sinh v\u00e0 l\u1ed7i lan truy\u1ec1n.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-mermaid","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (mermaid)","text":"<pre><code>flowchart TD\n    A[Plaintext, Key K, Nonce N] --&gt; B[Init counter = 0]\n    B --&gt; C{For each block i}\n    C --&gt; D[\"Compute Ki = AES_K(N || ctr_i)\"]\n    D --&gt; E[XOR: Ci = Pi \u2295 Ki]\n    E --&gt; F[Emit Ci]\n    F --&gt; G[ctr_i += 1]\n    G --&gt; C</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>T\u00e1i s\u1eed d\u1ee5ng Nonce v\u1edbi c\u00f9ng Key (CRITICAL).  </li> <li>S\u1eed d\u1ee5ng Nonce ng\u1eabu nhi\u00ean nh\u01b0ng kh\u00f4ng ki\u1ec3m so\u00e1t tr\u00f9ng l\u1eb7p \u1edf scale l\u1edbn.  </li> <li>K\u1ebft h\u1ee3p CTR m\u00e0 kh\u00f4ng c\u00f3 authentication (kh\u00f4ng d\u00f9ng MAC/AEAD).  </li> <li>Kh\u00f4ng chu\u1ea9n h\u00f3a endian/format c\u1ee7a counter d\u1eabn t\u1edbi incompatibility.  </li> <li>D\u00f9ng counter qu\u00e1 ng\u1eafn, tr\u00e0n counter.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 \u0111\u1ecdc/bit-flip ciphertext, ch\u00e8n/t\u00e1i ph\u00e1t.  </li> <li>Kh\u00f4ng ng\u0103n ch\u1eb7n r\u00f2 r\u1ec9 metadata (nonce, counters) n\u1ebfu kh\u00f4ng b\u1ea3o v\u1ec7.  </li> <li>M\u1ed1i nguy ch\u00ednh: nonce reuse -&gt; ph\u00e1 h\u1ee7y t\u00ednh b\u1ea3o m\u1eadt.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Guarantee unique Nonce per Key (use per-file monotonic counter, or construct from (file-id || block-index)).  </li> <li>S\u1eed d\u1ee5ng AEAD (AES-GCM) ho\u1eb7c th\u00eam HMAC/Encrypt-then-MAC.  </li> <li>Ki\u1ec3m so\u00e1t v\u00e0 rotate key khi c\u1ea7n.  </li> <li>Ki\u1ec3m tra overflow counter, d\u1ef1 ph\u00f2ng khi counter \u0111\u1ea7y.  </li> <li>Log/verify metadata integrity.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#10-test-vectors-aes-128-ctr-minh-h\u1ecda","title":"10. Test Vectors (AES-128-CTR, minh h\u1ecda)","text":"<ul> <li>Key: 2b7e151628aed2a6abf7158809cf4f3c  </li> <li>Nonce/IV (initial counter block): f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff  </li> <li>Plaintext (1 block): 6bc1bee22e409f96e93d7e117393172a  </li> <li>Keystream (AES-128 encrypt IV): 874d6191b620e3261bef6864990db6ce  </li> <li>Ciphertext:  (plaintext XOR keystream) = f5f1c9379a8b5f77b68a4d7da537f294</li> </ul> <p>(Tham kh\u1ea3o NIST/ RFC cho test vectors ch\u00ednh th\u1ee9c.)</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#11-code-t\u00f9y-ch\u1ecdn-python-pseudocode","title":"11. Code (t\u00f9y ch\u1ecdn, Python pseudocode)","text":"Python<pre><code># requires cryptography\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\n\ndef aes_ctr_encrypt(key, nonce, plaintext):\n        # Construct initial counter block (nonce || counter)\n        # Use library CTR mode to avoid manual counter mistakes\n        cipher = Cipher(algorithms.AES(key), modes.CTR(nonce))\n        encryptor = cipher.encryptor()\n        return encryptor.update(plaintext) + encryptor.finalize()\n</code></pre>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#12-checklist-b\u1ea3o-m\u1eadt-ng\u1eafn","title":"12. Checklist b\u1ea3o m\u1eadt (ng\u1eafn)","text":"<ul> <li> Nonce unique per key.  </li> <li> Use AEAD or Encrypt-then-MAC.  </li> <li> Proper counter size and overflow handling.  </li> <li> Consistent endian/format.  </li> <li> Key management &amp; rotation.  </li> <li> Testing with official vectors.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Kh\u00f4ng cung c\u1ea5p integrity by default.  </li> <li>Nonce reuse d\u1eabn t\u1edbi catastrophic failure.  </li> <li>Keystream reuse d\u1ec5 d\u00e0ng l\u1ed9 th\u00f4ng tin.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>Disk/volume encryption (random access).  </li> <li>Network streaming, VPNs (khi c\u00f3 integrity layer).  </li> <li>Protocols c\u1ea7n parallel encryption.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ctr/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800-38A (Block Cipher Modes of Operation)  </li> <li>FIPS 197 (AES specification)  </li> <li>RFC 3686 (AES-CTR usage)  </li> <li>C\u00e1c b\u00e0i vi\u1ebft v\u1ec1 misuse of IV/nonce (nonce-reuse pitfalls)</li> </ul> <p>Ghi ch\u00fa: lu\u00f4n \u01b0u ti\u00ean AEAD (v\u00ed d\u1ee5 AES-GCM ho\u1eb7c ChaCha20-Poly1305) n\u1ebfu c\u1ea7n confidentiality + integrity.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/","title":"AES-OFB (Output Feedback Mode)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#aes-ofb-output-feedback-mode","title":"AES-OFB (Output Feedback Mode)","text":""},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#0-filevault-context","title":"0. Filevault context","text":"<p>T\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 AES-OFB d\u00f9ng trong Filevault \u0111\u1ec3 bi\u1ebfn AES block cipher th\u00e0nh m\u1ed9t synchronous stream cipher \u2014 ph\u00f9 h\u1ee3p cho m\u00e3 h\u00f3a lu\u1ed3ng d\u1eef li\u1ec7u, pre-computation keystream, nh\u01b0ng kh\u00f4ng cung c\u1ea5p t\u00ednh to\u00e0n v\u1eb9n.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#1-kh\u00e1i-ni\u1ec7m-thu\u1eadt-to\u00e1n","title":"1. Kh\u00e1i ni\u1ec7m thu\u1eadt to\u00e1n","text":"<p>AES-OFB sinh keystream \u0111\u1ed9c l\u1eadp v\u1edbi plaintext v\u00e0 XOR v\u1edbi plaintext \u0111\u1ec3 t\u1ea1o ciphertext. Gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1: m\u00e3 h\u00f3a lu\u1ed3ng/stream, b\u1ea3o v\u1ec7 t\u00ednh b\u00ed m\u1eadt (confidentiality) c\u1ee7a d\u1eef li\u1ec7u. Kh\u00f4ng b\u1ea3o v\u1ec7 t\u00ednh to\u00e0n v\u1eb9n hay x\u00e1c th\u1ef1c.</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#2-to\u00e1n-h\u1ecdc--c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc / C\u00f4ng th\u1ee9c","text":"<p>Kh\u1edfi t\u1ea1o v\u1edbi IV (initialization vector) v\u00e0 kh\u00f3a \\(K\\): - \\(Z_0 = IV\\) - \\(Z_i = E_K(Z_{i-1})\\) - \\(C_i = P_i \\oplus Z_i\\) Gi\u1ea3i m\u00e3: \\(P_i = C_i \\oplus Z_i\\) v\u1edbi c\u00f9ng \\(Z_i\\).</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>T\u00ednh li\u00ean ti\u1ebfp \\(Z_i\\) b\u1eb1ng vi\u1ec7c m\u00e3 h\u00f3a kh\u1ed1i tr\u01b0\u1edbc \u0111\u00f3 (kh\u00f4ng ph\u1ee5 thu\u1ed9c plaintext/ciphertext).</li> <li>Keystream \\(Z_1,Z_2,\\dots\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ti\u1ec1n t\u00ednh tr\u01b0\u1edbc (pre-computation).</li> <li>M\u1ed7i kh\u1ed1i plaintext XOR v\u1edbi keystream t\u01b0\u01a1ng \u1ee9ng \u2192 ciphertext.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Key: 128/192/256 bit.</li> <li>IV: k\u00edch th\u01b0\u1edbc kh\u1ed1i AES (128 bit). N\u00ean l\u00e0 nonce duy nh\u1ea5t per encryption.</li> <li>Blocks: plaintext/ciphertext chia theo k\u00edch th\u01b0\u1edbc kh\u1ed1i; n\u1ebfu d\u1eef li\u1ec7u kh\u00f4ng chia h\u1ebft, OFB cho ph\u00e9p x\u1eed l\u00fd \u1edf m\u1ee9c bit/byte stream (no padding needed).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#5-so-s\u00e1nh-v\u1edbi-c\u00e1c-ch\u1ebf-\u0111\u1ed9-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi c\u00e1c ch\u1ebf \u0111\u1ed9 kh\u00e1c","text":"<ul> <li>CTR: c\u0169ng l\u00e0 stream-mode, c\u00f3 th\u1ec3 precompute; CTR d\u00f9ng counter thay v\u00ec m\u00e3 h\u00f3a chaining IV. CTR c\u00f3 t\u00ednh linh ho\u1ea1t cao h\u01a1n v\u1ec1 random access.</li> <li>CFB: keystream ph\u1ee5 thu\u1ed9c ciphertext tr\u01b0\u1edbc \u0111\u00f3 \u2192 c\u00f3 error propagation kh\u00e1c.</li> <li>CBC: block-mode, c\u1ea7n padding, propagation kh\u00e1c.</li> <li>L\u1ee3i th\u1ebf OFB: kh\u00f4ng error propagation, precomputation. H\u1ea1n ch\u1ebf: IV reuse l\u00e0 th\u1ea3m h\u1ecda (gi\u1ed1ng CTR).</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-sequence","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (sequence)","text":"<p>mermaid </p> <pre><code>flowchart LR\n    Start --&gt; IV[\"Z0 = IV\"]\n    IV --&gt; E1[\"Z1 = E_K(Z0)\"]\n    E1 --&gt; XOR1[\"C1 = P1 \u2295 Z1\"]\n    E1 --&gt; E2[\"Z2 = E_K(Z1)\"]\n    E2 --&gt; XOR2[\"C2 = P2 \u2295 Z2\"]\n    XOR1 --&gt; Out1[\"Ciphertext\"]\n    XOR2 --&gt; Out2[\"Ciphertext\"]</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>T\u00e1i s\u1eed d\u1ee5ng IV/nonce cho nhi\u1ec1u l\u1ea7n m\u00e3 h\u00f3a v\u1edbi c\u00f9ng kh\u00f3a \u2192 keystream tr\u00f9ng \u2192 ti\u1ebft l\u1ed9 XOR c\u1ee7a plaintexts.</li> <li>Kh\u00f4ng d\u00f9ng IV \u0111\u1ee7 entropy ho\u1eb7c IV d\u1ec5 \u0111o\u00e1n.</li> <li>Coi OFB l\u00e0 cung c\u1ea5p integrity (kh\u00f4ng).</li> <li>L\u1ed7i trong c\u1eaft n\u1ed1i stream l\u00e0m l\u1ed9 keystream ph\u1ea7n.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 th\u1ec3 quan s\u00e1t ciphertexts, c\u00f3 th\u1ec3 g\u1eedi/ch\u1ec9nh s\u1eeda ciphertexts (tampering).</li> <li>Kh\u00f4ng gi\u1ea3 \u0111\u1ecbnh k\u1ebb t\u1ea5n c\u00f4ng bi\u1ebft kh\u00f3a.</li> <li>M\u1ee5c ti\u00eau t\u1ea5n c\u00f4ng: ph\u1ee5c h\u1ed3i plaintext, ph\u00e2n t\u00edch keystream khi IV tr\u00f9ng, replay attacks.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>Lu\u00f4n d\u00f9ng nonce/IV duy nh\u1ea5t cho m\u1ed7i l\u1ea7n m\u00e3 h\u00f3a v\u1edbi c\u00f9ng kh\u00f3a.</li> <li>K\u1ebft h\u1ee3p MAC/AES-GCM ho\u1eb7c encrypt-then-MAC \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o t\u00ednh to\u00e0n v\u1eb9n v\u00e0 x\u00e1c th\u1ef1c.</li> <li>S\u1eed d\u1ee5ng KDF/nonce management \u0111\u1ec3 tr\u00e1nh reuse.</li> <li>Log v\u00e0 ki\u1ec3m tra ngu\u1ed3n IV.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#10-test-vectors","title":"10. Test Vectors","text":"<p>Tham kh\u1ea3o NIST SP 800-38A cho test vectors ch\u00ednh th\u1ee9c. (\u1ede m\u00f4i tr\u01b0\u1eddng test, ki\u1ec3m tra r\u1eb1ng vi\u1ec7c m\u00e3 h\u00f3a r\u1ed3i gi\u1ea3i m\u00e3 kh\u00f4i ph\u1ee5c plaintext v\u00e0 r\u1eb1ng c\u00f9ng IV+key t\u1ea1o ra same keystream.)</p> <p>V\u00ed d\u1ee5 minh h\u1ecda (pseudo): - Key = 0x00...01 (128-bit) - IV  = 0x00...02 (128-bit) - P1  = 0x11223344... - Ki\u1ec3m tra: Z1 = AES_Encrypt(K, IV); C1 = P1 \u2295 Z1</p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#11-code-ng\u1eafn--tu\u1ef3-ch\u1ecdn","title":"11. Code (ng\u1eafn \u2014 tu\u1ef3 ch\u1ecdn)","text":"<p>Python (pycryptodome): </p>Python<pre><code>from Crypto.Cipher import AES\nkey = b'16bytekeyforaes'\niv  = b'16byteinitvector'\ncipher = AES.new(key, AES.MODE_OFB, iv=iv)\nct = cipher.encrypt(plaintext)\n</code></pre><p></p>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> IV l\u00e0 nonce/unique m\u1ed7i l\u1ea7n.</li> <li> Key management \u0111\u00fang (rotation, storage).</li> <li> D\u00f9ng AEAD ho\u1eb7c encrypt-then-MAC cho integrity.</li> <li> Ki\u1ec3m th\u1eed v\u1edbi test vectors ch\u00ednh th\u1ee9c.</li> <li> Log/monitor reuse or atypical IV patterns.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#13-h\u1ea1n-ch\u1ebf","title":"13. H\u1ea1n ch\u1ebf","text":"<ul> <li>Kh\u00f4ng cung c\u1ea5p integrity/authentication.</li> <li>D\u1eef li\u1ec7u b\u1ecb l\u1ed9 n\u1ebfu IV reuse.</li> <li>Kh\u00f4ng ph\u00f9 h\u1ee3p n\u1ebfu c\u1ea7n random-access ch\u1eb7n nh\u1ecf m\u00e0 kh\u00f4ng qu\u1ea3n l\u00fd counter/positions.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>M\u00e3 h\u00f3a lu\u1ed3ng d\u1eef li\u1ec7u, thi\u1ebft b\u1ecb nh\u00fang, khi c\u1ea7n pre-computation keystream.</li> <li>Kh\u00f4ng d\u00f9ng l\u00e0m ph\u01b0\u01a1ng ph\u00e1p duy nh\u1ea5t n\u1ebfu c\u1ea7n authentication.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/aes-ofb/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800-38A \u2014 Recommendation for Block Cipher Modes of Operation</li> <li>FIPS 197 \u2014 Advanced Encryption Standard (AES)</li> <li>RFCs v\u00e0 t\u00e0i li\u1ec7u tri\u1ec3n khai (v\u00ed d\u1ee5 pycryptodome docs)</li> <li>B\u00e0i vi\u1ebft tham kh\u1ea3o v\u1ec1 modes: Wikipedia \"Block cipher mode of operation\"</li> </ul> <p>(Th\u00eam test vectors ch\u00ednh th\u1ee9c \u2192 xem NIST SP 800-38A)</p>"},{"location":"algorithms/symmetric/non-ahead/triple-des/","title":"3DES (Triple DES)","text":""},{"location":"algorithms/symmetric/non-ahead/triple-des/#3des-triple-des","title":"3DES (Triple DES)","text":""},{"location":"algorithms/symmetric/non-ahead/triple-des/#0-filevault-context","title":"0. FileVault Context","text":"<p>FileVault h\u1ed7 tr\u1ee3 3DES ch\u1ec9 \u0111\u1ec3 t\u01b0\u01a1ng th\u00edch ng\u01b0\u1ee3c v\u1edbi c\u00e1c file/h\u1ec7 th\u1ed1ng legacy. KH\u00d4NG khuy\u1ebfn ngh\u1ecb d\u00f9ng cho d\u1eef li\u1ec7u m\u1edbi. N\u1ebfu c\u00f3 th\u1ec3, migrate sang AES-GCM ho\u1eb7c AEAD hi\u1ec7n \u0111\u1ea1i.</p>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#1-kh\u00e1i-ni\u1ec7m--thu\u1eadt-to\u00e1n-gi\u1ea3i-quy\u1ebft-v\u1ea5n-\u0111\u1ec1-g\u00ec-b\u1ea3o-v\u1ec7-c\u00e1i-g\u00ec","title":"1. Kh\u00e1i ni\u1ec7m \u2014 Thu\u1eadt to\u00e1n gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 g\u00ec, b\u1ea3o v\u1ec7 c\u00e1i g\u00ec","text":"<p>3DES l\u00e0 bi\u1ebfn th\u1ec3 c\u1ee7a DES nh\u1eb1m t\u0103ng c\u01b0\u1eddng \u0111\u1ed9 kh\u00f3 ph\u00e1 b\u1eb1ng c\u00e1ch ch\u1ea1y DES ba l\u1ea7n (EDE): b\u1ea3o v\u1ec7 t\u00ednh b\u00ed m\u1eadt (confidentiality) c\u1ee7a kh\u1ed1i d\u1eef li\u1ec7u 64\u2011bit b\u1eb1ng kh\u00f3a d\u00e0i h\u01a1n so v\u1edbi DES \u0111\u01a1n.</p>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#2-to\u00e1n-h\u1ecdc-c\u00f4ng-th\u1ee9c","title":"2. To\u00e1n h\u1ecdc, c\u00f4ng th\u1ee9c","text":"<ul> <li>C\u00f4ng th\u1ee9c (EDE) \u2014 m\u00e3 h\u00f3a (hi\u1ec3n th\u1ecb): $$ C = E_{K_3}\\bigl(D_{K_2}\\bigl(E_{K_1}(P)\\bigr)\\bigr) $$</li> <li>Gi\u1ea3i m\u00e3: $$ P = D_{K_1}\\bigl(E_{K_2}\\bigl(D_{K_3}(C)\\bigr)\\bigr) $$</li> <li>Th\u00f4ng s\u1ed1 k\u00edch th\u01b0\u1edbc:<ul> <li>Block size: 64 bit.</li> <li>Keying options:<ul> <li>3\u2011key: K1, K2, K3 \u0111\u1ed9c l\u1eadp \u2192 nominal 3\u00d756 = 168 bit.</li> <li>2\u2011key: K1 = K3 \u2192 nominal 2\u00d756 = 112 bit.</li> </ul> </li> <li>L\u01b0u \u00fd b\u1ea3o m\u1eadt: m\u1ed7i kh\u00f3a DES th\u1ef1c t\u1ebf c\u00f3 56 effective bits (64 bit bao g\u1ed3m 8 parity bits). Do meet\u2011in\u2011the\u2011middle, 3\u2011key 3DES th\u01b0\u1eddng \u0111\u01b0\u1ee3c xem l\u00e0 ch\u1ec9 \u2248112\u2011bit security trong th\u1ef1c t\u1ebf; 2\u2011key variant c\u00f2n y\u1ebfu h\u01a1n.  </li> </ul> </li> <li>Ghi ch\u00fa: tr\u00e1nh n\u00eau gi\u00e1 tr\u1ecb an to\u00e0n v\u01b0\u1ee3t qu\u00e1 th\u1ef1c t\u1ebf \u2014 tham kh\u1ea3o b\u00e0i to\u00e1n meet\u2011in\u2011the\u2011middle v\u00e0 ph\u00e2n t\u00edch Sweet32 cho c\u00e1c gi\u1edbi h\u1ea1n th\u00eam.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#3-c\u00e1ch-ho\u1ea1t-\u0111\u1ed9ng","title":"3. C\u00e1ch ho\u1ea1t \u0111\u1ed9ng","text":"<ul> <li>V\u1edbi m\u1ed7i kh\u1ed1i 64\u2011bit:<ol> <li>DES encrypt v\u1edbi K1.</li> <li>DES decrypt v\u1edbi K2.</li> <li>DES encrypt v\u1edbi K3 \u2192 sinh ciphertext.</li> </ol> </li> <li>C\u00f3 th\u1ec3 d\u00f9ng 2 kh\u00f3a (K1=K3) ho\u1eb7c 3 kh\u00f3a \u0111\u1ed9c l\u1eadp.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#4-c\u1ea5u-tr\u00fac-d\u1eef-li\u1ec7u","title":"4. C\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<ul> <li>Kh\u00f3a: K1, K2, K3 (56 effective bits m\u1ed7i DES; th\u1ef1c t\u1ebf 168/112 bits).</li> <li>IV (n\u1ebfu mode CBC): 64 bit, n\u00ean random.</li> <li>Padding: PKCS#7 ho\u1eb7c t\u01b0\u01a1ng \u0111\u01b0\u01a1ng cho block 64\u2011bit.</li> <li>Kh\u00f4ng c\u00f3 authentication built\u2011in \u2014 c\u1ea7n AEAD extern.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#5-so-s\u00e1nh-v\u1edbi-thu\u1eadt-to\u00e1n-kh\u00e1c","title":"5. So s\u00e1nh v\u1edbi thu\u1eadt to\u00e1n kh\u00e1c","text":"<ul> <li>So v\u1edbi DES: b\u1ea3o m\u1eadt h\u01a1n do 3 b\u01b0\u1edbc.</li> <li>So v\u1edbi AES (128/192/256): AES nhanh h\u01a1n, block 128\u2011bit (an to\u00e0n h\u01a1n), h\u1ed7 tr\u1ee3 ch\u1ebf \u0111\u1ed9 AEAD (AES\u2011GCM).</li> <li>So v\u1edbi ChaCha20: t\u1ed1t cho hi\u1ec7u n\u0103ng tr\u00ean ph\u1ea7n m\u1ec1m; 3DES ch\u1eadm v\u00e0 block nh\u1ecf \u2192 kh\u00f4ng khuy\u1ebfn ngh\u1ecb.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#6-lu\u1ed3ng-ho\u1ea1t-\u0111\u1ed9ng-sequence","title":"6. Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng (sequence)","text":"<p>Mermaid sequence: </p> <pre><code>sequenceDiagram\n    participant P as Plaintext (64b)\n    participant E1 as E_{K1}\n    participant D2 as D_{K2}\n    participant E3 as E_{K3}\n    participant C as Ciphertext (64b)\n    P-&gt;&gt;E1: E_{K1}(P)\n    E1-&gt;&gt;D2: intermediate\n    D2-&gt;&gt;E3: intermediate\n    E3-&gt;&gt;C: C = E_{K3}(D_{K2}(E_{K1}(P)))</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom  <p></p>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#7-c\u00e1c-sai-l\u1ea7m-tri\u1ec3n-khai-ph\u1ed5-bi\u1ebfn","title":"7. C\u00e1c sai l\u1ea7m tri\u1ec3n khai ph\u1ed5 bi\u1ebfn","text":"<ul> <li>D\u00f9ng ECB cho nhi\u1ec1u kh\u1ed1i \u2192 r\u00f2 r\u1ec9 m\u1eabu.</li> <li>T\u00e1i s\u1eed d\u1ee5ng IV ho\u1eb7c d\u00f9ng IV kh\u00f4ng ng\u1eabu nhi\u00ean trong CBC.</li> <li>Kh\u00f4ng ki\u1ec3m tra parity/weak keys DES.</li> <li>S\u1eed d\u1ee5ng 2\u2011key 3DES khi c\u1ea7n b\u1ea3o m\u1eadt t\u01b0\u01a1ng \u0111\u01b0\u01a1ng 168\u2011bit.</li> <li>Kh\u00f4ng cung c\u1ea5p x\u00e1c th\u1ef1c (MAC/AE) \u2192 vulnerable to tampering.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#8-threat-model","title":"8. Threat Model","text":"<ul> <li>M\u1ee5c ti\u00eau: b\u1ea3o v\u1ec7 confidentiality ch\u1ed1ng l\u1ea1i k\u1ebb t\u1ea5n c\u00f4ng passive/active.</li> <li>Kh\u1ea3 n\u0103ng k\u1ebb t\u1ea5n c\u00f4ng: c\u00f3 th\u1ec3 quan s\u00e1t ciphertext, l\u00e0m chosen\u2011plaintext n\u1ebfu local, c\u00f3 kh\u1ea3 n\u0103ng brute\u2011force t\u1edbi \u22482^112 work n\u1ebfu 2\u2011key.</li> <li>Kh\u00f4ng ch\u1ed1ng replay/tamper n\u1ebfu kh\u00f4ng c\u00f3 AE/MAC.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#9-bi\u1ec7n-ph\u00e1p-gi\u1ea3m-thi\u1ec3u","title":"9. Bi\u1ec7n ph\u00e1p gi\u1ea3m thi\u1ec3u","text":"<ul> <li>KH\u00d4NG d\u00f9ng 3DES cho d\u1eef li\u1ec7u m\u1edbi; migrate sang AES\u2011GCM/ChaCha20\u2011Poly1305.</li> <li>N\u1ebfu b\u1eaft bu\u1ed9c d\u00f9ng 3DES:<ul> <li>Ch\u1ec9 d\u00f9ng 3\u2011key (K1\u2260K2\u2260K3).</li> <li>Gi\u1edbi h\u1ea1n l\u01b0\u1ee3ng d\u1eef li\u1ec7u tr\u00ean m\u1ed9t c\u1eb7p kh\u00f3a (mitigate Sweet32).</li> <li>D\u00f9ng CBC v\u1edbi IV ng\u1eabu nhi\u00ean + MAC (Encrypt\u2011then\u2011MAC) ho\u1eb7c wrap trong AEAD.</li> <li>S\u1eed d\u1ee5ng KDF m\u1ea1nh \u0111\u1ec3 sinh kh\u00f3a t\u1eeb master key.</li> </ul> </li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#10-test-vectors","title":"10. Test Vectors","text":"<ul> <li>V\u00ed d\u1ee5 minh h\u1ecda (EDE, single block, hex):<ul> <li>K1 = 0123456789ABCDEF</li> <li>K2 = 23456789ABCDEF01</li> <li>K3 = 456789ABCDEF0123</li> <li>P  = 0123456789ABCDEF</li> <li>(K\u1ebft qu\u1ea3 ph\u1ee5 thu\u1ed9c tri\u1ec3n khai DES: ki\u1ec3m tra b\u1eb1ng th\u01b0 vi\u1ec7n ti\u00eau chu\u1ea9n nh\u01b0 OpenSSL \u0111\u1ec3 x\u00e1c nh\u1eadn.)</li> </ul> </li> <li>Ki\u1ec3m th\u1eed b\u1eb1ng OpenSSL:<ul> <li>Encryption (CBC, hex): echo -n \"0123456789ABCDEF\" | xxd -r -p | openssl enc -des-ede3-cbc -K  -iv  -nopad -nosalt | xxd -p</li> </ul> </li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#11-code-t\u00f9y-ch\u1ecdn","title":"11. Code (t\u00f9y ch\u1ecdn)","text":"<ul> <li>L\u1eddi khuy\u00ean: d\u00f9ng th\u01b0 vi\u1ec7n crypto chu\u1ea9n (OpenSSL, libsodium kh\u00f4ng h\u1ed7 tr\u1ee3 3DES v\u00ec deprecated). Tr\u00e1nh t\u1ef1 hi\u1ec7n th\u1ef1c DES.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#12-checklist-b\u1ea3o-m\u1eadt","title":"12. Checklist b\u1ea3o m\u1eadt","text":"<ul> <li> Kh\u00f4ng d\u00f9ng cho d\u1eef li\u1ec7u m\u1edbi.</li> <li> N\u1ebfu c\u1ea7n, d\u00f9ng 3\u2011key, kh\u00f4ng d\u00f9ng ECB.</li> <li> IV random v\u00e0 unique cho CBC.</li> <li> \u00c1p d\u1ee5ng Encrypt\u2011then\u2011MAC ho\u1eb7c AEAD wrapper.</li> <li> Gi\u1edbi h\u1ea1n l\u01b0\u1ee3ng d\u1eef li\u1ec7u tr\u00ean m\u1ed9t kh\u00f3a (mitigate Sweet32).</li> <li> Ki\u1ec3m tra/lo\u1ea1i b\u1ecf weak keys.</li> <li> L\u01b0u tr\u1eef kh\u00f3a an to\u00e0n, d\u00f9ng KDF/HSM.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#13-h\u1ea1n-ch\u1ebf-n\u1ebfu-c\u00f3","title":"13. H\u1ea1n ch\u1ebf (n\u1ebfu c\u00f3)","text":"<ul> <li>Block size 64\u2011bit \u2192 vulnerable Sweet32 khi l\u01b0\u1ee3ng d\u1eef li\u1ec7u l\u1edbn.</li> <li>Ch\u1eadm do ba l\u1ea7n DES.</li> <li>Kh\u00f4ng c\u00f3 authentication t\u00edch h\u1ee3p.</li> <li>B\u1ecb NIST deprecated cho h\u1ea7u h\u1ebft \u1ee9ng d\u1ee5ng m\u1edbi.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#14-\u1ee9ng-d\u1ee5ng","title":"14. \u1ee8ng d\u1ee5ng","text":"<ul> <li>T\u01b0\u01a1ng th\u00edch ng\u01b0\u1ee3c v\u1edbi d\u1eef li\u1ec7u legacy, ph\u1ea7n m\u1ec1m c\u0169, ho\u1eb7c giao ti\u1ebfp v\u1edbi h\u1ec7 th\u1ed1ng kh\u00f4ng th\u1ec3 n\u00e2ng c\u1ea5p.</li> <li>Kh\u00f4ng d\u00f9ng cho h\u1ec7 th\u1ed1ng m\u1edbi ho\u1eb7c d\u1eef li\u1ec7u nh\u1ea1y c\u1ea3m.</li> </ul>"},{"location":"algorithms/symmetric/non-ahead/triple-des/#15-ngu\u1ed3n-tham-kh\u1ea3o","title":"15. Ngu\u1ed3n tham kh\u1ea3o","text":"<ul> <li>NIST SP 800\u2011131A (transitioning away from 3DES) \u2014 https://csrc.nist.gov</li> <li>NIST SP 800\u201167 (block cipher modes &amp; recommendations)</li> <li>Sweet32 analysis (vulnerabilities of 64\u2011bit block ciphers)</li> <li>OpenSSL docs: openssl enc -des-ede3</li> </ul> <p>Ghi ch\u00fa: b\u1ea3n t\u00f3m t\u1eaft n\u00e0y \u0111\u1ec3 d\u00f9ng trong FileVault docs; gi\u1eef ch\u00ednh s\u00e1ch kh\u00f4ng d\u00f9ng 3DES cho d\u1eef li\u1ec7u m\u1edbi v\u00e0 \u01b0u ti\u00ean AES/AEAD.</p>"},{"location":"cli/cli/","title":"FileVault CLI Usage Guide","text":""},{"location":"cli/cli/#filevault-cli-usage-guide","title":"FileVault CLI Usage Guide","text":"<p>Complete usage examples for all FileVault commands.</p>"},{"location":"cli/cli/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Encryption &amp; Decryption</li> <li>Hash Operations</li> <li>Compression</li> <li>Archive Operations</li> <li>Steganography</li> <li>Key Generation</li> <li>Configuration</li> <li>List Algorithms</li> <li>Benchmark</li> <li>Info</li> </ul>"},{"location":"cli/cli/#encryption--decryption","title":"Encryption &amp; Decryption","text":""},{"location":"cli/cli/#basic-encryption","title":"Basic Encryption","text":"Bash<pre><code># Encrypt a file with password prompt (recommended)\nfilevault encrypt document.txt\n\n# Encrypt with specific algorithm\nfilevault encrypt document.txt -a aes-256-gcm\n\n# Encrypt with password from command line (less secure)\nfilevault encrypt document.txt -p mypassword\n\n# Encrypt with custom output filename\nfilevault encrypt document.txt encrypted_doc.fvlt -p mypassword\n\n# Encrypt with compression\nfilevault encrypt document.txt --compression zlib -p mypassword\n</code></pre>"},{"location":"cli/cli/#mode-presets","title":"Mode Presets","text":"Bash<pre><code># Basic mode: Fast encryption, good security (casual use)\n# - Algorithm: AES-256-GCM\n# - KDF: PBKDF2-SHA256\n# - Security: medium\nfilevault encrypt document.txt -m basic -p mypassword\n\n# Standard mode: Balanced security and performance (recommended)\n# - Algorithm: AES-256-GCM\n# - KDF: Argon2id\n# - Security: strong\nfilevault encrypt document.txt -m standard -p mypassword\n\n# Advanced mode: Maximum security, slower (high-value data)\n# - Algorithm: AES-256-GCM\n# - KDF: Argon2id\n# - Security: paranoid\n# - Compression: LZMA\nfilevault encrypt document.txt -m advanced -p mypassword\n</code></pre>"},{"location":"cli/cli/#decryption","title":"Decryption","text":"Bash<pre><code># Decrypt a file with password prompt\nfilevault decrypt document.txt.fvlt\n\n# Decrypt with custom output filename\nfilevault decrypt document.txt.fvlt original_document.txt -p mypassword\n\n# Decrypt with verbose output\nfilevault decrypt document.txt.fvlt -p mypassword -v\n</code></pre>"},{"location":"cli/cli/#advanced-encryption-options","title":"Advanced Encryption Options","text":"Bash<pre><code># Custom security level\nfilevault encrypt document.txt -s paranoid -p mypassword\n\n# Custom KDF (Key Derivation Function)\nfilevault encrypt document.txt -k argon2id -p mypassword\n\n# Combine multiple options\nfilevault encrypt document.txt -a chacha20-poly1305 -k argon2id -s strong --compression lzma -p mypassword\n\n# Disable progress bars\nfilevault encrypt large_file.dat -p mypassword --no-progress\n</code></pre>"},{"location":"cli/cli/#hash-operations","title":"Hash Operations","text":""},{"location":"cli/cli/#generate-hash","title":"Generate Hash","text":"Bash<pre><code># Hash a file with SHA-256 (default)\nfilevault hash document.txt\n\n# Hash with specific algorithm\nfilevault hash document.txt -a sha256\nfilevault hash document.txt -a sha512\nfilevault hash document.txt -a sha3-256\nfilevault hash document.txt -a blake2b\n\n# Legacy hash algorithms (not recommended for security)\nfilevault hash document.txt -a md5\nfilevault hash document.txt -a sha1\n\n# Save hash to file\nfilevault hash document.txt -a sha256 -o document.hash\n</code></pre>"},{"location":"cli/cli/#verify-hash","title":"Verify Hash","text":"Bash<pre><code># Verify file against expected hash\nfilevault hash document.txt -a sha256 -v abc123def456...\n\n# Verify and save result to file\nfilevault hash document.txt -a sha256 -v abc123def456... -o verify_result.txt\n</code></pre>"},{"location":"cli/cli/#compression","title":"Compression","text":""},{"location":"cli/cli/#compress-files","title":"Compress Files","text":"Bash<pre><code># Compress with default algorithm (zlib)\nfilevault compress large_file.txt\n\n# Compress with specific algorithm\nfilevault compress large_file.txt -a zlib\nfilevault compress large_file.txt -a bzip2\nfilevault compress large_file.txt -a lzma\n\n# Compress with custom output name\nfilevault compress large_file.txt -o compressed.dat -a lzma\n\n# Set compression level (1-9, higher = better compression but slower)\nfilevault compress large_file.txt -a lzma -l 9\n</code></pre>"},{"location":"cli/cli/#decompress-files","title":"Decompress Files","text":"Bash<pre><code># Decompress (auto-detect algorithm from file header/extension)\nfilevault decompress large_file.txt.zlib\nfilevault decompress file.xz      # LZMA\nfilevault decompress file.bz2     # BZIP2\n\n# Decompress with custom output name\nfilevault decompress compressed.dat -o original_file.txt\n\n# Specify algorithm manually (if auto-detect fails)\nfilevault decompress file.dat -a zlib -o output.txt\n\n# Using compress command with -d flag (alternative syntax)\nfilevault compress large_file.txt.zlib -d\n</code></pre>"},{"location":"cli/cli/#archive-operations","title":"Archive Operations","text":""},{"location":"cli/cli/#create-archive","title":"Create Archive","text":"Bash<pre><code># Create encrypted archive from multiple files\nfilevault archive create file1.txt file2.txt file3.txt -o my_archive.fva -p mypassword\n\n# Create archive with specific encryption algorithm\nfilevault archive create *.txt -o docs_archive.fva -p mypassword -a aes-256-gcm\n\n# Create archive with compression\nfilevault archive create folder/*.txt -o archive.fva -p mypassword -c lzma\n\n# Create archive with custom security settings\nfilevault archive create file1.txt file2.txt -o secure.fva -p mypassword -s paranoid -k argon2id\n</code></pre>"},{"location":"cli/cli/#extract-archive","title":"Extract Archive","text":"Bash<pre><code># Extract archive to current directory\nfilevault archive extract my_archive.fva -p mypassword\n\n# Extract to specific directory\nfilevault archive extract my_archive.fva -o extracted_files/ -p mypassword\n\n# Extract with verbose output\nfilevault archive extract my_archive.fva -p mypassword -v\n</code></pre>"},{"location":"cli/cli/#list-archive-contents","title":"List Archive Contents","text":"Bash<pre><code># List files in archive (currently extracts files)\nfilevault archive list my_archive.fva -p mypassword\n</code></pre>"},{"location":"cli/cli/#steganography","title":"Steganography","text":""},{"location":"cli/cli/#hide-data-in-image","title":"Hide Data in Image","text":"Bash<pre><code># Embed secret file into image (positional arguments: secret cover output)\nfilevault stego embed secret.txt cover_image.png output_image.png\n\n# The output image looks identical to the original but contains hidden data\n</code></pre>"},{"location":"cli/cli/#extract-hidden-data","title":"Extract Hidden Data","text":"Bash<pre><code># Extract hidden data from image\nfilevault stego extract output_image.png extracted_secret.txt\n\n# Verify extracted content matches original\ncat extracted_secret.txt\n</code></pre>"},{"location":"cli/cli/#check-image-capacity","title":"Check Image Capacity","text":"Bash<pre><code># Check how much data an image can hide\nfilevault stego capacity cover_image.png\n\n# Shows capacity at different bit levels (1-4 bits per channel)\n</code></pre>"},{"location":"cli/cli/#key-generation","title":"Key Generation","text":""},{"location":"cli/cli/#generate-rsa-keys","title":"Generate RSA Keys","text":"Bash<pre><code># Generate RSA-2048 key pair\nfilevault keygen -a rsa-2048 -o my_rsa_key\n\n# Generate RSA-3072 key pair\nfilevault keygen -a rsa-3072 -o my_rsa_key\n\n# Generate RSA-4096 key pair\nfilevault keygen -a rsa-4096 -o my_rsa_key\n</code></pre>"},{"location":"cli/cli/#generate-ecc-keys","title":"Generate ECC Keys","text":"Bash<pre><code># Generate ECC P-256 key pair\nfilevault keygen -a ecc-p256 -o my_ecc_key\n\n# Generate ECC P-384 key pair\nfilevault keygen -a ecc-p384 -o my_ecc_key\n\n# Generate ECC P-521 key pair\nfilevault keygen -a ecc-p521 -o my_ecc_key\n</code></pre>"},{"location":"cli/cli/#generate-post-quantum-keys","title":"Generate Post-Quantum Keys","text":"Bash<pre><code># Generate Kyber-512 hybrid key pair (quantum-resistant)\nfilevault keygen -a kyber-512-hybrid -o my_kyber_key\n\n# Generate Kyber-768 hybrid key pair\nfilevault keygen -a kyber-768-hybrid -o my_kyber_key\n\n# Generate Kyber-1024 hybrid key pair (highest security)\nfilevault keygen -a kyber-1024-hybrid -o my_kyber_key\n\n# Generate Dilithium digital signature key\nfilevault keygen -a dilithium -o my_dilithium_key\n</code></pre>"},{"location":"cli/cli/#configuration","title":"Configuration","text":""},{"location":"cli/cli/#view-configuration","title":"View Configuration","text":"Bash<pre><code># Show current configuration\nfilevault config show\n</code></pre>"},{"location":"cli/cli/#set-configuration","title":"Set Configuration","text":"Bash<pre><code># Set default encryption mode\nfilevault config set default.mode basic\nfilevault config set default.mode standard\nfilevault config set default.mode advanced\n\n# Set default algorithm\nfilevault config set default.algorithm aes-256-gcm\nfilevault config set default.algorithm chacha20-poly1305\nfilevault config set default.algorithm aes-256-ctr\n\n# Set default KDF\nfilevault config set default.kdf argon2id\nfilevault config set default.kdf pbkdf2-sha256\nfilevault config set default.kdf scrypt\n\n# Set default compression\nfilevault config set default.compression none\nfilevault config set default.compression zlib\nfilevault config set default.compression lzma\n\n# Set compression level (1-9)\nfilevault config set compression_level 6\n\n# Enable/disable features\nfilevault config set show_progress true\nfilevault config set show_progress false\nfilevault config set verbose true\nfilevault config set verbose false\n</code></pre>"},{"location":"cli/cli/#reset-configuration","title":"Reset Configuration","text":"Bash<pre><code># Reset to default settings\nfilevault config reset\n</code></pre>"},{"location":"cli/cli/#list-algorithms","title":"List Algorithms","text":""},{"location":"cli/cli/#list-all-available-algorithms","title":"List All Available Algorithms","text":"Bash<pre><code># Show all supported algorithms in tables\nfilevault list\n\n# Shows:\n# - Symmetric encryption algorithms (AEAD and non-AEAD)\n# - Asymmetric encryption algorithms (RSA, ECC)\n# - Post-Quantum algorithms (Kyber, Dilithium)\n# - Hash functions (including MD5/SHA1 marked as BROKEN)\n# - Classical ciphers (Caesar, Vigenere, etc.)\n</code></pre>"},{"location":"cli/cli/#benchmark","title":"Benchmark","text":""},{"location":"cli/cli/#performance-testing","title":"Performance Testing","text":"Bash<pre><code># Benchmark all algorithms (default: 1MB, 5 iterations)\nfilevault benchmark\n\n# Benchmark specific algorithm\nfilevault benchmark -a aes-256-gcm\n\n# Benchmark all symmetric algorithms only\nfilevault benchmark --symmetric\n\n# Benchmark all asymmetric algorithms only\nfilevault benchmark --asymmetric\n\n# Benchmark all post-quantum algorithms only\nfilevault benchmark --pqc\n\n# Custom data size and iterations\nfilevault benchmark -s 10485760 -i 10  # 10MB, 10 iterations\n\n# Save results to JSON file\nfilevault benchmark -o benchmark_results.json --json\n</code></pre>"},{"location":"cli/cli/#info","title":"Info","text":""},{"location":"cli/cli/#view-file-information","title":"View File Information","text":"Bash<pre><code># Display information about encrypted file\nfilevault info document.txt.fvlt\n\n# Shows:\n# - File format version\n# - Encryption algorithm\n# - Key derivation function\n# - Compression algorithm\n# - File sizes\n# - Creation timestamp\n# - Additional metadata\n</code></pre>"},{"location":"cli/cli/#common-use-cases","title":"Common Use Cases","text":""},{"location":"cli/cli/#secure-file-backup","title":"Secure File Backup","text":"Bash<pre><code># Encrypt important files with maximum security\nfilevault encrypt important_document.pdf -m advanced -p strong_password\n\n# Create encrypted archive of multiple files\nfilevault archive create *.doc *.pdf -o backup.fva -p strong_password -s paranoid\n</code></pre>"},{"location":"cli/cli/#quick-file-sharing","title":"Quick File Sharing","text":"Bash<pre><code># Encrypt with basic mode for fast sharing\nfilevault encrypt shared_file.txt -m basic -p sharepassword\n\n# Recipient decrypts with same password\nfilevault decrypt shared_file.txt.fvlt -p sharepassword\n</code></pre>"},{"location":"cli/cli/#stealth-communication","title":"Stealth Communication","text":"Bash<pre><code># Hide secret message in innocent-looking image\nfilevault stego embed secret_message.txt family_photo.png vacation_photo.png\n\n# Send vacation_photo.png (looks normal, contains hidden data)\n# Recipient extracts hidden message\nfilevault stego extract vacation_photo.png received_secret.txt\n</code></pre>"},{"location":"cli/cli/#verify-file-integrity","title":"Verify File Integrity","text":"Bash<pre><code># Generate hash before sending\nfilevault hash important_file.zip -a sha256 -o file_hash.txt\n\n# Recipient verifies hash after receiving\nfilevault hash important_file.zip -a sha256 -v &lt;hash_from_file_hash.txt&gt;\n</code></pre>"},{"location":"cli/cli/#large-file-compression","title":"Large File Compression","text":"Bash<pre><code># Compress large files before encryption\nfilevault compress large_dataset.csv -a lzma -l 9\n\n# Then encrypt compressed file\nfilevault encrypt large_dataset.csv.lzma -p mypassword\n</code></pre>"},{"location":"cli/cli/#algorithm-reference","title":"Algorithm Reference","text":""},{"location":"cli/cli/#symmetric-encryption-aead","title":"Symmetric Encryption (AEAD)","text":"<ul> <li><code>aes-128-gcm</code>, <code>aes-192-gcm</code>, <code>aes-256-gcm</code> - AES with GCM mode (recommended)</li> <li><code>chacha20-poly1305</code> - ChaCha20 stream cipher with Poly1305 MAC</li> <li><code>serpent-256-gcm</code> - Serpent cipher (AES finalist)</li> <li><code>twofish-256-gcm</code> - Twofish cipher (AES finalist)</li> <li><code>camellia-256-gcm</code> - Camellia cipher (ISO standard)</li> <li><code>aria-256-gcm</code> - ARIA cipher (Korean standard)</li> </ul>"},{"location":"cli/cli/#symmetric-encryption-non-aead","title":"Symmetric Encryption (Non-AEAD)","text":"<ul> <li><code>aes-256-cbc</code> - AES with CBC mode (legacy)</li> <li><code>aes-256-ctr</code> - AES with CTR mode (stream)</li> <li><code>aes-256-cfb</code> - AES with CFB mode (stream)</li> <li><code>aes-256-ofb</code> - AES with OFB mode (stream)</li> <li><code>aes-128-xts</code>, <code>aes-256-xts</code> - AES-XTS for disk encryption</li> <li><code>aes-256-ecb</code> - AES with ECB mode (INSECURE, not recommended)</li> </ul>"},{"location":"cli/cli/#hash-functions","title":"Hash Functions","text":"<ul> <li><code>sha256</code>, <code>sha512</code> - SHA-2 family (recommended)</li> <li><code>sha3-256</code>, <code>sha3-512</code> - SHA-3 family</li> <li><code>blake2b</code> - BLAKE2b hash function</li> <li><code>md5</code>, <code>sha1</code> - Legacy functions (BROKEN, use only for compatibility)</li> </ul>"},{"location":"cli/cli/#compression-algorithms","title":"Compression Algorithms","text":"<ul> <li><code>zlib</code> - Fast, good compression ratio</li> <li><code>bzip2</code> - Better compression, slower</li> <li><code>lzma</code> - Best compression, slowest</li> <li><code>none</code> - No compression</li> </ul>"},{"location":"cli/cli/#key-derivation-functions","title":"Key Derivation Functions","text":"<ul> <li><code>argon2id</code> - Argon2id (recommended, memory-hard)</li> <li><code>argon2i</code> - Argon2i variant</li> <li><code>pbkdf2-sha256</code> - PBKDF2 with SHA-256</li> <li><code>pbkdf2-sha512</code> - PBKDF2 with SHA-512</li> <li><code>scrypt</code> - Scrypt (memory-hard)</li> </ul>"},{"location":"cli/cli/#security-levels","title":"Security Levels","text":"<ul> <li><code>weak</code> - Minimal security, fastest</li> <li><code>medium</code> - Balanced (default)</li> <li><code>strong</code> - Enhanced security</li> <li><code>paranoid</code> - Maximum security, slowest</li> </ul>"},{"location":"cli/cli/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ol> <li> <p>Never use <code>-p password</code> in production - Always use interactive password prompts for better security</p> </li> <li> <p>Use mode presets - Instead of manually configuring every option, use <code>-m basic/standard/advanced</code></p> </li> <li> <p>Verify after encryption - Always test decryption after encrypting important files</p> </li> <li> <p>Keep backups - Don't delete original files until you've verified encrypted versions work</p> </li> <li> <p>Use strong passwords - FileVault will warn you about weak passwords, listen to it!</p> </li> <li> <p>For maximum security - Use <code>advanced</code> mode with a strong password (&gt;16 chars, mixed case, numbers, symbols)</p> </li> <li> <p>For quantum resistance - Use Kyber-1024 hybrid keys for future-proof encryption</p> </li> <li> <p>Progress bars - Use <code>--no-progress</code> flag when running in scripts or pipelines</p> </li> <li> <p>Compression tips - Already compressed files (ZIP, JPG, MP4) don't benefit from compression</p> </li> <li> <p>Config defaults - Set your preferred defaults with <code>config set</code> to save typing</p> </li> </ol>"},{"location":"cli/cli/#exit-codes","title":"Exit Codes","text":"<ul> <li><code>0</code> - Success</li> <li><code>1</code> - General error (invalid arguments, file not found, etc.)</li> <li>Other non-zero values indicate specific error conditions</li> </ul>"},{"location":"cli/cli/#support","title":"Support","text":"<p>For more information: - Read the main README.md - Check ARCHITECTURE.md for technical details - See ALGORITHMS.md for cryptography information - Visit the repository: https://github.com/vuongdat67/NT140.Q11.ANTT-Group15</p>"},{"location":"cli/demo/","title":"Demo","text":""},{"location":"concepts/key_management/","title":"Qu\u1ea3n l\u00fd Kh\u00f3a (Key Management)","text":""},{"location":"concepts/key_management/#qu\u1ea3n-l\u00fd-kh\u00f3a-key-management","title":"Qu\u1ea3n l\u00fd Kh\u00f3a (Key Management)","text":""},{"location":"concepts/key_management/#1-t\u1ed5ng-quan","title":"1. T\u1ed5ng quan","text":"<p>Qu\u1ea3n l\u00fd kh\u00f3a l\u00e0 ph\u1ea7n quan tr\u1ecdng nh\u1ea5t v\u00e0 c\u0169ng kh\u00f3 nh\u1ea5t c\u1ee7a b\u1ea5t k\u1ef3 h\u1ec7 th\u1ed1ng m\u1eadt m\u00e3 n\u00e0o. \"M\u00e3 h\u00f3a m\u1ea1nh \u0111\u1ebfn \u0111\u00e2u c\u0169ng v\u00f4 d\u1ee5ng n\u1ebfu kh\u00f3a b\u1ecb l\u1ed9\".</p> <p>FileVault \u00e1p d\u1ee5ng m\u00f4 h\u00ecnh qu\u1ea3n l\u00fd kh\u00f3a ph\u00e2n c\u1ea5p (Hierarchy of Keys) \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o an to\u00e0n v\u00e0 linh ho\u1ea1t.</p>"},{"location":"concepts/key_management/#2-c\u00e1c-lo\u1ea1i-kh\u00f3a-trong-filevault","title":"2. C\u00e1c lo\u1ea1i kh\u00f3a trong FileVault","text":""},{"location":"concepts/key_management/#21-master-password-user-secret","title":"2.1. Master Password (User Secret)","text":"<ul> <li>Ngu\u1ed3n: Do ng\u01b0\u1eddi d\u00f9ng nh\u1eadp v\u00e0o.</li> <li>L\u01b0u tr\u1eef: KH\u00d4NG BAO GI\u1edc \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng plain text. Ch\u1ec9 l\u01b0u hash (Argon2) \u0111\u1ec3 x\u00e1c th\u1ef1c (n\u1ebfu c\u1ea7n).</li> <li>Vai tr\u00f2: D\u00f9ng \u0111\u1ec3 derive ra Master Key ho\u1eb7c KEK.</li> </ul>"},{"location":"concepts/key_management/#22-key-encryption-key-kek","title":"2.2. Key Encryption Key (KEK)","text":"<ul> <li>Ngu\u1ed3n: Derived t\u1eeb Master Password + Salt b\u1eb1ng Argon2id.</li> <li>Vai tr\u00f2: D\u00f9ng \u0111\u1ec3 m\u00e3 h\u00f3a/gi\u1ea3i m\u00e3 Data Encryption Key (DEK).</li> </ul>"},{"location":"concepts/key_management/#23-data-encryption-key-dek","title":"2.3. Data Encryption Key (DEK)","text":"<ul> <li>Ngu\u1ed3n: Sinh ng\u1eabu nhi\u00ean (CSPRNG) cho m\u1ed7i file.</li> <li>\u0110\u1ed9 d\u00e0i: 256 bits (32 bytes).</li> <li>Vai tr\u00f2: Tr\u1ef1c ti\u1ebfp m\u00e3 h\u00f3a d\u1eef li\u1ec7u file (d\u00f9ng AES-GCM ho\u1eb7c ChaCha20).</li> <li>L\u01b0u tr\u1eef: \u0110\u01b0\u1ee3c m\u00e3 h\u00f3a b\u1edfi KEK v\u00e0 l\u01b0u trong header c\u1ee7a file (Encrypted DEK).</li> </ul>"},{"location":"concepts/key_management/#3-v\u00f2ng-\u0111\u1eddi-c\u1ee7a-kh\u00f3a-key-lifecycle","title":"3. V\u00f2ng \u0111\u1eddi c\u1ee7a kh\u00f3a (Key Lifecycle)","text":"<ol> <li> <p>Generation (Sinh kh\u00f3a):</p> <ul> <li>DEK \u0111\u01b0\u1ee3c sinh b\u1eb1ng <code>Botan::AutoSeeded_RNG</code> (d\u00f9ng entropy t\u1eeb OS).</li> <li>Salt v\u00e0 Nonce c\u0169ng \u0111\u01b0\u1ee3c sinh m\u1edbi cho m\u1ed7i file.</li> </ul> </li> <li> <p>Derivation (Ph\u00e1i sinh):</p> <ul> <li>Khi ng\u01b0\u1eddi d\u00f9ng nh\u1eadp password, KEK \u0111\u01b0\u1ee3c t\u00e1i t\u1ea1o l\u1ea1i b\u1eb1ng Argon2id v\u1edbi salt \u0111\u1ecdc t\u1eeb file header.</li> </ul> </li> <li> <p>Usage (S\u1eed d\u1ee5ng):</p> <ul> <li>KEK gi\u1ea3i m\u00e3 Encrypted DEK -&gt; Raw DEK.</li> <li>Raw DEK \u0111\u01b0\u1ee3c n\u1ea1p v\u00e0o Crypto Engine \u0111\u1ec3 gi\u1ea3i m\u00e3 d\u1eef li\u1ec7u.</li> <li>Quan tr\u1ecdng: Raw DEK ch\u1ec9 t\u1ed3n t\u1ea1i trong RAM.</li> </ul> </li> <li> <p>Destruction (H\u1ee7y):</p> <ul> <li>Ngay sau khi m\u00e3 h\u00f3a/gi\u1ea3i m\u00e3 xong, bi\u1ebfn ch\u1ee9a Raw DEK v\u00e0 KEK trong RAM ph\u1ea3i \u0111\u01b0\u1ee3c ghi \u0111\u00e8 (zeroized/wiped) \u0111\u1ec3 tr\u00e1nh l\u1ed9 qua memory dump ho\u1eb7c swap file.</li> <li>Botan <code>secure_vector</code> t\u1ef1 \u0111\u1ed9ng l\u00e0m vi\u1ec7c n\u00e0y khi object b\u1ecb h\u1ee7y.</li> </ul> </li> </ol>"},{"location":"concepts/key_management/#4-s\u01a1-\u0111\u1ed3-\u0111\u00f3ng-g\u00f3i-envelope-encryption","title":"4. S\u01a1 \u0111\u1ed3 \u0111\u00f3ng g\u00f3i (Envelope Encryption)","text":"<pre><code>graph TD\n    Password[User Password] --&gt;|Argon2id + Salt| KEK[\"KEK (Derived Key)\"]\n    RNG[CSPRNG] --&gt;|Generate| DEK[\"DEK (Random File Key)\"]\n    Data[File Content] --&gt;|AES-GCM + DEK| EncData[Encrypted Data]\n    DEK --&gt;|AES-KeyWrap + KEK| EncDEK[Encrypted DEK]\n    EncDEK --&gt; Header[File Header]\n    Salt --&gt; Header\n    Params --&gt; Header\n    Header --&gt; OutputFile\n    EncData --&gt; OutputFile</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"concepts/key_management/#5-best-practices","title":"5. Best Practices","text":"<ol> <li>Zeroization: Lu\u00f4n x\u00f3a s\u1ea1ch b\u1ed9 nh\u1edb ch\u1ee9a key nh\u1ea1y c\u1ea3m.</li> <li>Unique Salt: M\u1ed7i file c\u00f3 salt ri\u00eang, ng\u0103n ch\u1eb7n t\u1ea5n c\u00f4ng Rainbow Table h\u00e0ng lo\u1ea1t.</li> <li>Key Isolation: Vi\u1ec7c l\u1ed9 DEK c\u1ee7a file A kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn file B (v\u00ec DEK kh\u00e1c nhau). Vi\u1ec7c l\u1ed9 Password \u1ea3nh h\u01b0\u1edfng to\u00e0n b\u1ed9 (do \u0111\u00f3 c\u1ea7n Argon2 m\u1ea1nh).</li> </ol>"},{"location":"workflows/decryption_flow/","title":"Lu\u1ed3ng Gi\u1ea3i M\u00e3 (Decryption Workflow)","text":""},{"location":"workflows/decryption_flow/#lu\u1ed3ng-gi\u1ea3i-m\u00e3-decryption-workflow","title":"Lu\u1ed3ng Gi\u1ea3i M\u00e3 (Decryption Workflow)","text":"<p>T\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 c\u00e1c b\u01b0\u1edbc FileVault th\u1ef1c hi\u1ec7n khi gi\u1ea3i m\u00e3 m\u1ed9t file \u0111\u00e3 \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a b\u1eb1ng AEAD (m\u1eb7c \u0111\u1ecbnh AES-256-GCM).</p>"},{"location":"workflows/decryption_flow/#1-chu\u1ea9n-b\u1ecb-setup","title":"1. Chu\u1ea9n b\u1ecb (Setup)","text":"<ol> <li>Input: \u0110\u01b0\u1eddng d\u1eabn file m\u00e3 h\u00f3a (<code>file.txt.enc</code>) v\u00e0 m\u1eadt kh\u1ea9u.</li> <li>Open &amp; Read Header: \u0110\u1ecdc magic/version, thu\u1eadt to\u00e1n, KDF params (salt, memory, iterations), nonce/IV, v\u00e0 v\u1ecb tr\u00ed/\u0111\u1ed9 d\u00e0i tag.</li> </ol>"},{"location":"workflows/decryption_flow/#2-kh\u00f4i-ph\u1ee5c-key","title":"2. Kh\u00f4i ph\u1ee5c Key","text":"<ol> <li>Derive Key: <code>Argon2id(password, salt)</code> -&gt; Key (32 bytes) theo tham s\u1ed1 header.</li> <li>Nonce: L\u1ea5y nonce 12 byte t\u1eeb header.</li> </ol>"},{"location":"workflows/decryption_flow/#3-gi\u1ea3i-m\u00e3-d\u1eef-li\u1ec7u-streaming","title":"3. Gi\u1ea3i m\u00e3 D\u1eef li\u1ec7u (Streaming)","text":"<ol> <li>Open Files: M\u1edf file m\u00e3 h\u00f3a (read) v\u00e0 file \u0111\u00edch (write).</li> <li>Decrypt Loop:    * \u0110\u1ecdc t\u1eebng chunk ciphertext (tr\u1eeb ph\u1ea7n tag cu\u1ed1i c\u00f9ng n\u1ebfu t\u00e1ch ri\u00eang).    * G\u1eedi v\u00e0o AEAD decrypt (stream). Th\u01b0 vi\u1ec7n s\u1ebd gi\u1eef tr\u1ea1ng th\u00e1i GHASH/Poly \u0111\u1ec3 ki\u1ec3m tag.    * Nh\u1eadn plaintext chunk v\u00e0 ghi ra file t\u1ea1m/output.</li> <li>Finalize: AEAD ki\u1ec3m tra Authentication Tag (so s\u00e1nh h\u1eb1ng th\u1eddi gian). N\u1ebfu tag kh\u00f4ng kh\u1edbp \u2192 b\u00e1o l\u1ed7i v\u00e0 kh\u00f4ng tr\u1ea3 plaintext h\u1ee3p l\u1ec7.</li> </ol>"},{"location":"workflows/decryption_flow/#4-sequence-diagram","title":"4. Sequence Diagram","text":"<pre><code>sequenceDiagram\n    participant User\n    participant CLI\n    participant CryptoEngine\n    participant FileSystem\n\n    User-&gt;&gt;CLI: decrypt file.txt.enc -p \"secret\"\n    CLI-&gt;&gt;FileSystem: Read Header (Salt, Nonce, Params)\n    CLI-&gt;&gt;CryptoEngine: Argon2id(pass, salt) -&gt; Key\n    CLI-&gt;&gt;CryptoEngine: init(AES-256-GCM, nonce)\n\n    loop Chunk Processing\n        CLI-&gt;&gt;FileSystem: Read Encrypted Chunk\n        FileSystem--&gt;&gt;CLI: Ciphertext\n        CLI-&gt;&gt;CryptoEngine: Update(Ciphertext)\n        CryptoEngine--&gt;&gt;CLI: Plaintext Chunk\n        CLI-&gt;&gt;FileSystem: Write Plaintext Chunk\n    end\n\n    CLI-&gt;&gt;CryptoEngine: Finalize()\n    CryptoEngine--&gt;&gt;CLI: Tag Verified? (yes/no)\n    alt Tag OK\n        CLI-&gt;&gt;User: Success\n    else Tag Fail\n        CLI--&gt;&gt;User: ERROR (Auth Failed) and discard plaintext\n    end</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"},{"location":"workflows/decryption_flow/#5-l\u01b0u-\u00fd-an-to\u00e0n","title":"5. L\u01b0u \u00fd An to\u00e0n","text":"<ul> <li>Tag ph\u1ea3i \u0111\u01b0\u1ee3c ki\u1ec3m tra th\u00e0nh c\u00f4ng tr\u01b0\u1edbc khi coi plaintext l\u00e0 h\u1ee3p l\u1ec7.</li> <li>N\u1ebfu tag sai, kh\u00f4ng d\u00f9ng d\u1eef li\u1ec7u \u0111\u00e3 ghi; n\u00ean ghi ra t\u1ec7p t\u1ea1m v\u00e0 ch\u1ec9 \u0111\u1ed5i t\u00ean khi tag h\u1ee3p l\u1ec7.</li> <li>Kh\u00f4ng ch\u1ea1m v\u00e0o nonce/salt trong header; ch\u00fang ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u1ecdc nguy\u00ean b\u1ea3n.</li> <li>M\u1eadt kh\u1ea9u sai ho\u1eb7c file b\u1ecb s\u1eeda s\u1ebd d\u1eabn \u0111\u1ebfn l\u1ed7i tag.</li> </ul>"},{"location":"workflows/encryption_flow/","title":"Lu\u1ed3ng M\u00e3 H\u00f3a (Encryption Workflow)","text":""},{"location":"workflows/encryption_flow/#lu\u1ed3ng-m\u00e3-h\u00f3a-encryption-workflow","title":"Lu\u1ed3ng M\u00e3 H\u00f3a (Encryption Workflow)","text":"<p>T\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 chi ti\u1ebft c\u00e1c b\u01b0\u1edbc di\u1ec5n ra khi ng\u01b0\u1eddi d\u00f9ng th\u1ef1c hi\u1ec7n l\u1ec7nh m\u00e3 h\u00f3a m\u1ed9t file trong FileVault.</p>"},{"location":"workflows/encryption_flow/#1-chu\u1ea9n-b\u1ecb-setup","title":"1. Chu\u1ea9n b\u1ecb (Setup)","text":"<ol> <li>Input: Ng\u01b0\u1eddi d\u00f9ng cung c\u1ea5p \u0111\u01b0\u1eddng d\u1eabn file ngu\u1ed3n (<code>input.txt</code>) v\u00e0 m\u1eadt kh\u1ea9u.</li> <li>Config: H\u1ec7 th\u1ed1ng x\u00e1c \u0111\u1ecbnh thu\u1eadt to\u00e1n (v\u00ed d\u1ee5: AES-256-GCM) v\u00e0 KDF (Argon2id) d\u1ef1a tr\u00ean c\u1ea5u h\u00ecnh ho\u1eb7c m\u1eb7c \u0111\u1ecbnh.</li> </ol>"},{"location":"workflows/encryption_flow/#2-x\u1eed-l\u00fd-header--key","title":"2. X\u1eed l\u00fd Header &amp; Key","text":"<ol> <li>Generate Salt: Sinh ng\u1eabu nhi\u00ean 16 bytes salt.</li> <li>Derive KEK: Ch\u1ea1y <code>Argon2id(password, salt)</code> -&gt; thu \u0111\u01b0\u1ee3c KEK (32 bytes).</li> <li>Generate DEK: Sinh ng\u1eabu nhi\u00ean 32 bytes DEK (Data Encryption Key).</li> <li>Encrypt DEK: M\u00e3 h\u00f3a DEK b\u1eb1ng KEK (th\u01b0\u1eddng d\u00f9ng AES-KeyWrap ho\u1eb7c \u0111\u01a1n gi\u1ea3n l\u00e0 XOR/Encrypt n\u1ebfu d\u00f9ng m\u00f4 h\u00ecnh \u0111\u01a1n gi\u1ea3n h\u01a1n). L\u01b0u \u00fd: Trong implementation hi\u1ec7n t\u1ea1i c\u1ee7a FileVault CLI \u0111\u01a1n gi\u1ea3n, c\u00f3 th\u1ec3 d\u00f9ng tr\u1ef1c ti\u1ebfp Derived Key l\u00e0m Key m\u00e3 h\u00f3a file (Direct Encryption) ho\u1eb7c d\u00f9ng Envelope. T\u00e0i li\u1ec7u n\u00e0y m\u00f4 t\u1ea3 m\u00f4 h\u00ecnh Direct Encryption (n\u1ebfu code d\u00f9ng c\u00e1ch \u0111\u00f3) ho\u1eb7c Envelope (n\u1ebfu code d\u00f9ng c\u00e1ch \u0111\u00f3).</li> </ol> <p>(D\u1ef1a tr\u00ean code <code>crypto_engine.cpp</code> v\u00e0 <code>encrypt_cmd.cpp</code>, FileVault hi\u1ec7n t\u1ea1i c\u00f3 v\u1ebb d\u00f9ng Direct Encryption: Password -&gt; Key -&gt; Encrypt File. S\u1ebd c\u1eadp nh\u1eadt lu\u1ed3ng theo Direct Encryption cho ch\u00ednh x\u00e1c v\u1edbi code hi\u1ec7n t\u1ea1i).</p>"},{"location":"workflows/encryption_flow/#lu\u1ed3ng-direct-encryption-hi\u1ec7n-t\u1ea1i","title":"Lu\u1ed3ng Direct Encryption (Hi\u1ec7n t\u1ea1i)","text":"<ol> <li>Generate Salt: Sinh 16 bytes salt.</li> <li>Derive Key: <code>Argon2id(password, salt)</code> -&gt; Key (32 bytes).</li> <li>Generate Nonce: Sinh 12 bytes nonce (cho GCM).</li> </ol>"},{"location":"workflows/encryption_flow/#3-x\u1eed-l\u00fd-d\u1eef-li\u1ec7u-streaming","title":"3. X\u1eed l\u00fd D\u1eef li\u1ec7u (Streaming)","text":"<p>Do file c\u00f3 th\u1ec3 l\u1edbn h\u01a1n RAM, FileVault x\u1eed l\u00fd theo chunk (kh\u1ed1i):</p> <ol> <li>Open Files: M\u1edf file input (read) v\u00e0 output (write).</li> <li>Write Header: Ghi metadata v\u00e0o \u0111\u1ea7u file output:<ul> <li>Magic Bytes (<code>FVLT</code>)</li> <li>Version</li> <li>Algorithm ID</li> <li>KDF ID &amp; Params (Salt, Iterations, Memory)</li> <li>Nonce/IV</li> </ul> </li> <li>Encryption Loop:<ul> <li>\u0110\u1ecdc m\u1ed9t chunk t\u1eeb input (v\u00ed d\u1ee5 64KB).</li> <li>M\u00e3 h\u00f3a chunk \u0111\u00f3 b\u1eb1ng Key &amp; Nonce (L\u01b0u \u00fd: V\u1edbi GCM/ChaCha, th\u01b0\u1eddng ph\u1ea3i m\u00e3 h\u00f3a to\u00e0n b\u1ed9 stream ho\u1eb7c d\u00f9ng chunk c\u00f3 tag ri\u00eang. FileVault d\u00f9ng th\u01b0 vi\u1ec7n Botan filter/pipe \u0111\u1ec3 x\u1eed l\u00fd stream trong su\u1ed1t).</li> <li>Ghi d\u1eef li\u1ec7u \u0111\u00e3 m\u00e3 h\u00f3a v\u00e0o output.</li> </ul> </li> <li>Finalize: T\u00ednh to\u00e1n v\u00e0 ghi Authentication Tag (n\u1ebfu thu\u1eadt to\u00e1n AEAD).</li> </ol>"},{"location":"workflows/encryption_flow/#4-sequence-diagram","title":"4. Sequence Diagram","text":"<pre><code>sequenceDiagram\n    participant User\n    participant CLI\n    participant CryptoEngine\n    participant FileSystem\n\n    User-&gt;&gt;CLI: encrypt file.txt -p \"secret\"\n    CLI-&gt;&gt;CryptoEngine: init(AES-256-GCM)\n    CryptoEngine-&gt;&gt;CryptoEngine: Generate Salt (16B)\n    CryptoEngine-&gt;&gt;CryptoEngine: Generate Nonce (12B)\n    CryptoEngine-&gt;&gt;CryptoEngine: Argon2id(pass, salt) -&gt; Key\n\n    CLI-&gt;&gt;FileSystem: Create file.txt.enc\n    CLI-&gt;&gt;FileSystem: Write Header (Salt, Nonce, Params)\n\n    loop Chunk Processing\n        CLI-&gt;&gt;FileSystem: Read Chunk\n        FileSystem--&gt;&gt;CLI: Data\n        CLI-&gt;&gt;CryptoEngine: Update(Data)\n        CryptoEngine--&gt;&gt;CLI: Encrypted Data\n        CLI-&gt;&gt;FileSystem: Write Encrypted Data\n    end\n\n    CLI-&gt;&gt;CryptoEngine: Finalize()\n    CryptoEngine--&gt;&gt;CLI: Auth Tag\n    CLI-&gt;&gt;FileSystem: Write Tag (if needed/appended)\n    CLI-&gt;&gt;User: Success</code></pre>  Hold \"Alt\" / \"Option\" to enable pan &amp; zoom"}]}